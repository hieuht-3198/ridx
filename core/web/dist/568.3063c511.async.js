(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[568],{97612:function(fe){fe.exports={steps_content:"steps_content___1RUyP"}},76731:function(fe,re,n){"use strict";var r=n(71153),l=n(60331),ie=n(44743),p=n(85893),u=function(U){var B=U.cvss;if(B){var V=(0,ie.$U)(B);return(0,p.jsx)(l.Z,{color:V[1],children:(0,p.jsx)("b",{style:{color:"black"},children:"".concat(B," ").concat(V[0])})})}return"(not available)"};re.Z=u},42568:function(fe,re,n){"use strict";n.d(re,{Z:function(){return We}});var r=n(11849),l=n(2824),ie=n(35556),p=n(97880),u=n(67294),ve=n(97612),U=n.n(ve),B=n(89816),V=n(4042),_e=n(57663),Y=n(71577),je=n(47673),ne=n(4107),ye=n(13062),O=n(71230),Se=n(89032),y=n(15746),Ce=n(34792),_=n(48086),d=n(3182),e=n(43358),j=n(34041),N=n(94043),L=n.n(N),ae=n(44743),me=n(15433),t=n(85893),we=function(x){var w=x.asset,C=x.cpe,z=x.setCPE,J=useState(!1),I=_slicedToArray(J,2),se=I[0],K=I[1],X=useState([]),M=_slicedToArray(X,2),Q=M[0],ue=M[1],D=useState(""),A=_slicedToArray(D,2),Te=A[0],q=A[1],oe=function(k){var G=k.target.value;q(G)},ce=function(k){R(k),z(k)},he=[{title:"Type",dataIndex:"part",key:"part"},{title:"Vendor",dataIndex:"vendor",key:"vendor"},{title:"Product",dataIndex:"product",key:"product"},{title:"Version",dataIndex:"version",key:"version"},{title:"Update",dataIndex:"update",key:"update"},{title:"Edition",dataIndex:"edition",key:"edition"}],le=useState(C),ge=_slicedToArray(le,2),pe=ge[0],R=ge[1];return useEffect(function(){var m=function(){var k=_asyncToGenerator(_regeneratorRuntime.mark(function G(){var de;return _regeneratorRuntime.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:Q&&(K(!0),de=1,de?ue(sample_data.map(function(T){return _objectSpread(_objectSpread({},T),{},{key:T.id})})):_message.error("Error"),K(!1));case 1:case"end":return g.stop()}},G)}));return function(){return k.apply(this,arguments)}}();m()},[]),se?_jsx(LoadingOutlined,{}):_jsx(_Table,{rowSelection:{selectedRowKeys:pe,onChange:ce,type:"radio"},columns:he,dataSource:Q,scroll:{y:150}})},Ze=null,Ee=j.Z.Option,s=j.Z.OptGroup,i=function(x){var w=x.deploymentScenario,C=x.assets,z=x.setAssets,J=(0,u.useState)([]),I=(0,l.Z)(J,2),se=I[0],K=I[1],X=(0,u.useState)([]),M=(0,l.Z)(X,2),Q=M[0],ue=M[1],D=(0,u.useState)([]),A=(0,l.Z)(D,2),Te=A[0],q=A[1],oe=(0,u.useState)(!1),ce=(0,l.Z)(oe,2),he=ce[0],le=ce[1],ge=(0,u.useState)(""),pe=(0,l.Z)(ge,2),R=pe[0],m=pe[1],k=(0,u.useState)(!1),G=(0,l.Z)(k,2),de=G[0],S=G[1],g=(0,u.useState)(!1),T=(0,l.Z)(g,2),$=T[0],W=T[1],ee=(0,u.useState)({}),Ae=(0,l.Z)(ee,2),c=Ae[0],be=Ae[1],He=function(){var h=(0,d.Z)(L().mark(function E(b){var te,P;return L().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return m(""),q([]),te=C.find(function(Pe){return Pe.id===b}),be(te),S(!0),F.next=7,(0,me.Fx)({keyword:"".concat(te.product," ").concat(te.version)});case 7:P=F.sent,P?(q(P.cpes.map(function(Pe){return(0,r.Z)((0,r.Z)({},Pe),{},{key:Pe.id})})),le(!0)):_.default.error("Error"),S(!1);case 10:case"end":return F.stop()}},E)}));return function(b){return h.apply(this,arguments)}}(),Fe=(0,u.useState)([]),Oe=(0,l.Z)(Fe,2),De=Oe[0],Ve=Oe[1],Be=function(E){Ve(E),z(C.map(function(b){return b.id===c.id?(0,r.Z)((0,r.Z)({},b),{},{mapping_cpe:E[0]}):b})),be((0,r.Z)((0,r.Z)({},c),{},{mapping_cpe:E[0]}))},Ye=function(){var h=(0,d.Z)(L().mark(function E(){var b,te;return L().wrap(function(H){for(;;)switch(H.prev=H.next){case 0:return W(!0),b=(0,r.Z)((0,r.Z)({},c),{},{cpe:c.mapping_cpe}),H.next=4,(0,me.bg)(w.id,c.id,b);case 4:te=H.sent,te?(z(C.map(function(F){return F.id===c.id?(0,r.Z)((0,r.Z)({},F),{},{mapping_cpe:c.mapping_cpe,cpe:c.mapping_cpe}):F})),be((0,r.Z)((0,r.Z)({},c),{},{cpe:c.mapping_cpe})),_.default.success("Save done!"),Ve([])):_.default.error("Error!"),W(!1);case 7:case"end":return H.stop()}},E)}));return function(){return h.apply(this,arguments)}}(),ze=function(E){m(E.target.value)},Je=function(){var h=(0,d.Z)(L().mark(function E(){var b;return L().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:if(R){P.next=3;break}return _.default.error("Please input Keyword"),P.abrupt("return");case 3:if(R.trim()){P.next=6;break}return _.default.error("Please input Keyword"),P.abrupt("return");case 6:return S(!0),P.next=9,(0,me.Fx)({keyword:R.trim()});case 9:b=P.sent,b?(q(b.cpes.map(function(H){return(0,r.Z)((0,r.Z)({},H),{},{key:H.id})})),le(!0)):_.default.error("Error"),S(!1);case 12:case"end":return P.stop()}},E)}));return function(){return h.apply(this,arguments)}}(),Xe=[{title:"CPE",dataIndex:"id",key:"id",width:"40%"},{title:"Type",dataIndex:"part",key:"part",width:"10%",render:function(E){return(0,ae.JS)(E)}},{title:"Vendor",dataIndex:"vendor",key:"vendor",width:"20%"},{title:"Product",dataIndex:"product",key:"product",width:"20%"},{title:"Version",dataIndex:"version",key:"version",width:"10%"}];return(0,u.useEffect)(function(){K(C.filter(function(h){return!h.mapping_cpe})),ue(C.filter(function(h){return h.mapping_cpe}))},[C]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(O.Z,{gutter:16,children:[(0,t.jsx)(y.Z,{span:2,children:(0,t.jsx)("label",{children:"Asset : "})}),(0,t.jsx)(y.Z,{span:10,children:(0,t.jsxs)(j.Z,{onChange:He,value:c==null?void 0:c.id,style:{width:300},placeholder:"Please select a asset",children:[(0,t.jsx)(s,{label:"No CPE",children:se.map(function(h){return(0,t.jsx)(Ee,{value:h.id,children:h.name},h.id)})}),(0,t.jsx)(s,{label:"Has CPE",children:Q.map(function(h){return(0,t.jsx)(Ee,{value:h.id,children:h.name},h.id)})})]})}),(0,t.jsx)(y.Z,{span:12,children:(c==null?void 0:c.name)&&(0,t.jsxs)("ul",{children:[(0,t.jsx)("li",{children:"Name: ".concat(c.name)}),(0,t.jsx)("li",{children:"Type: ".concat((0,ae.JS)(c.part))}),(0,t.jsx)("li",{children:"Vendor: ".concat(c.vendor)}),(0,t.jsx)("li",{children:"Product: ".concat(c.product)}),(0,t.jsx)("li",{children:"Version: ".concat(c.version)}),(0,t.jsx)("li",{children:"CPE: ".concat(c.cpe)}),(0,t.jsx)("li",{children:"Mapping CPE: ".concat(c.mapping_cpe)})]})})]}),(0,t.jsxs)(t.Fragment,{children:[(c==null?void 0:c.id)&&(0,t.jsxs)(O.Z,{style:{marginTop:20},gutter:16,children:[(0,t.jsx)(y.Z,{span:4,children:"Find with keyword"}),(0,t.jsx)(y.Z,{span:6,children:(0,t.jsx)(ne.Z,{value:R,onChange:ze})}),(0,t.jsx)(y.Z,{span:11,children:(0,t.jsx)(Y.Z,{type:"primary",disabled:!R,onClick:Je,children:"Search"})}),(0,t.jsx)(y.Z,{span:3,children:(0,t.jsx)(Y.Z,{type:"primary",onClick:Ye,disabled:De.length===0,loading:$,children:"Assign"})})]}),(0,t.jsx)(O.Z,{style:{marginTop:20},children:(0,t.jsx)(y.Z,{span:24,children:(0,t.jsx)(V.Z,{rowSelection:{selectedRowKeys:De,onChange:Be,type:"radio"},columns:Xe,dataSource:Te.map(function(h){return(0,r.Z)((0,r.Z)({},h),{},{key:h.id})}),bordered:!0,loading:de})})})]})]})},o=i,f=n(49111),a=n(19650),v=n(402),Z=n(97272),Le=n(7085),Ie=n(27596),Me=n(76731),Re=j.Z.Option,ke=j.Z.OptGroup,$e=Z.Z.Paragraph,Ue=function(x){var w=x.deploymentScenario,C=x.assets,z=x.setAssets,J=(0,u.useState)([]),I=(0,l.Z)(J,2),se=I[0],K=I[1],X=(0,u.useState)([]),M=(0,l.Z)(X,2),Q=M[0],ue=M[1],D=(0,u.useState)(!1),A=(0,l.Z)(D,2),Te=A[0],q=A[1],oe=(0,u.useRef)(),ce=(0,u.useState)(!1),he=(0,l.Z)(ce,2),le=he[0],ge=he[1],pe=(0,u.useState)({}),R=(0,l.Z)(pe,2),m=R[0],k=R[1],G=function(g){var T=C.find(function($){return $.id===g});k(T),oe.current&&oe.current.reload()},de=[{title:"CVE ID",dataIndex:"cve_id",key:"cve_id",width:"20%"},{title:"Description",dataIndex:"description",key:"description",width:"60%",render:function(g){return(0,t.jsx)($e,{ellipsis:{tooltip:g,rows:3},children:g})}},{title:"CVSS Severity",dataIndex:"impact",key:"cvss",width:"20%",render:function(g){var T,$,W,ee;return(0,t.jsxs)(a.Z,{direction:"vertical",size:"middle",children:[(0,t.jsxs)("div",{children:["V3: ",(0,t.jsx)(Me.Z,{cvss:g==null||(T=g.baseMetricV3)===null||T===void 0||($=T.cvssV3)===null||$===void 0?void 0:$.baseScore})]}),(0,t.jsxs)("div",{children:["V2: ",(0,t.jsx)(Me.Z,{cvss:g==null||(W=g.baseMetricV2)===null||W===void 0||(ee=W.cvssV2)===null||ee===void 0?void 0:ee.baseScore})]})]})}}];return(0,u.useEffect)(function(){q(!0);var S=C.filter(function(g){return g.mapping_cpe});K(S),(S==null?void 0:S.length)<(C==null?void 0:C.length)?_.default.error("Please mapping all asset to CPE!"):q(!1)},[C]),Te?"":(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(O.Z,{gutter:16,children:[(0,t.jsx)(y.Z,{span:2,children:(0,t.jsx)("label",{children:"Asset : "})}),(0,t.jsx)(y.Z,{span:8,children:(0,t.jsx)(j.Z,{onChange:G,value:m==null?void 0:m.id,style:{width:300},placeholder:"Please select a asset",children:(0,t.jsx)(ke,{label:"Has CPE",children:se.map(function(S){return(0,t.jsx)(Re,{value:S.id,children:S.name},S.id)})})})}),(0,t.jsx)(y.Z,{span:2,children:le&&(0,t.jsx)(Le.Z,{style:{fontSize:"200%"}})}),(0,t.jsx)(y.Z,{span:12,children:(m==null?void 0:m.name)&&(0,t.jsxs)("ul",{children:[(0,t.jsx)("li",{children:"Name: ".concat(m.name)}),(0,t.jsx)("li",{children:"Type: ".concat((0,ae.JS)(m.part))}),(0,t.jsx)("li",{children:"Vendor: ".concat(m.vendor)}),(0,t.jsx)("li",{children:"Product: ".concat(m.product)}),(0,t.jsx)("li",{children:"Version: ".concat(m.version)}),(0,t.jsx)("li",{children:"CPE: ".concat(m.cpe)})]})})]}),(m==null?void 0:m.name)&&(0,t.jsx)(O.Z,{style:{marginTop:20},children:(0,t.jsx)(y.Z,{span:24,children:(0,t.jsx)(Ie.ZP,{actionRef:oe,rowKey:"cve_id",search:!1,request:function(){var S=(0,d.Z)(L().mark(function g(T){var $,W,ee;return L().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return $=T.pageSize,W=T.current,c.next=3,(0,me.km)(w.id,m.id,{pageSize:$,current:W});case 3:return ee=c.sent,c.abrupt("return",ee);case 5:case"end":return c.stop()}},g)}));return function(g){return S.apply(this,arguments)}}(),columns:de,pagination:{pageSize:10},toolbar:{settings:[]},bordered:!0})})})]})},Ne=Ue,Ke=p.Z.Step,Ge=function(x){var w=x.deploymentScenario,C=(0,u.useState)(0),z=(0,l.Z)(C,2),J=z[0],I=z[1],se=(0,u.useState)([]),K=(0,l.Z)(se,2),X=K[0],M=K[1];(0,u.useEffect)(function(){if(w!=null&&w.assets){var D=w.assets.map(function(A){return(0,r.Z)((0,r.Z)({},A),{},{mapping_cpe:A.cpe})});M(D)}},[w]);var Q=[{id:0,title:"Mapping Asset to CPE",content:(0,t.jsx)(o,{deploymentScenario:w,assets:X,setAssets:M})},{id:1,title:"Mapping CPE to CVE",content:(0,t.jsx)(Ne,{deploymentScenario:w,assets:X,setAssets:M})}],ue=function(A){I(A)};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(p.Z,{current:J,onChange:ue,children:Q.map(function(D){return(0,t.jsx)(Ke,{title:D.title,style:{cursor:"pointer"}},D.id)})}),(0,t.jsx)("div",{className:U().steps_content,children:Q[J].content})]})},We=Ge},15433:function(fe,re,n){"use strict";n.d(re,{h8:function(){return ve},v$:function(){return B},LZ:function(){return ye},YC:function(){return Se},bg:function(){return Ce},oC:function(){return d},Rt:function(){return j},Fx:function(){return L},km:function(){return we},s9:function(){return Ee}});var r=n(11849),l=n(3182),ie=n(94043),p=n.n(ie),u=n(64172);function ve(s,i){return U.apply(this,arguments)}function U(){return U=(0,l.Z)(p().mark(function s(i,o){return p().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,u.ZP)("/api/deployment_scenarios",(0,r.Z)({method:"GET",params:(0,r.Z)({},i)},o||{})));case 1:case"end":return a.stop()}},s)})),U.apply(this,arguments)}function B(s,i,o){return V.apply(this,arguments)}function V(){return V=(0,l.Z)(p().mark(function s(i,o,f){return p().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.abrupt("return",(0,u.ZP)("/api/deployment_scenarios/".concat(i),(0,r.Z)({method:"GET",params:(0,r.Z)({},o)},f||{})));case 1:case"end":return v.stop()}},s)})),V.apply(this,arguments)}function _e(s,i,o){return Y.apply(this,arguments)}function Y(){return Y=_asyncToGenerator(_regeneratorRuntime.mark(function s(i,o,f){return _regeneratorRuntime.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.abrupt("return",api("/api/deployment_scenarios/".concat(i,"/attackers"),_objectSpread({method:"GET",params:_objectSpread({},o)},f||{})));case 1:case"end":return v.stop()}},s)})),Y.apply(this,arguments)}function je(s,i,o){return ne.apply(this,arguments)}function ne(){return ne=_asyncToGenerator(_regeneratorRuntime.mark(function s(i,o,f){return _regeneratorRuntime.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.abrupt("return",api("/api/deployment_scenarios/".concat(i,"/attackers"),_objectSpread({data:o,method:"POST"},f||{})));case 1:case"end":return v.stop()}},s)})),ne.apply(this,arguments)}function ye(s,i){return O.apply(this,arguments)}function O(){return O=(0,l.Z)(p().mark(function s(i,o){return p().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,u.ZP)("/api/deployment_scenarios",(0,r.Z)({data:i,method:"POST"},o||{})));case 1:case"end":return a.stop()}},s)})),O.apply(this,arguments)}function Se(s,i,o){return y.apply(this,arguments)}function y(){return y=(0,l.Z)(p().mark(function s(i,o,f){return p().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.abrupt("return",(0,u.ZP)("/api/deployment_scenarios/".concat(i),(0,r.Z)({data:o,method:"PUT"},f||{})));case 1:case"end":return v.stop()}},s)})),y.apply(this,arguments)}function Ce(s,i,o,f){return _.apply(this,arguments)}function _(){return _=(0,l.Z)(p().mark(function s(i,o,f,a){return p().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:return Z.abrupt("return",(0,u.ZP)("/api/deployment_scenarios/".concat(i,"/assets/").concat(o),(0,r.Z)({data:f,method:"PUT"},a||{})));case 1:case"end":return Z.stop()}},s)})),_.apply(this,arguments)}function d(s,i){return e.apply(this,arguments)}function e(){return e=(0,l.Z)(p().mark(function s(i,o){return p().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,u.ZP)("/api/deployment_scenarios/".concat(i),(0,r.Z)({method:"DELETE"},o||{})));case 1:case"end":return a.stop()}},s)})),e.apply(this,arguments)}function j(s,i){return N.apply(this,arguments)}function N(){return N=(0,l.Z)(p().mark(function s(i,o){return p().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,u.ZP)("/api/helper/generate_coordinates",(0,r.Z)({method:"POST",data:i},o||{})));case 1:case"end":return a.stop()}},s)})),N.apply(this,arguments)}function L(s,i){return ae.apply(this,arguments)}function ae(){return ae=(0,l.Z)(p().mark(function s(i,o){return p().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,u.ZP)("/api/deployment_scenarios/mapping_cpe",(0,r.Z)({method:"GET",params:(0,r.Z)({},i)},o||{})));case 1:case"end":return a.stop()}},s)})),ae.apply(this,arguments)}function me(s,i){return t.apply(this,arguments)}function t(){return t=_asyncToGenerator(_regeneratorRuntime.mark(function s(i,o){return _regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",api("/api/deployment_scenarios/mapping_cve",_objectSpread({method:"GET",params:_objectSpread({},i)},o||{})));case 1:case"end":return a.stop()}},s)})),t.apply(this,arguments)}function we(s,i,o,f){return Ze.apply(this,arguments)}function Ze(){return Ze=(0,l.Z)(p().mark(function s(i,o,f,a){return p().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:return Z.abrupt("return",(0,u.ZP)("/api/deployment_scenarios/".concat(i,"/assets/").concat(o,"/cves"),(0,r.Z)({method:"GET",params:(0,r.Z)({},f)},a||{})));case 1:case"end":return Z.stop()}},s)})),Ze.apply(this,arguments)}var Ee=function(){var s=(0,l.Z)(p().mark(function i(o,f,a){return p().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:return Z.abrupt("return",(0,u.ZP)("/api/deployment_scenarios/".concat(o,"/attack_graph/cves"),(0,r.Z)({method:"GET",params:(0,r.Z)({},f)},a||{})));case 1:case"end":return Z.stop()}},i)}));return function(o,f,a){return s.apply(this,arguments)}}()},44743:function(fe,re,n){"use strict";n.d(re,{w7:function(){return l},JS:function(){return ie},Zb:function(){return p},gu:function(){return u},$U:function(){return U},O3:function(){return B},vh:function(){return V},rJ:function(){return _e},zd:function(){return Y},Ou:function(){return je},Vd:function(){return ne},eX:function(){return ye},jv:function(){return O},lf:function(){return Se},xe:function(){return y},AC:function(){return Ce},Mc:function(){return _}});var r=n(32611),l=function(e){switch(e){case"OS":return"o";case"APPLICATION":return"a";case"HARDWARE":return"h";default:return}},ie=function(e){switch(e){case"o":return"OS";case"a":return"APPLICATION";case"h":return"HARDWARE";default:return}},p=function(e){switch(e){case"HIGH":return 3;case"MEDIUM":return 2;case"LOW":return 1;default:return}},u=function(e){return e.substring(0,10)},ve=function(e){return e.replace(/\w\S*/g,function(j){return j.charAt(0).toUpperCase()+j.substr(1).toLowerCase()})},U=function(e){return e>=9?["Critical",r.jv]:e>=7?["High",r.U1]:e>=4?["Medium",r.WY]:["Low",r.q6]},B=function(e){return e==="Critical"?r.jv:e==="High"?r.U1:e==="Medium"?r.WY:r.q6},V=function(e){return e<=1.8?["Negligible",1]:e<=3.6?["Low",2]:e<=5.4?["Moderate",3]:e<=7.2?["Significant",4]:["Catastrophic",5]},_e=function(e){return e<=.2?["Improbable",1]:e<=.4?["Remote",2]:e<=.6?["Occsional",3]:e<=.8?["Probale",4]:["Frequent",5]},Y=function(e,j){var N=e*j;return N>12?["Critical",r.jv,4]:N>7?["High",r.U1,3]:N>3?["Medium",r.WY,2]:["Low",r.q6,1]},je=function(e){return e===4?"Critical":e===3?"High":e===2?"Medium":e===1?"Low":""},ne=function(e){return e===5?"Catastrophic":e===4?"Significant":e===3?"Moderate":e===2?"Low":e===1?"Negligible":""},ye=function(e){return e===5?"Frequent":e===4?"Probale":e===3?"Occsional":e===2?"Remote":e===1?"Improbable":""},O=function(e){return Math.round(e*100)/100},Se=function(e){return e<=.25?["Low",r.q6]:e<=.5?["Medium",r.WY]:e<=.75?["High",r.U1]:["Critical",r.jv]},y=function(e){return e==="Negligible"?r.Fe:e==="Low"?r.q6:e==="Moderate"?r.WY:e==="Significant"?r.U1:r.jv},Ce=function(e){return e==="Improbable"?r.Fe:e==="Low"?r.q6:e==="Occsional"?r.WY:e==="Significant"?r.U1:r.jv},_=function(e){return e==="None"?r.Fe:e==="Low"?r.q6:e==="Medium"?r.WY:e==="High"?r.U1:r.jv}}}]);
