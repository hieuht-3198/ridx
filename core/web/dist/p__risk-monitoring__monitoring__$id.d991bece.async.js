(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[967],{84994:function(fe){fe.exports={contextMenu:"contextMenu___353oV",item:"item___1ykv9",anticon:"anticon___2h_2S"}},4337:function(fe){fe.exports={detailPanel:"detailPanel___W0my0"}},59596:function(fe){fe.exports={itemPanel:"itemPanel___ezM68"}},5708:function(fe){fe.exports={toolbar:"toolbar___RzMVD",tooltip:"tooltip___3iCtM"}},3600:function(fe){fe.exports={editor:"editor___2YdIU",editorHd:"editorHd___3sNJv",editorBd:"editorBd___2BN6D",editorSidebar:"editorSidebar___32Jmi",editorContent:"editorContent___3H5HO",flow:"flow___1lqtH",mind:"mind___20DcH",koni:"koni___2xRrv"}},87445:function(fe,je,s){"use strict";s.d(je,{b:function(){return S}});var c=s(11849),B=s(3182),Pe=s(94043),h=s.n(Pe),I=s(64172);function S(p,se){return pe.apply(this,arguments)}function pe(){return pe=(0,B.Z)(h().mark(function p(se,m){return h().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.abrupt("return",(0,I.ZP)("/api/cves",(0,c.Z)({method:"GET",params:(0,c.Z)({},se)},m||{})));case 1:case"end":return j.stop()}},p)})),pe.apply(this,arguments)}function De(p,se){return le.apply(this,arguments)}function le(){return le=_asyncToGenerator(_regeneratorRuntime.mark(function p(se,m){return _regeneratorRuntime.wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.abrupt("return",api("/api/cves",_objectSpread({data:se,method:"PUT"},m||{})));case 1:case"end":return j.stop()}},p)})),le.apply(this,arguments)}},15433:function(fe,je,s){"use strict";s.d(je,{h8:function(){return S},v$:function(){return De},LZ:function(){return j},YC:function(){return k},bg:function(){return E},oC:function(){return y},Rt:function(){return ke},Fx:function(){return Fe},km:function(){return Ke},s9:function(){return Ue}});var c=s(11849),B=s(3182),Pe=s(94043),h=s.n(Pe),I=s(64172);function S(b,v){return pe.apply(this,arguments)}function pe(){return pe=(0,B.Z)(h().mark(function b(v,G){return h().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return C.abrupt("return",(0,I.ZP)("/api/deployment_scenarios",(0,c.Z)({method:"GET",params:(0,c.Z)({},v)},G||{})));case 1:case"end":return C.stop()}},b)})),pe.apply(this,arguments)}function De(b,v,G){return le.apply(this,arguments)}function le(){return le=(0,B.Z)(h().mark(function b(v,G,U){return h().wrap(function($){for(;;)switch($.prev=$.next){case 0:return $.abrupt("return",(0,I.ZP)("/api/deployment_scenarios/".concat(v),(0,c.Z)({method:"GET",params:(0,c.Z)({},G)},U||{})));case 1:case"end":return $.stop()}},b)})),le.apply(this,arguments)}function p(b,v,G){return se.apply(this,arguments)}function se(){return se=_asyncToGenerator(_regeneratorRuntime.mark(function b(v,G,U){return _regeneratorRuntime.wrap(function($){for(;;)switch($.prev=$.next){case 0:return $.abrupt("return",api("/api/deployment_scenarios/".concat(v,"/attackers"),_objectSpread({method:"GET",params:_objectSpread({},G)},U||{})));case 1:case"end":return $.stop()}},b)})),se.apply(this,arguments)}function m(b,v,G){return d.apply(this,arguments)}function d(){return d=_asyncToGenerator(_regeneratorRuntime.mark(function b(v,G,U){return _regeneratorRuntime.wrap(function($){for(;;)switch($.prev=$.next){case 0:return $.abrupt("return",api("/api/deployment_scenarios/".concat(v,"/attackers"),_objectSpread({data:G,method:"POST"},U||{})));case 1:case"end":return $.stop()}},b)})),d.apply(this,arguments)}function j(b,v){return re.apply(this,arguments)}function re(){return re=(0,B.Z)(h().mark(function b(v,G){return h().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return C.abrupt("return",(0,I.ZP)("/api/deployment_scenarios",(0,c.Z)({data:v,method:"POST"},G||{})));case 1:case"end":return C.stop()}},b)})),re.apply(this,arguments)}function k(b,v,G){return F.apply(this,arguments)}function F(){return F=(0,B.Z)(h().mark(function b(v,G,U){return h().wrap(function($){for(;;)switch($.prev=$.next){case 0:return $.abrupt("return",(0,I.ZP)("/api/deployment_scenarios/".concat(v),(0,c.Z)({data:G,method:"PUT"},U||{})));case 1:case"end":return $.stop()}},b)})),F.apply(this,arguments)}function E(b,v,G,U){return te.apply(this,arguments)}function te(){return te=(0,B.Z)(h().mark(function b(v,G,U,C){return h().wrap(function(Ce){for(;;)switch(Ce.prev=Ce.next){case 0:return Ce.abrupt("return",(0,I.ZP)("/api/deployment_scenarios/".concat(v,"/assets/").concat(G),(0,c.Z)({data:U,method:"PUT"},C||{})));case 1:case"end":return Ce.stop()}},b)})),te.apply(this,arguments)}function y(b,v){return l.apply(this,arguments)}function l(){return l=(0,B.Z)(h().mark(function b(v,G){return h().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return C.abrupt("return",(0,I.ZP)("/api/deployment_scenarios/".concat(v),(0,c.Z)({method:"DELETE"},G||{})));case 1:case"end":return C.stop()}},b)})),l.apply(this,arguments)}function ke(b,v){return Re.apply(this,arguments)}function Re(){return Re=(0,B.Z)(h().mark(function b(v,G){return h().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return C.abrupt("return",(0,I.ZP)("/api/helper/generate_coordinates",(0,c.Z)({method:"POST",data:v},G||{})));case 1:case"end":return C.stop()}},b)})),Re.apply(this,arguments)}function Fe(b,v){return Qe.apply(this,arguments)}function Qe(){return Qe=(0,B.Z)(h().mark(function b(v,G){return h().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return C.abrupt("return",(0,I.ZP)("/api/deployment_scenarios/mapping_cpe",(0,c.Z)({method:"GET",params:(0,c.Z)({},v)},G||{})));case 1:case"end":return C.stop()}},b)})),Qe.apply(this,arguments)}function qe(b,v){return Ye.apply(this,arguments)}function Ye(){return Ye=_asyncToGenerator(_regeneratorRuntime.mark(function b(v,G){return _regeneratorRuntime.wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return C.abrupt("return",api("/api/deployment_scenarios/mapping_cve",_objectSpread({method:"GET",params:_objectSpread({},v)},G||{})));case 1:case"end":return C.stop()}},b)})),Ye.apply(this,arguments)}function Ke(b,v,G,U){return et.apply(this,arguments)}function et(){return et=(0,B.Z)(h().mark(function b(v,G,U,C){return h().wrap(function(Ce){for(;;)switch(Ce.prev=Ce.next){case 0:return Ce.abrupt("return",(0,I.ZP)("/api/deployment_scenarios/".concat(v,"/assets/").concat(G,"/cves"),(0,c.Z)({method:"GET",params:(0,c.Z)({},U)},C||{})));case 1:case"end":return Ce.stop()}},b)})),et.apply(this,arguments)}var Ue=function(){var b=(0,B.Z)(h().mark(function v(G,U,C){return h().wrap(function(Ce){for(;;)switch(Ce.prev=Ce.next){case 0:return Ce.abrupt("return",(0,I.ZP)("/api/deployment_scenarios/".concat(G,"/attack_graph/cves"),(0,c.Z)({method:"GET",params:(0,c.Z)({},U)},C||{})));case 1:case"end":return Ce.stop()}},v)}));return function(G,U,C){return b.apply(this,arguments)}}()},44580:function(fe,je,s){"use strict";s.r(je),s.d(je,{default:function(){return Qr}});var c=s(58024),B=s(91894),Pe=s(98858),h=s(4914),I=s(3182),S=s(2824),pe=s(18106),De=s(51752),le=s(94043),p=s.n(le),se=s(51885),m=s(67294),d=s(11849),j=s(64172);function re(i,t,r){return k.apply(this,arguments)}function k(){return k=_asyncToGenerator(_regeneratorRuntime.mark(function i(t,r,o){return _regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",api("/api/assessments/".concat(t),_objectSpread({method:"GET",params:_objectSpread({},r)},o||{})));case 1:case"end":return a.stop()}},i)})),k.apply(this,arguments)}function F(i,t){return E.apply(this,arguments)}function E(){return E=_asyncToGenerator(_regeneratorRuntime.mark(function i(t,r){return _regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",api("/api/attack_graphs",_objectSpread({method:"GET",params:_objectSpread({},t)},r||{})));case 1:case"end":return n.stop()}},i)})),E.apply(this,arguments)}function te(i,t){return y.apply(this,arguments)}function y(){return y=_asyncToGenerator(_regeneratorRuntime.mark(function i(t,r){return _regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",api("/api/countermeasures",_objectSpread({method:"GET",params:_objectSpread({},t)},r||{})));case 1:case"end":return n.stop()}},i)})),y.apply(this,arguments)}function l(i,t,r){return ke.apply(this,arguments)}function ke(){return ke=_asyncToGenerator(_regeneratorRuntime.mark(function i(t,r,o){return _regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",api("/api/deployment_scenarios/".concat(t,"/assessment"),_objectSpread({method:"POST",headers:{"Content-Type":"application/json"},data:r},o||{})));case 1:case"end":return a.stop()}},i)})),ke.apply(this,arguments)}function Re(i,t,r){return Fe.apply(this,arguments)}function Fe(){return Fe=(0,I.Z)(p().mark(function i(t,r,o){return p().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,j.ZP)("/api/risk_monitoring/".concat(t,"/monitoring"),(0,d.Z)({method:"POST",headers:{"Content-Type":"application/json"},data:r},o||{})));case 1:case"end":return a.stop()}},i)})),Fe.apply(this,arguments)}function Qe(i,t,r){return qe.apply(this,arguments)}function qe(){return qe=_asyncToGenerator(_regeneratorRuntime.mark(function i(t,r,o){return _regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",api("/api/deployment_scenarios/".concat(t,"/assets"),_objectSpread({method:"GET",params:_objectSpread({},r)},o||{})));case 1:case"end":return a.stop()}},i)})),qe.apply(this,arguments)}function Ye(i,t,r){return Ke.apply(this,arguments)}function Ke(){return Ke=(0,I.Z)(p().mark(function i(t,r,o){return p().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,j.ZP)("/api/risk_monitoring/".concat(t,"/monitoring/attack_graph_cve"),(0,d.Z)({method:"GET",params:(0,d.Z)({},r)},o||{})));case 1:case"end":return a.stop()}},i)})),Ke.apply(this,arguments)}function et(i,t,r){return Ue.apply(this,arguments)}function Ue(){return Ue=_asyncToGenerator(_regeneratorRuntime.mark(function i(t,r,o){return _regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",api("/api/deployment_scenarios/".concat(t,"/countermeasures"),_objectSpread({method:"GET",params:_objectSpread({},r)},o||{})));case 1:case"end":return a.stop()}},i)})),Ue.apply(this,arguments)}function b(i,t,r){return v.apply(this,arguments)}function v(){return v=_asyncToGenerator(_regeneratorRuntime.mark(function i(t,r,o){return _regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",api("/api/deployment_scenarios/".concat(t,"/attack_graph"),_objectSpread({method:"GET",params:_objectSpread({},r)},o||{})));case 1:case"end":return a.stop()}},i)})),v.apply(this,arguments)}function G(i,t,r,o){return U.apply(this,arguments)}function U(){return U=_asyncToGenerator(_regeneratorRuntime.mark(function i(t,r,o,n){return _regeneratorRuntime.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",api("/api/deployment_scenarios/".concat(t,"/assets/").concat(r,"/cves"),_objectSpread({method:"GET",params:_objectSpread({},o)},n||{})));case 1:case"end":return u.stop()}},i)})),U.apply(this,arguments)}function C(i,t,r,o){return $.apply(this,arguments)}function $(){return $=_asyncToGenerator(_regeneratorRuntime.mark(function i(t,r,o,n){return _regeneratorRuntime.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",api("/api/deployment_scenarios/".concat(t,"/attack_graph/assets/").concat(r,"/cves"),_objectSpread({method:"GET",params:_objectSpread({},o)},n||{})));case 1:case"end":return u.stop()}},i)})),$.apply(this,arguments)}function Ce(i,t,r,o,n){return it.apply(this,arguments)}function it(){return it=_asyncToGenerator(_regeneratorRuntime.mark(function i(t,r,o,n,a){return _regeneratorRuntime.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.abrupt("return",api("/api/deployment_scenarios/".concat(t,"/assets/").concat(r,"/cves/").concat(o),_objectSpread({method:"POST",headers:{"Content-Type":"application/json"},data:n},a||{})));case 1:case"end":return g.stop()}},i)})),it.apply(this,arguments)}function an(i,t,r,o){return ot.apply(this,arguments)}function ot(){return ot=_asyncToGenerator(_regeneratorRuntime.mark(function i(t,r,o,n){return _regeneratorRuntime.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",api("/api/deployment_scenarios/".concat(t,"/assets/").concat(r,"/cves"),_objectSpread({method:"PUT",headers:{"Content-Type":"application/json"},data:o},n||{})));case 1:case"end":return u.stop()}},i)})),ot.apply(this,arguments)}function sn(i,t,r,o){return ut.apply(this,arguments)}function ut(){return ut=_asyncToGenerator(_regeneratorRuntime.mark(function i(t,r,o,n){return _regeneratorRuntime.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",api("/api/deployment_scenarios/".concat(t,"/attack_graph/assets/").concat(r,"/cves"),_objectSpread({method:"POST",headers:{"Content-Type":"application/json"},data:o},n||{})));case 1:case"end":return u.stop()}},i)})),ut.apply(this,arguments)}var Kt=function(){var i=(0,I.Z)(p().mark(function t(r,o,n){return p().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",(0,j.ZP)("/api/risk_monitoring/".concat(r,"/detect_threat"),(0,d.Z)({method:"POST",headers:{"Content-Type":"application/json"},data:o},n||{})));case 1:case"end":return u.stop()}},t)}));return function(r,o,n){return i.apply(this,arguments)}}(),tt=s(15433),xt=s(70345),on=s(13062),Ve=s(71230),un=s(9715),Oe=s(17681),ln=s(43358),Ze=s(34041),cn=s(89032),xe=s(15746),dn=s(48736),ze=s(27049),lt=s(86582),pn=s(34792),Be=s(48086),Me=s(44743),rt=s(80652),ct=s(952),dt=s(31199),Ut=s(1677),$t=s(6842),Ht=s(74295),Jt=s(93162),Xt=s.n(Jt),e=s(85893),Qt=function(t){var r=t.deployment_scenario_id,o=t.sync,n=t.setSync,a=".xlsx",u="risk_monitoring_observer_data_template",g=r,A=(0,m.useRef)(),Y=(0,m.useState)(!1),W=(0,S.Z)(Y,2),R=W[0],H=W[1],L=2,V=["All"],O=(0,m.useState)([]),N=(0,S.Z)(O,2),z=N[0],_=N[1],J=(0,m.useState)([]),x=(0,S.Z)(J,2),K=x[0],P=x[1],w=(0,m.useState)([]),f=(0,S.Z)(w,2),ne=f[0],me=f[1],X=(0,m.useState)({}),ie=(0,S.Z)(X,2),ae=ie[0],oe=ie[1],ge=(0,m.useState)({}),ve=(0,S.Z)(ge,2),Ae=ve[0],Ee=ve[1],Te={data:z,xField:"Step",yField:"risk level",label:{},yAxis:{label:{formatter:function(ue){return(0,Me.Ou)(parseInt(ue))},offset:1},min:0,max:5},point:{size:5,shape:"diamond",style:{fill:"white",stroke:"#5B8FF9",lineWidth:2}},tooltip:{showMarkers:!1,fields:["Severity","Likelihood","Risk level"]},state:{active:{style:{shadowBlur:4,stroke:"#000",fill:"red"}}},interactions:[{type:"marker-active"}]},at=(0,d.Z)((0,d.Z)({},Te),{},{yField:"severity",yAxis:{label:{formatter:function(ue){return(0,Me.Vd)(parseInt(ue))},offset:1},min:0,max:6}}),qr=(0,d.Z)((0,d.Z)({},Te),{},{yField:"likelihood",yAxis:{label:{formatter:function(ue){return(0,Me.eX)(parseInt(ue))},offset:1},min:0,max:6}}),en={data:K,xField:"Step",yField:"Severity",seriesField:"Asset name",label:{},point:{size:5,shape:"diamond",style:{fill:"white",stroke:"#5B8FF9",lineWidth:2}},tooltip:{showMarkers:!1},yAxis:{label:{offset:1},min:-1,max:10},legend:{position:"top"}},tn=function(){var ye=(0,I.Z)(p().mark(function ue(){var Q,Ie,Z,T;return p().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return H(!0),D.next=3,Ye(g);case 3:if(Q=D.sent,!Q){D.next=17;break}return me(Q.data),D.next=8,(0,tt.v$)(g);case 8:if(Z=D.sent,oe(Z.data),!(Z!=null&&Z.data)){D.next=15;break}return D.next=13,(0,xt.Cv)(Z.data.system_profile_id);case 13:T=D.sent,Ee(T==null?void 0:T.data);case 15:return D.next=17,Yt(A==null||(Ie=A.current)===null||Ie===void 0?void 0:Ie.getFieldsValue());case 17:H(!1);case 18:case"end":return D.stop()}},ue)}));return function(){return ye.apply(this,arguments)}}(),rn=function(){var ye=(0,I.Z)(p().mark(function ue(Q){var Ie,Z,T,q,D,de,Ge,M;return p().wrap(function(we){for(;;)switch(we.prev=we.next){case 0:return we.next=2,Re(g,Q);case 2:if(Ie=we.sent,Z=[],!Ie){we.next=15;break}for(Ie.data.cia.map(function(_e){return _e.cia.map(function(be,he){return Z.push({"Asset name":_e.name,Severity:(0,Me.jv)(9-be),step:he,Step:"Step ".concat(he),CIA:(0,Me.jv)(be)}),be}),_e}),T=Ie.data.likelihood.outcomes.map(function(_e,be){return{Likelihood:(0,Me.rJ)(_e.True),Step:be,likelihood:_e.True}}),q=[],D=function(be){q.push({Step:be,Severity:(0,Me.vh)(Z.filter(function(he){return he.step==be}).reduce(function(he,st){return he+st.Severity},0)/Z.length*Q.time_step),severity:Z.filter(function(he){return he.step==be}).reduce(function(he,st){return he+st.Severity},0)/Z.length*Q.time_step})},de=0;de<Q.time_step;de++)D(de);for(Ge=[],M=0;M<Q.time_step;M++)Ge.push({Step:"Step ".concat(M),Severity:q[M].Severity[0],severity:q[M].Severity[1],Likelihood:T[M].Likelihood[0],likelihood:T[M].Likelihood[1],"Risk level":(0,Me.zd)(q[M].Severity[1],T[M].Likelihood[1])[0],"risk level":(0,Me.zd)(q[M].Severity[1],T[M].Likelihood[1])[2]});return P(Z),_(Ge),we.abrupt("return",!0);case 15:return we.abrupt("return",!1);case 16:case"end":return we.stop()}},ue)}));return function(Q){return ye.apply(this,arguments)}}(),nn=function(){var ye=(0,I.Z)(p().mark(function ue(){var Q,Ie,Z,T,q,D;return p().wrap(function(Ge){for(;;)switch(Ge.prev=Ge.next){case 0:return Ie=new Ht.Workbook,Z=Ie.addWorksheet("General"),T=5,Z.mergeCells("A1","B1"),Z.getCell("A1").value="System profile",Z.getRow(2).values=[null,"ID",Ae.id],Z.getRow(3).values=[null,"Name",Ae.name],Z.getRow(4).values=[null,"Description",Ae.description],(Q=Object.keys(Ae==null?void 0:Ae.custom_fields))===null||Q===void 0||Q.map(function(M){Z.getRow(T).values=[null,M,Ae.custom_fields[M]],T++}),Z.getRow(T++).values=[null,"Created by",Ae.created_by],Z.getRow(T++).values=[null,"Updated by",Ae.updated_by],Z.getRow(T++).values=[null,"Created at",Ae.created_at],Z.getRow(T++).values=[null,"Updated at",Ae.updated_at],Z.mergeCells("A".concat(T),"B".concat(T)),Z.getCell("A".concat(T)).value="Deployment scenario",T++,Z.getRow(T++).values=[null,"Name",ae.name],Z.getRow(T++).values=[null,"Description",ae.description],Z.getRow(T++).values=[null,"Stage",ae.status],Z.mergeCells("A".concat(T),"B".concat(T)),Z.getCell("A".concat(T)).value="Asset",T++,Z.getRow(T++).values=[null,"ID","Name","Number CVE"],ne.map(function(M){Z.getRow(T++).values=[null,M.asset_id,M.asset_name,M.cves.length]}),q=Ie.addWorksheet("Observer data"),q.mergeCells("A1","B1"),q.getCell("A1").value="Observer data",q.mergeCells("D3","X3"),q.getCell("D3").value="Observer step",D=4,q.getRow(D++).values=[null,null,null,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20],q.getRow(D++).values=["ID","Asset name","CVE"],ne.map(function(M){q.getRow(D++).values=[M.asset_id,M.asset_name],M.cves.map(function(He){q.getRow(D++).values=[null,null,He]}),D++}),Ge.next=35,Ie.xlsx.writeBuffer().then(function(M){return Xt().saveAs(new Blob([M]),u+a)}).catch(function(M){Be.default.error("Download error: ".concat(M))});case 35:case"end":return Ge.stop()}},ue)}));return function(){return ye.apply(this,arguments)}}(),Yt=function(){var ye=(0,I.Z)(p().mark(function ue(Q){var Ie,Z,T,q,D,de,Ge,M,He,we,_e,be,he;return p().wrap(function(ee){for(;;)switch(ee.prev=ee.next){case 0:if(Z=[],!(Q!=null&&(Ie=Q.observer_data)!==null&&Ie!==void 0&&Ie.length)){ee.next=39;break}return T=Q.observer_data[0].originFileObj,q=0,ee.prev=4,ee.next=7,(0,$t.Z)(T,{sheet:"Observer data"});case 7:D=ee.sent,de=5;case 9:if(!(de<D.length)){ee.next=29;break}if(Ge=D[de][0],de++,!(de>=D.length)){ee.next=14;break}return ee.abrupt("break",29);case 14:M=0;case 15:if(!D[de][2]){ee.next=26;break}for(He=D[de][2],we=[],_e=3;_e<D[de].length;_e++)D[de][_e]!==null&&(we.push({step:_e-3,value:D[de][_e]}),M=_e-2);if(q=q>M?q:M,Z.push({asset_id:Ge,cve_id:He,observer_data:we}),de++,de!=D.length){ee.next=24;break}return ee.abrupt("break",26);case 24:ee.next=15;break;case 26:de++,ee.next=9;break;case 29:ee.next=36;break;case 31:return ee.prev=31,ee.t0=ee.catch(4),console.log(ee.t0),Be.default.error("Please check observer data file!"),ee.abrupt("return",!0);case 36:if(!(q>Q.time_step)){ee.next=39;break}return Be.default.error("Observer step (".concat(q,") is greater than Time step (").concat(Q.time_step,")")),ee.abrupt("return",!0);case 39:return be={time_step:Q.time_step,observer_data:Z,node_temporals:[]},Q.node_temporals.includes("All")?be.node_temporals=["All"]:(he={},Q.node_temporals.map(function(Je){var Xe=Je.split("_");return he[Xe[1]]=he[Xe[1]]?[].concat((0,lt.Z)(he[Xe[1]]),[Xe[0]]):[Xe[0]],Je}),be.node_temporals=Object.keys(he).map(function(Je){return{asset_id:Je,cves:he[Je]}})),H(!0),ee.next=44,rn(be);case 44:H(!1);case 45:case"end":return ee.stop()}},ue,null,[[4,31]])}));return function(Q){return ye.apply(this,arguments)}}();return(0,m.useEffect)(function(){tn()},[o]),(0,e.jsxs)(Ve.Z,{gutter:20,children:[(0,e.jsxs)(xe.Z,{span:18,children:[(0,e.jsx)("h3",{children:"Risk level"}),(0,e.jsx)(rt.Z,(0,d.Z)({},Te)),(0,e.jsx)(ze.Z,{}),(0,e.jsx)("h3",{children:"Likelihood"}),(0,e.jsx)(rt.Z,(0,d.Z)((0,d.Z)({},qr),{},{loading:R})),(0,e.jsx)(ze.Z,{}),(0,e.jsx)("h3",{children:"Severity"}),(0,e.jsx)(rt.Z,(0,d.Z)({},at)),(0,e.jsx)(ze.Z,{}),(0,e.jsx)("h3",{children:"Asset severity"}),(0,e.jsx)(rt.Z,(0,d.Z)((0,d.Z)({},en),{},{loading:R}))]}),(0,e.jsx)(xe.Z,{span:6,children:(0,e.jsxs)(ct.ZP,{initialValues:{time_step:L,node_temporals:V},onFinish:Yt,formRef:A,children:[(0,e.jsx)(dt.Z,{label:"Time step",name:"time_step",min:2,max:20,rules:[{required:!0}]}),(0,e.jsx)(Oe.Z.Item,{label:"Node temporal(s)",name:"node_temporals",rules:[{required:!0}],children:(0,e.jsx)(Ze.Z,{mode:"multiple",options:[{label:"All",value:"All"}].concat((0,lt.Z)(ne==null?void 0:ne.map(function(ye){return{label:ye.asset_name,options:ye.cves.map(function(ue){return{label:"".concat(ue," on ").concat(ye.asset_name),value:"".concat(ue,"_").concat(ye.asset_id)}})}})))})}),(0,e.jsx)(Ut.Z,{name:"observer_data",label:"Observer data",max:1,action:"/api/upload_file",accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",fieldProps:{name:"file"},title:"Click to Upload",extra:(0,e.jsx)("a",{onClick:nn,children:"Download template observer data"})})]})})]})},qt=Qt,er=s(41516),wt=s(50161),Tt=s(25592),mn=s(57663),pt=s(71577),gn=s(49111),tr=s(19650),rr=s(27596),nr=s(5341),ar=function(t){var r=t.deployment_scenario_id,o=(0,m.useState)(!1),n=(0,S.Z)(o,2),a=n[0],u=n[1],g=(0,m.useState)([]),A=(0,S.Z)(g,2),Y=A[0],W=A[1],R=(0,m.useState)([]),H=(0,S.Z)(R,2),L=H[0],V=H[1],O=(0,m.useState)([]),N=(0,S.Z)(O,2),z=N[0],_=N[1],J=function(){var P=(0,I.Z)(p().mark(function w(){var f;return p().wrap(function(me){for(;;)switch(me.prev=me.next){case 0:return u(!0),me.next=3,(0,nr.T3)(r);case 3:f=me.sent,f&&(W(f.new_cves),V(f.remove_cves),_(f.assets)),u(!1);case 6:case"end":return me.stop()}},w)}));return function(){return P.apply(this,arguments)}}(),x=[{title:"Asset name",dataIndex:"asset_id",key:"asset_id",width:"40%",render:function(w){var f;return(f=z.find(function(ne){return ne.id===w}))===null||f===void 0?void 0:f.name}},{title:"CVE",dataIndex:"cves",key:"cves",render:function(w){return(0,e.jsx)(tr.Z,{children:w.map(function(f){return(0,e.jsx)("a",{onClick:function(){window.open("/data/cve/".concat(f),"_blank")},children:f},f)})})}}],K=[{title:"Asset name",dataIndex:"asset_id",key:"asset_id",width:"40%",render:function(w){var f;return(f=z.find(function(ne){return ne.id===w}))===null||f===void 0?void 0:f.name}},{title:"CVE",dataIndex:"cves",key:"cves",render:function(w){return w.join(",")}}];return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Ve.Z,{style:{marginBottom:20},children:(0,e.jsx)(xe.Z,{span:24,children:(0,e.jsx)(pt.Z,{type:"primary",onClick:(0,I.Z)(p().mark(function P(){return p().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,J();case 2:case"end":return f.stop()}},P)})),loading:a,children:"Scan"})})}),(0,e.jsx)(Ve.Z,{children:(0,e.jsxs)(xe.Z,{span:24,children:[(0,e.jsx)("h3",{children:"New CVE detect"}),(0,e.jsx)(rr.ZP,{dataSource:Y,columns:x,toolBarRender:!1,loading:a,bordered:!0,search:!1})]})})]})},sr=ar,In=s(89816),Gt=s(4042),Ne=s(32611);function hn(i,t,r){return mt.apply(this,arguments)}function mt(){return mt=_asyncToGenerator(_regeneratorRuntime.mark(function i(t,r,o){return _regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",api("/api/assessments/".concat(t),_objectSpread({method:"GET",params:_objectSpread({},r)},o||{})));case 1:case"end":return a.stop()}},i)})),mt.apply(this,arguments)}function vn(i,t){return gt.apply(this,arguments)}function gt(){return gt=_asyncToGenerator(_regeneratorRuntime.mark(function i(t,r){return _regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",api("/api/attack_graphs",_objectSpread({method:"GET",params:_objectSpread({},t)},r||{})));case 1:case"end":return n.stop()}},i)})),gt.apply(this,arguments)}function fn(i,t){return It.apply(this,arguments)}function It(){return It=_asyncToGenerator(_regeneratorRuntime.mark(function i(t,r){return _regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",api("/api/countermeasures",_objectSpread({method:"GET",params:_objectSpread({},t)},r||{})));case 1:case"end":return n.stop()}},i)})),It.apply(this,arguments)}function Cn(i,t,r){return ht.apply(this,arguments)}function ht(){return ht=_asyncToGenerator(_regeneratorRuntime.mark(function i(t,r,o){return _regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",api("/api/deployment_scenarios/".concat(t,"/assessment"),_objectSpread({method:"POST",headers:{"Content-Type":"application/json"},data:r},o||{})));case 1:case"end":return a.stop()}},i)})),ht.apply(this,arguments)}function ir(i,t,r){return vt.apply(this,arguments)}function vt(){return vt=(0,I.Z)(p().mark(function i(t,r,o){return p().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,j.ZP)("/api/deployment_scenarios/".concat(t,"/assets"),(0,d.Z)({method:"GET",params:(0,d.Z)({},r)},o||{})));case 1:case"end":return a.stop()}},i)})),vt.apply(this,arguments)}function An(i,t,r){return ft.apply(this,arguments)}function ft(){return ft=_asyncToGenerator(_regeneratorRuntime.mark(function i(t,r,o){return _regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",api("/api/deployment_scenarios/".concat(t,"/countermeasures"),_objectSpread({method:"GET",params:_objectSpread({},r)},o||{})));case 1:case"end":return a.stop()}},i)})),ft.apply(this,arguments)}function or(i,t,r){return Ct.apply(this,arguments)}function Ct(){return Ct=(0,I.Z)(p().mark(function i(t,r,o){return p().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,j.ZP)("/api/deployment_scenarios/".concat(t,"/attack_graph"),(0,d.Z)({method:"GET",params:(0,d.Z)({},r)},o||{})));case 1:case"end":return a.stop()}},i)})),Ct.apply(this,arguments)}function yn(i,t,r,o){return At.apply(this,arguments)}function At(){return At=_asyncToGenerator(_regeneratorRuntime.mark(function i(t,r,o,n){return _regeneratorRuntime.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",api("/api/deployment_scenarios/".concat(t,"/assets/").concat(r,"/cves"),_objectSpread({method:"GET",params:_objectSpread({},o)},n||{})));case 1:case"end":return u.stop()}},i)})),At.apply(this,arguments)}function ur(i,t,r,o){return yt.apply(this,arguments)}function yt(){return yt=(0,I.Z)(p().mark(function i(t,r,o,n){return p().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",(0,j.ZP)("/api/deployment_scenarios/".concat(t,"/attack_graph/assets/").concat(r,"/cves"),(0,d.Z)({method:"GET",params:(0,d.Z)({},o)},n||{})));case 1:case"end":return u.stop()}},i)})),yt.apply(this,arguments)}function _n(i,t,r,o,n){return _t.apply(this,arguments)}function _t(){return _t=_asyncToGenerator(_regeneratorRuntime.mark(function i(t,r,o,n,a){return _regeneratorRuntime.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.abrupt("return",api("/api/deployment_scenarios/".concat(t,"/assets/").concat(r,"/cves/").concat(o),_objectSpread({method:"POST",headers:{"Content-Type":"application/json"},data:n},a||{})));case 1:case"end":return g.stop()}},i)})),_t.apply(this,arguments)}function lr(i,t,r,o){return Zt.apply(this,arguments)}function Zt(){return Zt=(0,I.Z)(p().mark(function i(t,r,o,n){return p().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",(0,j.ZP)("/api/deployment_scenarios/".concat(t,"/assets/").concat(r,"/cves"),(0,d.Z)({method:"PUT",headers:{"Content-Type":"application/json"},data:o},n||{})));case 1:case"end":return u.stop()}},i)})),Zt.apply(this,arguments)}function Zn(i,t,r,o){return bt.apply(this,arguments)}function bt(){return bt=_asyncToGenerator(_regeneratorRuntime.mark(function i(t,r,o,n){return _regeneratorRuntime.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",api("/api/deployment_scenarios/".concat(t,"/attack_graph/assets/").concat(r,"/cves"),_objectSpread({method:"POST",headers:{"Content-Type":"application/json"},data:o},n||{})));case 1:case"end":return u.stop()}},i)})),bt.apply(this,arguments)}function bn(i,t,r){return St.apply(this,arguments)}function St(){return St=_asyncToGenerator(_regeneratorRuntime.mark(function i(t,r,o){return _regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",api("/api/deployment_scenarios/".concat(t,"/save_assessment"),_objectSpread({method:"POST",headers:{"Content-Type":"application/json"},data:r},o||{})));case 1:case"end":return a.stop()}},i)})),St.apply(this,arguments)}var Sn=s(3515),Pt=s(86288),jn=s(47673),cr=s(4107),Dt=s(32059),kt=s(93224),xn=s(402),Mt=s(97272),dr=Mt.Z.Paragraph,Et=m.createContext(null),pr=function(t){var r=t.index,o=(0,kt.Z)(t,["index"]),n=Oe.Z.useForm(),a=(0,S.Z)(n,1),u=a[0];return(0,e.jsx)(Oe.Z,{form:u,component:!1,children:(0,e.jsx)(Et.Provider,{value:u,children:(0,e.jsx)("tr",(0,d.Z)({},o))})})},mr=function(t){var r=t.title,o=t.editable,n=t.children,a=t.dataIndex,u=t.record,g=t.handleSave,A=(0,kt.Z)(t,["title","editable","children","dataIndex","record","handleSave"]),Y=(0,m.useState)(!1),W=(0,S.Z)(Y,2),R=W[0],H=W[1],L=(0,m.useRef)(null),V=(0,m.useContext)(Et);(0,m.useEffect)(function(){R&&L.current.focus()},[R]);var O=function(){H(!R),V.setFieldsValue((0,Dt.Z)({},a,u[a]))},N=function(){var _=(0,I.Z)(p().mark(function J(){var x;return p().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return P.prev=0,P.next=3,V.validateFields();case 3:x=P.sent,O(),g((0,d.Z)((0,d.Z)({},u),x)),P.next=11;break;case 8:P.prev=8,P.t0=P.catch(0),console.log("Save failed:",P.t0);case 11:case"end":return P.stop()}},J,null,[[0,8]])}));return function(){return _.apply(this,arguments)}}(),z=n;return o&&(z=R?(0,e.jsx)(Oe.Z.Item,{style:{margin:0},name:a,rules:[{required:!0,message:"".concat(r," is required.")},{validator:function(J,x){if(a=="exploitabilityScore"){if(!x)return Promise.reject();if(isNaN(x))return Promise.reject("".concat(r," has to be a number."));var K=parseFloat(x);if(K>10||K<0)return Promise.reject("".concat(r," between 0 and 10."))}return Promise.resolve()}}],children:a==="exploitabilityScore"?(0,e.jsx)(cr.Z,{ref:L,onBlur:N}):a==="attack_vector"?(0,e.jsx)(Ze.Z,{ref:L,onBlur:N,children:Ne.hG.map(function(_){return(0,e.jsx)(Ze.Z.Option,{value:_,children:_},_)})}):(0,e.jsx)(Ze.Z,{ref:L,onBlur:N,children:Ne.n4.map(function(_){return(0,e.jsx)(Ze.Z.Option,{value:_,children:_},_)})})}):(0,e.jsx)("div",{className:"editable-cell-value-wrap",style:{paddingRight:24},onClick:O,children:n})),(0,e.jsx)("td",(0,d.Z)((0,d.Z)({},A),{},{children:z}))},gr=function(t){var r=t.asset_id,o=t.deployment_scenario_id,n=t.sync,a=t.setSync,u=(0,m.useState)([]),g=(0,S.Z)(u,2),A=g[0],Y=g[1],W=[{title:"CVE ID",dataIndex:"cve_id",width:"20%"},{title:"Description",dataIndex:"description",width:"60%",hideInForm:!0,hideInSearch:!0,render:function(V){return(0,e.jsx)(dr,{ellipsis:{tooltip:V,rows:3},children:V})}},{title:"Exploitability",dataIndex:"exploitabilityScore",width:"20%",editable:!0}],R=function(){var L=(0,I.Z)(p().mark(function V(){var O;return p().wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return z.next=2,lr(o,r,{cves:A.map(function(_){return(0,d.Z)((0,d.Z)({},_),{},{impact:(0,d.Z)((0,d.Z)({},_.impact),{},{baseMetricV2:(0,d.Z)((0,d.Z)({},_.impact.baseMetricV2),{},{exploitabilityScore:_.exploitabilityScore})})})})});case 2:O=z.sent,O&&(Be.default.success("Save done!"),a(!n));case 4:case"end":return z.stop()}},V)}));return function(){return L.apply(this,arguments)}}();(0,m.useEffect)(function(){var L=function(){var V=(0,I.Z)(p().mark(function O(){var N,z,_;return p().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.next=2,ur(o,r,{pageSize:Ne.n1});case 2:z=x.sent,_=z==null||(N=z.data)===null||N===void 0?void 0:N.map(function(K){var P,w;return(0,d.Z)((0,d.Z)({key:K.id},K),{},{exploitabilityScore:K==null||(P=K.impact)===null||P===void 0||(w=P.baseMetricV2)===null||w===void 0?void 0:w.exploitabilityScore})}),Y(_);case 5:case"end":return x.stop()}},O)}));return function(){return V.apply(this,arguments)}}();L()},[]);var H=function(V){var O=(0,lt.Z)(A),N=O.findIndex(function(_){return V.cve_id===_.cve_id}),z=O[N];O.splice(N,1,(0,d.Z)((0,d.Z)({},z),(0,d.Z)((0,d.Z)({},V),{},{exploitabilityScore:parseFloat(V.exploitabilityScore)}))),Y(O)};return(0,e.jsxs)("div",{children:[(0,e.jsx)(Gt.Z,{rowKey:"cve_id",toolBarRender:!1,components:{body:{row:pr,cell:mr}},rowClassName:function(){return"editable-row"},bordered:!0,dataSource:A,columns:W.map(function(L){return L.editable?(0,d.Z)((0,d.Z)({},L),{},{onCell:function(O){return{record:O,editable:L.editable,dataIndex:L.dataIndex,title:L.title,handleSave:H}}}):L})}),(0,e.jsx)(Pt.Z,{style:{position:"fixed",right:50,bottom:50,zIndex:1e3},children:(0,e.jsx)(pt.Z,{type:"primary",onClick:R,children:"Save"})})]})},Ir=gr,hr=function(t){var r=t.deployment_scenario_id,o=t.sync,n=t.setSync,a=(0,m.useState)({}),u=(0,S.Z)(a,2),g=u[0],A=u[1],Y=(0,m.useState)([]),W=(0,S.Z)(Y,2),R=W[0],H=W[1],L=(0,m.useState)([]),V=(0,S.Z)(L,2),O=V[0],N=V[1],z=[{title:"Asset name",width:"40%",dataIndex:"name"},{title:"Type",width:"15%",dataIndex:"part",render:function(J){return(0,Me.JS)(J)}},{title:"Vendor",width:"10%",dataIndex:"vendor"},{title:"Product",width:"10%",dataIndex:"product"},{title:"Version",width:"10%",dataIndex:"version"},{title:"Number CVEs",width:"15%",dataIndex:"number_cves",render:function(J,x){var K;return(K=g[x.id])===null||K===void 0?void 0:K.length}}];return(0,m.useEffect)(function(){var _=function(){var J=(0,I.Z)(p().mark(function x(){var K;return p().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,ir(r,{pageSize:Ne.n1});case 2:K=w.sent,N(K.data.assets),A(K.data.active);case 5:case"end":return w.stop()}},x)}));return function(){return J.apply(this,arguments)}}();_()},[]),(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(Gt.Z,{columns:z,dataSource:O,rowKey:"id",expandable:{expandedRowRender:function(J){return(0,e.jsx)(Ir,{asset_id:J.id,deployment_scenario_id:r,activeCVEs:g,setActiveCVEs:A,sync:o,setSync:n})},expandedRowKeys:R,onExpand:function(J,x){H(J?[x.id]:[])}},dateFormatter:"string",options:!1})})},vr=hr,fr=s(7085),ce=s(98822),Cr=s(91321),Ar=(0,Cr.Z)({scriptUrl:"https://at.alicdn.com/t/font_1101588_01zniftxm9yp.js"}),Rt=Ar,yr=s(84994),Nt=s.n(yr),_r=function(t){return t.toLowerCase().replace(/( |^)[a-z]/g,function(r){return r.toUpperCase()})},Zr=function(t){var r=t.command,o=t.icon,n=t.text;return(0,e.jsx)(ce.mY,{name:r,children:(0,e.jsxs)("div",{className:Nt().item,children:[(0,e.jsx)(Rt,{type:"icon-".concat(o||r)}),(0,e.jsx)("span",{children:n||_r(r)})]})})},Se=Zr,br=function(){return(0,e.jsxs)(ce.xV,{className:Nt().contextMenu,children:[(0,e.jsxs)(ce.Fn,{children:[(0,e.jsx)(Se,{command:"copy"}),(0,e.jsx)(Se,{command:"delete"})]}),(0,e.jsx)(ce.ff,{children:(0,e.jsx)(Se,{command:"delete"})}),(0,e.jsxs)(ce.Cc,{children:[(0,e.jsx)(Se,{command:"copy"}),(0,e.jsx)(Se,{command:"delete"}),(0,e.jsx)(Se,{command:"unGroup",icon:"ungroup",text:"Ungroup"})]}),(0,e.jsxs)(ce.eA,{children:[(0,e.jsx)(Se,{command:"copy"}),(0,e.jsx)(Se,{command:"paste"}),(0,e.jsx)(Se,{command:"addGroup",icon:"group",text:"Add Group"}),(0,e.jsx)(Se,{command:"delete"})]}),(0,e.jsxs)(ce.Tr,{children:[(0,e.jsx)(Se,{command:"undo"}),(0,e.jsx)(Se,{command:"redo"}),(0,e.jsx)(Se,{command:"pasteHere",icon:"paste",text:"Paste Here"})]})]})},Sr=br,Wt=s(69610),Vt=s(54941),Ot=s(81306),Lt=s(19809),wn=s(87445),jr=Mt.Z.Paragraph,zt=function(t){return t.toLowerCase().replace(/( |^)[a-z]/g,function(r){return r.toUpperCase()})},nt=Oe.Z.Item,Tn=Ze.Z.Option,Gn={labelCol:{sm:{span:8}},wrapperCol:{sm:{span:16}}},xr=function(i){(0,Ot.Z)(r,i);var t=(0,Lt.Z)(r);function r(o){var n;return(0,Wt.Z)(this,r),n=t.call(this,o),n.getAssets=function(a){var u=n.props.cves.find(function(g){return g.asset_id==a});return u?u.asset_name:""},n.getDescription=function(a,u){var g,A=n.props.cves.find(function(W){return W.asset_id==a}),Y=A==null||(g=A.cves)===null||g===void 0?void 0:g.find(function(W){return W.cve_id===u});return Y?Y.description:""},n.handleFieldChange=function(a){var u=n.props.propsAPI,g=u.getSelected,A=u.executeCommand,Y=u.update;setTimeout(function(){var W=g()[0];!W||A(function(){Y(W,(0,d.Z)({},a))})},0)},n.handleInputBlur=function(a){return function(u){u.preventDefault(),n.handleFieldChange((0,Dt.Z)({},a,u.currentTarget.value))}},n.handleInputChange=function(a){var u=a.split("_"),g=u[1],A=u[0];n.handleFieldChange({label:g,cve_id:g,asset_id:A}),n.setState((0,d.Z)((0,d.Z)({},n.state),{},{assets:n.getAssets(A),description:n.getDescription(A,g)})),n.handleFieldChange({label:g,cve_id:g,asset_id:A})},n.handleAttackerInputChange=function(a){var u,g=a;n.handleFieldChange({label:(u=n.props.attackers.find(function(A){return A.id===g}))===null||u===void 0?void 0:u.name,attacker_id:g})},n.componentDidMount=function(){var a=n.item?n.item.getModel():"",u=a.label,g=a.is_attacker,A=a.cve_id,Y=a.asset_id;g||n.setState((0,d.Z)((0,d.Z)({},n.state),{},{assets:n.getAssets(Y),description:n.getDescription(Y,A)}))},n.renderNodeDetail=function(){var a=n.item.getModel(),u=a.label,g=a.is_attacker,A=a.cve_id,Y=a.asset_id,W=a.attacker_id;return g?(0,e.jsx)(Oe.Z,{initialValues:{label:W||"Select threat"},layout:"vertical",children:(0,e.jsx)(nt,{label:(0,e.jsx)("b",{children:"Threat"}),name:"label",children:(0,e.jsx)(Ze.Z,{showSearch:!0,placeholder:"CVE",optionFilterProp:"children",onChange:n.handleAttackerInputChange,name:"label",children:n.props.attackers.map(function(R){return(0,e.jsx)(Ze.Z.Option,{value:"".concat(R.id),children:R.name},"".concat(R.id))})})})}):(0,e.jsxs)(Oe.Z,{initialValues:{label:Y?"".concat(Y,"_").concat(A):"Select CVE"},layout:"vertical",children:[(0,e.jsx)(nt,{label:(0,e.jsx)("b",{children:"CVE"}),name:"label",children:(0,e.jsx)(Ze.Z,{showSearch:!0,placeholder:"CVE",optionFilterProp:"children",onChange:n.handleInputChange,name:"label",children:n.props.cves.map(function(R){return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(Ze.Z.OptGroup,{label:"".concat(R.asset_name),children:R.cves.map(function(H){return(0,e.jsx)(Ze.Z.Option,{value:"".concat(R.asset_id,"_").concat(H.cve_id),children:H.cve_id},"".concat(R.asset_id,"_").concat(H.cve_id))})},"".concat(R.asset_id))})})})}),(0,e.jsx)(nt,{label:(0,e.jsx)("b",{children:"Asset"}),children:n.state.assets}),(0,e.jsx)(nt,{label:(0,e.jsx)("b",{children:"Description"}),children:(0,e.jsx)(jr,{ellipsis:{tooltip:n.state.description,rows:5},children:n.state.description})})]})},n.state={assets:"",description:""},n}return(0,Vt.Z)(r,[{key:"item",get:function(){var n=this.props.propsAPI;return n==null?void 0:n.getSelected()[0]}},{key:"render",value:function(){var n=this.props.type;return this.item?zt(n)==="edge"?(this.saveModel(),null):(0,e.jsx)(B.Z,{type:"inner",size:"small",title:zt(n),bordered:!1,children:n==="node"&&this.renderNodeDetail()}):null}}]),r}(m.Component),wr=(0,ce.Yn)(xr),Tr=s(4337),Gr=s.n(Tr),Pr=function(t){var r=t.cves,o=t.setDataGraph,n=t.attackers;return(0,e.jsx)(ce.JF,{className:Gr().detailPanel,children:(0,e.jsx)(ce.Kk,{children:(0,e.jsx)(wr,{type:"node",cves:r,setDataGraph:o,attackers:n})})})},Dr=Pr,kr=s(59596),Mr=s.n(kr),Er=function(){return(0,e.jsx)(ce.qZ,{className:Mr().itemPanel,children:(0,e.jsxs)(B.Z,{bordered:!1,children:[(0,e.jsx)(ce.ck,{type:"node",size:"72*72",shape:"flow-circle",model:{color:"#FA8C16",label:"Threat",is_attacker:!0},src:"data:image/svg+xml;base64,data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjxzdmcKICAgd2lkdGg9IjgwIgogICBoZWlnaHQ9IjgwIgogICB2ZXJzaW9uPSIxLjEiCiAgIGlkPSJzdmcyOCIKICAgc29kaXBvZGk6ZG9jbmFtZT0iYXR0YWNrLnN2ZyIKICAgaW5rc2NhcGU6dmVyc2lvbj0iMS4xLjIgKDE6MS4xKzIwMjIwMjA1MDk1MCswYTAwY2Y1MzM5KSIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiCiAgIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIKICAgeG1sbnM6c3ZnPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CiAgPHNvZGlwb2RpOm5hbWVkdmlldwogICAgIGlkPSJuYW1lZHZpZXczMCIKICAgICBwYWdlY29sb3I9IiNmZmZmZmYiCiAgICAgYm9yZGVyY29sb3I9IiM2NjY2NjYiCiAgICAgYm9yZGVyb3BhY2l0eT0iMS4wIgogICAgIGlua3NjYXBlOnBhZ2VzaGFkb3c9IjIiCiAgICAgaW5rc2NhcGU6cGFnZW9wYWNpdHk9IjAuMCIKICAgICBpbmtzY2FwZTpwYWdlY2hlY2tlcmJvYXJkPSIwIgogICAgIHNob3dncmlkPSJmYWxzZSIKICAgICBpbmtzY2FwZTp6b29tPSI2LjM4NzUiCiAgICAgaW5rc2NhcGU6Y3g9IjU0LjI0NjU3NSIKICAgICBpbmtzY2FwZTpjeT0iNDYuNjUzNjIiCiAgICAgaW5rc2NhcGU6d2luZG93LXdpZHRoPSIxMzEwIgogICAgIGlua3NjYXBlOndpbmRvdy1oZWlnaHQ9IjcwNCIKICAgICBpbmtzY2FwZTp3aW5kb3cteD0iNTYiCiAgICAgaW5rc2NhcGU6d2luZG93LXk9IjI3IgogICAgIGlua3NjYXBlOndpbmRvdy1tYXhpbWl6ZWQ9IjEiCiAgICAgaW5rc2NhcGU6Y3VycmVudC1sYXllcj0iZzI2IiAvPgogIDxkZWZzCiAgICAgaWQ9ImRlZnMxMiI+CiAgICA8Y2lyY2xlCiAgICAgICBpZD0iYiIKICAgICAgIGN4PSIzNiIKICAgICAgIGN5PSIzNiIKICAgICAgIHI9IjM2IiAvPgogICAgPGZpbHRlcgogICAgICAgeD0iLTAuMDY2NjY2NjY3IgogICAgICAgeT0iLTAuMDY2NjY2NjY3IgogICAgICAgd2lkdGg9IjEuMTMzMzMzMyIKICAgICAgIGhlaWdodD0iMS4xNjExMTExIgogICAgICAgZmlsdGVyVW5pdHM9Im9iamVjdEJvdW5kaW5nQm94IgogICAgICAgaWQ9ImEiPgogICAgICA8ZmVPZmZzZXQKICAgICAgICAgZHk9IjIiCiAgICAgICAgIGluPSJTb3VyY2VBbHBoYSIKICAgICAgICAgcmVzdWx0PSJzaGFkb3dPZmZzZXRPdXRlcjEiCiAgICAgICAgIGlkPSJmZU9mZnNldDMiIC8+CiAgICAgIDxmZUdhdXNzaWFuQmx1cgogICAgICAgICBzdGREZXZpYXRpb249IjIiCiAgICAgICAgIGluPSJzaGFkb3dPZmZzZXRPdXRlcjEiCiAgICAgICAgIHJlc3VsdD0ic2hhZG93Qmx1ck91dGVyMSIKICAgICAgICAgaWQ9ImZlR2F1c3NpYW5CbHVyNSIgLz4KICAgICAgPGZlQ29tcG9zaXRlCiAgICAgICAgIGluPSJzaGFkb3dCbHVyT3V0ZXIxIgogICAgICAgICBpbjI9IlNvdXJjZUFscGhhIgogICAgICAgICBvcGVyYXRvcj0ib3V0IgogICAgICAgICByZXN1bHQ9InNoYWRvd0JsdXJPdXRlcjEiCiAgICAgICAgIGlkPSJmZUNvbXBvc2l0ZTciIC8+CiAgICAgIDxmZUNvbG9yTWF0cml4CiAgICAgICAgIHZhbHVlcz0iMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMC4wNCAwIgogICAgICAgICBpbj0ic2hhZG93Qmx1ck91dGVyMSIKICAgICAgICAgaWQ9ImZlQ29sb3JNYXRyaXg5IiAvPgogICAgPC9maWx0ZXI+CiAgPC9kZWZzPgogIDxnCiAgICAgZmlsbD0ibm9uZSIKICAgICBmaWxsLXJ1bGU9ImV2ZW5vZGQiCiAgICAgaWQ9ImcyNiI+CiAgICA8ZwogICAgICAgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNCAyKSIKICAgICAgIGlkPSJnMjAiPgogICAgICA8dXNlCiAgICAgICAgIGZpbGw9IiMwMDAiCiAgICAgICAgIGZpbHRlcj0idXJsKCNhKSIKICAgICAgICAgeGxpbms6aHJlZj0iI2IiCiAgICAgICAgIGlkPSJ1c2UxNCIgLz4KICAgICAgPHVzZQogICAgICAgICBmaWxsLW9wYWNpdHk9Ii45MiIKICAgICAgICAgZmlsbD0iI0ZGRjJFOCIKICAgICAgICAgeGxpbms6aHJlZj0iI2IiCiAgICAgICAgIGlkPSJ1c2UxNiIgLz4KICAgICAgPGNpcmNsZQogICAgICAgICBzdHJva2U9IiNGRkMwNjkiCiAgICAgICAgIGN4PSIzNiIKICAgICAgICAgY3k9IjM2IgogICAgICAgICByPSIzNS41IgogICAgICAgICBpZD0iY2lyY2xlMTgiIC8+CiAgICA8L2c+CiAgICA8dGV4dAogICAgICAgZm9udC1mYW1pbHk9IlBpbmdGYW5nU0MtUmVndWxhciwgJ1BpbmdGYW5nIFNDJyIKICAgICAgIGZvbnQtc2l6ZT0iMTJweCIKICAgICAgIGZpbGw9IiMwMDAwMDAiCiAgICAgICBmaWxsLW9wYWNpdHk9IjAuNjUiCiAgICAgICBpZD0idGV4dDI0IgogICAgICAgeD0iLTIuMjc5MTYyOSIKICAgICAgIHk9IjIuOTk4MTI5MSI+PHRzcGFuCiAgICAgICAgIHg9IjIwLjcyMDgzOSIKICAgICAgICAgeT0iNDMuOTk4MTMxIgogICAgICAgICBpZD0idHNwYW4yMiI+VGhyZWF0PC90c3Bhbj48L3RleHQ+CiAgPC9nPgo8L3N2Zz4K"}),(0,e.jsx)(ce.ck,{type:"node",size:"100*48",shape:"flow-capsule",model:{color:"#722ED1",label:"CVE",is_attacker:!1},src:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjxzdmcKICAgd2lkdGg9Ijg4IgogICBoZWlnaHQ9IjU2IgogICB2ZXJzaW9uPSIxLjEiCiAgIGlkPSJzdmcyOCIKICAgc29kaXBvZGk6ZG9jbmFtZT0iY3ZlLnN2ZyIKICAgaW5rc2NhcGU6dmVyc2lvbj0iMS4xLjIgKDE6MS4xKzIwMjIwMjA1MDk1MCswYTAwY2Y1MzM5KSIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiCiAgIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIKICAgeG1sbnM6c3ZnPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CiAgPHNvZGlwb2RpOm5hbWVkdmlldwogICAgIGlkPSJuYW1lZHZpZXczMCIKICAgICBwYWdlY29sb3I9IiNmZmZmZmYiCiAgICAgYm9yZGVyY29sb3I9IiM2NjY2NjYiCiAgICAgYm9yZGVyb3BhY2l0eT0iMS4wIgogICAgIGlua3NjYXBlOnBhZ2VzaGFkb3c9IjIiCiAgICAgaW5rc2NhcGU6cGFnZW9wYWNpdHk9IjAuMCIKICAgICBpbmtzY2FwZTpwYWdlY2hlY2tlcmJvYXJkPSIwIgogICAgIHNob3dncmlkPSJmYWxzZSIKICAgICBpbmtzY2FwZTp6b29tPSI5LjEyNSIKICAgICBpbmtzY2FwZTpjeD0iNjUuNjk4NjMiCiAgICAgaW5rc2NhcGU6Y3k9IjI4LjA1NDc5NSIKICAgICBpbmtzY2FwZTp3aW5kb3ctd2lkdGg9IjEzMTAiCiAgICAgaW5rc2NhcGU6d2luZG93LWhlaWdodD0iNzA0IgogICAgIGlua3NjYXBlOndpbmRvdy14PSI1NiIKICAgICBpbmtzY2FwZTp3aW5kb3cteT0iMjciCiAgICAgaW5rc2NhcGU6d2luZG93LW1heGltaXplZD0iMSIKICAgICBpbmtzY2FwZTpjdXJyZW50LWxheWVyPSJnMjYiIC8+CiAgPGRlZnMKICAgICBpZD0iZGVmczEyIj4KICAgIDxyZWN0CiAgICAgICBpZD0iYiIKICAgICAgIHg9IjAiCiAgICAgICB5PSIwIgogICAgICAgd2lkdGg9IjgwIgogICAgICAgaGVpZ2h0PSI0OCIKICAgICAgIHJ4PSIyNCIgLz4KICAgIDxmaWx0ZXIKICAgICAgIHg9Ii0wLjA2IgogICAgICAgeT0iLTAuMSIKICAgICAgIHdpZHRoPSIxLjEyIgogICAgICAgaGVpZ2h0PSIxLjI0MTY2NjciCiAgICAgICBmaWx0ZXJVbml0cz0ib2JqZWN0Qm91bmRpbmdCb3giCiAgICAgICBpZD0iYSI+CiAgICAgIDxmZU9mZnNldAogICAgICAgICBkeT0iMiIKICAgICAgICAgaW49IlNvdXJjZUFscGhhIgogICAgICAgICByZXN1bHQ9InNoYWRvd09mZnNldE91dGVyMSIKICAgICAgICAgaWQ9ImZlT2Zmc2V0MyIgLz4KICAgICAgPGZlR2F1c3NpYW5CbHVyCiAgICAgICAgIHN0ZERldmlhdGlvbj0iMiIKICAgICAgICAgaW49InNoYWRvd09mZnNldE91dGVyMSIKICAgICAgICAgcmVzdWx0PSJzaGFkb3dCbHVyT3V0ZXIxIgogICAgICAgICBpZD0iZmVHYXVzc2lhbkJsdXI1IiAvPgogICAgICA8ZmVDb21wb3NpdGUKICAgICAgICAgaW49InNoYWRvd0JsdXJPdXRlcjEiCiAgICAgICAgIGluMj0iU291cmNlQWxwaGEiCiAgICAgICAgIG9wZXJhdG9yPSJvdXQiCiAgICAgICAgIHJlc3VsdD0ic2hhZG93Qmx1ck91dGVyMSIKICAgICAgICAgaWQ9ImZlQ29tcG9zaXRlNyIgLz4KICAgICAgPGZlQ29sb3JNYXRyaXgKICAgICAgICAgdmFsdWVzPSIwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwLjA0IDAiCiAgICAgICAgIGluPSJzaGFkb3dCbHVyT3V0ZXIxIgogICAgICAgICBpZD0iZmVDb2xvck1hdHJpeDkiIC8+CiAgICA8L2ZpbHRlcj4KICA8L2RlZnM+CiAgPGcKICAgICBmaWxsPSJub25lIgogICAgIGZpbGwtcnVsZT0iZXZlbm9kZCIKICAgICBpZD0iZzI2Ij4KICAgIDxnCiAgICAgICB0cmFuc2Zvcm09InRyYW5zbGF0ZSg0IDIpIgogICAgICAgaWQ9ImcyMCI+CiAgICAgIDx1c2UKICAgICAgICAgZmlsbD0iIzAwMCIKICAgICAgICAgZmlsdGVyPSJ1cmwoI2EpIgogICAgICAgICB4bGluazpocmVmPSIjYiIKICAgICAgICAgaWQ9InVzZTE0IiAvPgogICAgICA8dXNlCiAgICAgICAgIGZpbGwtb3BhY2l0eT0iLjkyIgogICAgICAgICBmaWxsPSIjRjlGMEZGIgogICAgICAgICB4bGluazpocmVmPSIjYiIKICAgICAgICAgaWQ9InVzZTE2IiAvPgogICAgICA8cmVjdAogICAgICAgICBzdHJva2U9IiNCMzdGRUIiCiAgICAgICAgIHg9Ii41IgogICAgICAgICB5PSIuNSIKICAgICAgICAgd2lkdGg9Ijc5IgogICAgICAgICBoZWlnaHQ9IjQ3IgogICAgICAgICByeD0iMjMuNSIKICAgICAgICAgaWQ9InJlY3QxOCIgLz4KICAgIDwvZz4KICAgIDx0ZXh0CiAgICAgICBmb250LWZhbWlseT0iUGluZ0ZhbmdTQy1SZWd1bGFyLCAnUGluZ0ZhbmcgU0MnIgogICAgICAgZm9udC1zaXplPSIxMnB4IgogICAgICAgZmlsbD0iIzAwMDAwMCIKICAgICAgIGZpbGwtb3BhY2l0eT0iMC42NSIKICAgICAgIGlkPSJ0ZXh0MjQiCiAgICAgICB4PSI3LjUxNDIzMDMiCiAgICAgICB5PSIwLjg5NzU2Nzk5Ij48dHNwYW4KICAgICAgICAgeD0iMzEuNTE0MjMxIgogICAgICAgICB5PSIyOS44OTc1NjgiCiAgICAgICAgIGlkPSJ0c3BhbjIyIj5DVkU8L3RzcGFuPjwvdGV4dD4KICA8L2c+Cjwvc3ZnPgo="})]})})},Rr=Er,Pn=function(){return _jsx(_Card,{type:"inner",size:"small",title:"Minimap",bordered:!1,children:_jsx(Minimap,{height:200})})},Dn=null,Nr=s(5708),Bt=s.n(Nr),kn=s(22385),Wr=s(61580),Vr=function(t){return t.toLowerCase().replace(/( |^)[a-z]/g,function(r){return r.toUpperCase()})},Or=function(t){var r=t.command,o=t.icon,n=t.text;return(0,e.jsx)(ce.mY,{name:r,children:(0,e.jsx)(Wr.Z,{title:n||Vr(r),placement:"bottom",overlayClassName:Bt().tooltip,children:(0,e.jsx)(Rt,{type:"icon-".concat(o||r)})})})},We=Or,Lr=function(){return(0,e.jsxs)(ce.o8,{className:Bt().toolbar,children:[(0,e.jsx)(We,{command:"undo"}),(0,e.jsx)(We,{command:"redo"}),(0,e.jsx)(ze.Z,{type:"vertical"}),(0,e.jsx)(We,{command:"copy"}),(0,e.jsx)(We,{command:"paste"}),(0,e.jsx)(We,{command:"delete"}),(0,e.jsx)(ze.Z,{type:"vertical"}),(0,e.jsx)(We,{command:"zoomIn",icon:"zoom-in",text:"Zoom In"}),(0,e.jsx)(We,{command:"zoomOut",icon:"zoom-out",text:"Zoom Out"}),(0,e.jsx)(We,{command:"autoZoom",icon:"fit-map",text:"Fit Map"}),(0,e.jsx)(We,{command:"resetZoom",icon:"actual-size",text:"Actual Size"}),(0,e.jsx)(ze.Z,{type:"vertical"})]})},zr=Lr,Br=function(i){(0,Ot.Z)(r,i);var t=(0,Lt.Z)(r);function r(o){return(0,Wt.Z)(this,r),t.call(this,o)}return(0,Vt.Z)(r,[{key:"componentDidUpdate",value:function(){this.props.propsAPI.executeCommand("autoZoom")}},{key:"componentDidMount",value:function(){this.props.propsAPI.executeCommand("autoZoom")}},{key:"render",value:function(){var n=this;return(0,e.jsx)(ce.Zw,{className:this.props.className,data:this.props.data,onAfterChange:function(){localStorage.setItem(Ne.QG,JSON.stringify(n.props.propsAPI.save()))}})}}]),r}(m.Component),Fr=(0,ce.Yn)(Br),Yr=s(3600),Le=s.n(Yr);function Kr(i,t,r){return jt.apply(this,arguments)}function jt(){return jt=(0,I.Z)(p().mark(function i(t,r,o){return p().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,j.ZP)("/api/deployment_scenarios/".concat(t,"/attack_graph"),(0,d.Z)({method:"POST",headers:{"Content-Type":"application/json"},data:r},o||{})));case 1:case"end":return a.stop()}},i)})),jt.apply(this,arguments)}ce.ZP.setTrackable(!1);var Ur=function(t){var r=t.deployment_scenario_id,o=t.sync,n=t.setSync,a=(0,m.useState)(!1),u=(0,S.Z)(a,2),g=u[0],A=u[1],Y=(0,m.useState)(""),W=(0,S.Z)(Y,2),R=W[0],H=W[1],L=(0,m.useState)({nodes:[],edges:[]}),V=(0,S.Z)(L,2),O=V[0],N=V[1],z=(0,m.useState)([]),_=(0,S.Z)(z,2),J=_[0],x=_[1],K=(0,m.useState)([]),P=(0,S.Z)(K,2),w=P[0],f=P[1];(0,m.useEffect)(function(){var X=function(){var ie=(0,I.Z)(p().mark(function ae(){var oe,ge,ve;return p().wrap(function(Ee){for(;;)switch(Ee.prev=Ee.next){case 0:return A(!0),Ee.next=3,or(r);case 3:return oe=Ee.sent,Ee.next=6,(0,tt.v$)(r);case 6:ge=Ee.sent,ge&&(ve=ge.data.target,H("".concat(ve.asset_id,"_").concat(ve.cve_id))),oe&&(N(oe.attack_graph),x(oe.cves),f(oe.attackers),localStorage.setItem(Ne.QG,JSON.stringify(oe.attack_graph))),A(!1);case 10:case"end":return Ee.stop()}},ae)}));return function(){return ie.apply(this,arguments)}}();X()},[r]);var ne=function(){var X=(0,I.Z)(p().mark(function ie(){var ae,oe,ge,ve,Ae;return p().wrap(function(Te){for(;;)switch(Te.prev=Te.next){case 0:if(oe=JSON.parse(localStorage.getItem(Ne.QG)),N(oe),ge={asset_id:R.split("_")[0],cve_id:R.split("_")[1]},ve=!1,oe==null||(ae=oe.nodes)===null||ae===void 0||ae.forEach(function(at){at.cve_id==ge.cve_id&&at.asset_id==ge.asset_id&&(ve=!0)}),!ve){Te.next=12;break}return Te.next=8,Kr(r,{attack_graph:oe,target:ge});case 8:Ae=Te.sent,Ae&&(Be.default.success("Save done!"),n(!o)),Te.next=13;break;case 12:Be.default.error("Please select target is CVE in attack graph!");case 13:case"end":return Te.stop()}},ie)}));return function(){return X.apply(this,arguments)}}(),me=function(ie){H(ie)};return g?(0,e.jsx)(fr.Z,{style:{fontSize:25}}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(Ve.Z,{style:{marginBottom:15},children:[(0,e.jsx)(xe.Z,{span:2,children:"Target"}),(0,e.jsx)(xe.Z,{span:22,children:(0,e.jsx)(Ze.Z,{style:{minWidth:"400"},value:R,onChange:me,showSearch:!0,children:J.map(function(X){return(0,e.jsx)(Ze.Z.OptGroup,{label:X.asset_name,children:X.cves.map(function(ie){return(0,e.jsx)(Ze.Z.Option,{value:"".concat(X.asset_id,"_").concat(ie.cve_id),children:"".concat(ie.cve_id," on ").concat(X.asset_name)},"".concat(X.asset_id,"_").concat(ie.cve_id))})},X.asset_name)})})})]}),(0,e.jsxs)(ce.ZP,{className:Le().editor,children:[(0,e.jsx)(Ve.Z,{className:Le().editorHd,children:(0,e.jsx)(xe.Z,{span:24,children:(0,e.jsx)(zr,{})})}),(0,e.jsxs)(Ve.Z,{className:Le().editorBd,children:[(0,e.jsx)(xe.Z,{span:3,className:Le().editorSidebar,children:(0,e.jsx)(Rr,{})}),(0,e.jsx)(xe.Z,{span:16,className:Le().editorContent,children:(0,e.jsx)(Fr,{className:Le().flow,data:O})}),(0,e.jsx)(xe.Z,{span:5,className:Le().editorSidebar,children:(0,e.jsx)(Dr,{cves:J,setDataGraph:N,attackers:w})})]}),(0,e.jsx)(Sr,{})]}),(0,e.jsx)(Pt.Z,{style:{position:"fixed",right:50,bottom:50,zIndex:1e3},children:(0,e.jsx)(pt.Z,{type:"primary",onClick:ne,children:"Save"})})]})},$r=Ur,Ft=s(64317),Hr=function(t){var r=t.deployment_scenario_id,o=(0,m.useState)([]),n=(0,S.Z)(o,2),a=n[0],u=n[1],g=(0,m.useState)([]),A=(0,S.Z)(g,2),Y=A[0],W=A[1],R=(0,m.useState)(0),H=(0,S.Z)(R,2),L=H[0],V=H[1],O=(0,m.useState)(Ne.TT),N=(0,S.Z)(O,2),z=N[0],_=N[1],J=(0,m.useState)(!1),x=(0,S.Z)(J,2),K=x[0],P=x[1];(0,m.useEffect)(function(){var f=function(){var ne=(0,I.Z)(p().mark(function me(){var X,ie,ae;return p().wrap(function(ge){for(;;)switch(ge.prev=ge.next){case 0:return ge.next=2,(0,tt.s9)(r);case 2:X=ge.sent,X&&(u(X==null||(ie=X.data)===null||ie===void 0?void 0:ie.cves),W(X==null||(ae=X.data)===null||ae===void 0?void 0:ae.assets));case 4:case"end":return ge.stop()}},me)}));return function(){return ne.apply(this,arguments)}}();f()},[]);var w=function(){var f=(0,I.Z)(p().mark(function ne(me){var X,ie,ae,oe;return p().wrap(function(ve){for(;;)switch(ve.prev=ve.next){case 0:return X=me.observer_prob,ie=me.cve,ve.next=3,Kt(r,{cve_id:ie.split("_")[0],asset_id:ie.split("_")[1],observer_probability:X});case 3:ae=ve.sent,ae&&(ae==null||(oe=ae.data)===null||oe===void 0?void 0:oe.est)>=.1&&(V(ae.data.est),_(ae.data.threat_types),P(!0));case 5:case"end":return ve.stop()}},ne)}));return function(me){return f.apply(this,arguments)}}();return(0,e.jsxs)(Ve.Z,{gutter:16,children:[(0,e.jsx)(xe.Z,{span:12,children:(0,e.jsxs)(ct.ZP,{onFinish:w,onChange:function(){return P(!1)},children:[(0,e.jsx)(Ft.Z,{name:"cve",label:"CVE",options:a.map(function(f){var ne;return{label:"".concat(f.cve_id," on ").concat((ne=Y.find(function(me){return me.id===f.asset_id}))===null||ne===void 0?void 0:ne.name),value:"".concat(f.cve_id,"_").concat(f.asset_id)}}),placeholder:"Please select a cve",rules:[{required:!0}],width:"md"}),(0,e.jsx)(dt.Z,{name:"observer_prob",label:"Observer probability",max:1,min:0,placeholder:"Please input observer probability",rules:[{required:!0}],width:"md"})]})}),(0,e.jsx)(xe.Z,{span:12,children:K?(0,e.jsxs)(ct.ZP,{initialValues:{est_probability:L},children:[(0,e.jsx)(dt.Z,{name:"est_probability",label:"Estimate probability",max:1,min:0,rules:[{required:!0}],width:"md",disabled:!0}),(0,e.jsx)(Ft.Z,{name:"threat_type",label:"Threat type",options:Ne.TT.map(function(f){return{label:z.includes(f)?"\u{1F44D} ".concat(f):"  ".concat(f),value:"".concat(f)}}),placeholder:"Please select a threat type",rules:[{required:!0}],width:"md"})]}):(0,e.jsx)("b",{children:"No threat detected"})})]})},Jr=Hr,$e=De.Z.TabPane,Xr=function(t){var r,o=t==null||(r=t.match)===null||r===void 0?void 0:r.params,n=o.id,a=(0,m.useState)({}),u=(0,S.Z)(a,2),g=u[0],A=u[1],Y=(0,m.useState)({}),W=(0,S.Z)(Y,2),R=W[0],H=W[1],L=(0,m.useState)(!0),V=(0,S.Z)(L,2),O=V[0],N=V[1],z=function(){var _=(0,I.Z)(p().mark(function J(){var x,K;return p().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,(0,tt.v$)(n);case 2:if(x=w.sent,A(x.data),!(x!=null&&x.data)){w.next=9;break}return w.next=7,(0,xt.Cv)(x.data.system_profile_id);case 7:K=w.sent,H(K.data);case 9:case"end":return w.stop()}},J)}));return function(){return _.apply(this,arguments)}}();return(0,m.useEffect)(function(){z()},[]),(0,e.jsx)(se.ZP,{header:{title:"Risk monitoring"},content:(0,e.jsxs)(h.Z,{column:2,style:{marginBottom:-16},children:[(0,e.jsx)(h.Z.Item,{label:"System profile",children:(0,e.jsx)("a",{onClick:function(){},children:R.name})}),(0,e.jsx)(h.Z.Item,{label:"Deployment scenario",children:(0,e.jsx)("a",{onClick:function(){},children:g.name})})]}),children:(0,e.jsx)(B.Z,{children:(0,e.jsxs)(De.Z,{defaultActiveKey:"1",destroyInactiveTabPane:!0,children:[(0,e.jsx)($e,{tab:(0,e.jsxs)("span",{children:[(0,e.jsx)(er.Z,{}),"Monitoring"]}),children:(0,e.jsx)(qt,{deployment_scenario_id:n,sync:O,setSync:N})},"1"),(0,e.jsx)($e,{tab:(0,e.jsxs)("span",{children:[(0,e.jsx)(wt.Z,{}),"Update CVE"]}),children:(0,e.jsx)(vr,{deployment_scenario_id:n,sync:O,setSync:N})},"2"),(0,e.jsx)($e,{tab:(0,e.jsxs)("span",{children:[(0,e.jsx)(wt.Z,{}),"Update attack graph"]}),children:(0,e.jsx)($r,{deployment_scenario_id:n,sync:O,setSync:N})},"4"),(0,e.jsx)($e,{tab:(0,e.jsxs)("span",{children:[(0,e.jsx)(Tt.Z,{}),"Scan vulnerability"]}),children:(0,e.jsx)(sr,{deployment_scenario_id:n,sync:O,setSync:N})},"3"),(0,e.jsx)($e,{tab:(0,e.jsxs)("span",{children:[(0,e.jsx)(Tt.Z,{}),"Detect threat"]}),children:(0,e.jsx)(Jr,{deployment_scenario_id:n})},"5")]})})})},Qr=Xr},5341:function(fe,je,s){"use strict";s.d(je,{d8:function(){return p},T3:function(){return m}});var c=s(11849),B=s(3182),Pe=s(94043),h=s.n(Pe),I=s(64172);function S(j,re){return pe.apply(this,arguments)}function pe(){return pe=_asyncToGenerator(_regeneratorRuntime.mark(function j(re,k){return _regeneratorRuntime.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.abrupt("return",api("/api/system_profiles/deployment_scenarios",_objectSpread({method:"GET",params:_objectSpread({},re)},k||{})));case 1:case"end":return E.stop()}},j)})),pe.apply(this,arguments)}function De(j,re){return le.apply(this,arguments)}function le(){return le=_asyncToGenerator(_regeneratorRuntime.mark(function j(re,k){return _regeneratorRuntime.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.abrupt("return",api("/api/helper/generate_coordinates",_objectSpread({method:"POST",data:re},k||{})));case 1:case"end":return E.stop()}},j)})),le.apply(this,arguments)}function p(j,re,k){return se.apply(this,arguments)}function se(){return se=(0,B.Z)(h().mark(function j(re,k,F){return h().wrap(function(te){for(;;)switch(te.prev=te.next){case 0:return te.abrupt("return",(0,I.ZP)("/api/system_profiles/".concat(re,"/deployment_scenarios"),(0,c.Z)({method:"GET",params:(0,c.Z)({},k)},F||{})));case 1:case"end":return te.stop()}},j)})),se.apply(this,arguments)}function m(j,re,k){return d.apply(this,arguments)}function d(){return d=(0,B.Z)(h().mark(function j(re,k,F){return h().wrap(function(te){for(;;)switch(te.prev=te.next){case 0:return te.abrupt("return",(0,I.ZP)("/api/risk_monitoring/".concat(re,"/scan_vulnerability"),(0,c.Z)({method:"POST",data:k},F||{})));case 1:case"end":return te.stop()}},j)})),d.apply(this,arguments)}},70345:function(fe,je,s){"use strict";s.d(je,{aT:function(){return S},Cv:function(){return De},Kq:function(){return p},aI:function(){return m},Me:function(){return j}});var c=s(11849),B=s(3182),Pe=s(94043),h=s.n(Pe),I=s(64172);function S(k,F){return pe.apply(this,arguments)}function pe(){return pe=(0,B.Z)(h().mark(function k(F,E){return h().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.abrupt("return",(0,I.ZP)("/api/system_profiles",(0,c.Z)({method:"GET",params:(0,c.Z)({},F)},E||{})));case 1:case"end":return y.stop()}},k)})),pe.apply(this,arguments)}function De(k,F,E){return le.apply(this,arguments)}function le(){return le=(0,B.Z)(h().mark(function k(F,E,te){return h().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,I.ZP)("/api/system_profiles/".concat(F),(0,c.Z)({method:"GET",params:(0,c.Z)({},E)},te||{})));case 1:case"end":return l.stop()}},k)})),le.apply(this,arguments)}function p(k,F){return se.apply(this,arguments)}function se(){return se=(0,B.Z)(h().mark(function k(F,E){return h().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.abrupt("return",(0,I.ZP)("/api/system_profiles",(0,c.Z)({data:F,method:"POST"},E||{})));case 1:case"end":return y.stop()}},k)})),se.apply(this,arguments)}function m(k,F,E){return d.apply(this,arguments)}function d(){return d=(0,B.Z)(h().mark(function k(F,E,te){return h().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",(0,I.ZP)("/api/system_profiles/".concat(F),(0,c.Z)({data:E,method:"PUT"},te||{})));case 1:case"end":return l.stop()}},k)})),d.apply(this,arguments)}function j(k,F){return re.apply(this,arguments)}function re(){return re=(0,B.Z)(h().mark(function k(F,E){return h().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.abrupt("return",(0,I.ZP)("/api/system_profiles/".concat(F),(0,c.Z)({method:"DELETE"},E||{})));case 1:case"end":return y.stop()}},k)})),re.apply(this,arguments)}},44743:function(fe,je,s){"use strict";s.d(je,{w7:function(){return B},JS:function(){return Pe},Zb:function(){return h},gu:function(){return I},$U:function(){return pe},O3:function(){return De},vh:function(){return le},rJ:function(){return p},zd:function(){return se},Ou:function(){return m},Vd:function(){return d},eX:function(){return j},jv:function(){return re},lf:function(){return k},xe:function(){return F},AC:function(){return E},Mc:function(){return te}});var c=s(32611),B=function(l){switch(l){case"OS":return"o";case"APPLICATION":return"a";case"HARDWARE":return"h";default:return}},Pe=function(l){switch(l){case"o":return"OS";case"a":return"APPLICATION";case"h":return"HARDWARE";default:return}},h=function(l){switch(l){case"HIGH":return 3;case"MEDIUM":return 2;case"LOW":return 1;default:return}},I=function(l){return l.substring(0,10)},S=function(l){return l.replace(/\w\S*/g,function(ke){return ke.charAt(0).toUpperCase()+ke.substr(1).toLowerCase()})},pe=function(l){return l>=9?["Critical",c.jv]:l>=7?["High",c.U1]:l>=4?["Medium",c.WY]:["Low",c.q6]},De=function(l){return l==="Critical"?c.jv:l==="High"?c.U1:l==="Medium"?c.WY:c.q6},le=function(l){return l<=1.8?["Negligible",1]:l<=3.6?["Low",2]:l<=5.4?["Moderate",3]:l<=7.2?["Significant",4]:["Catastrophic",5]},p=function(l){return l<=.2?["Improbable",1]:l<=.4?["Remote",2]:l<=.6?["Occsional",3]:l<=.8?["Probale",4]:["Frequent",5]},se=function(l,ke){var Re=l*ke;return Re>12?["Critical",c.jv,4]:Re>7?["High",c.U1,3]:Re>3?["Medium",c.WY,2]:["Low",c.q6,1]},m=function(l){return l===4?"Critical":l===3?"High":l===2?"Medium":l===1?"Low":""},d=function(l){return l===5?"Catastrophic":l===4?"Significant":l===3?"Moderate":l===2?"Low":l===1?"Negligible":""},j=function(l){return l===5?"Frequent":l===4?"Probale":l===3?"Occsional":l===2?"Remote":l===1?"Improbable":""},re=function(l){return Math.round(l*100)/100},k=function(l){return l<=.25?["Low",c.q6]:l<=.5?["Medium",c.WY]:l<=.75?["High",c.U1]:["Critical",c.jv]},F=function(l){return l==="Negligible"?c.Fe:l==="Low"?c.q6:l==="Moderate"?c.WY:l==="Significant"?c.U1:c.jv},E=function(l){return l==="Improbable"?c.Fe:l==="Low"?c.q6:l==="Occsional"?c.WY:l==="Significant"?c.U1:c.jv},te=function(l){return l==="None"?c.Fe:l==="Low"?c.q6:l==="Medium"?c.WY:l==="High"?c.U1:c.jv}}}]);
