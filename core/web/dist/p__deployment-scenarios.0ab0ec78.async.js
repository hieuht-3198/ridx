(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[914],{59465:function(Se,J,t){"use strict";t.d(J,{Z:function(){return B}});var T=t(28991),F=t(67294),q={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M696 480H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h368c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"minus-circle",theme:"outlined"},g=q,c=t(27029),V=function(U,ee){return F.createElement(c.Z,(0,T.Z)((0,T.Z)({},U),{},{ref:ee,icon:g}))};V.displayName="MinusCircleOutlined";var B=F.forwardRef(V)},5966:function(Se,J,t){"use strict";var T=t(22122),F=t(81253),q=t(67294),g=t(39178),c=["fieldProps","proFieldProps"],V=["fieldProps","proFieldProps"],B="text",ne=function(n){var u=n.fieldProps,Z=n.proFieldProps,r=(0,F.Z)(n,c);return q.createElement(g.Z,(0,T.Z)({mode:"edit",valueType:B,fieldProps:u,filedConfig:{valueType:B},proFieldProps:Z},r))},U=function(n){var u=n.fieldProps,Z=n.proFieldProps,r=(0,F.Z)(n,V);return q.createElement(g.Z,(0,T.Z)({mode:"edit",valueType:"password",fieldProps:u,proFieldProps:Z,filedConfig:{valueType:B}},r))},ee=ne;ee.Password=U,ee.displayName="ProFormComponent",J.Z=ee},90672:function(Se,J,t){"use strict";var T=t(22122),F=t(81253),q=t(67294),g=t(39178),c=["fieldProps","proFieldProps"],V=function(ne,U){var ee=ne.fieldProps,P=ne.proFieldProps,n=(0,F.Z)(ne,c);return q.createElement(g.Z,(0,T.Z)({ref:U,mode:"edit",valueType:"textarea",fieldProps:ee,proFieldProps:P},n))};J.Z=q.forwardRef(V)},14838:function(Se){Se.exports={editor:"editor___4LGt6",editorHd:"editorHd___2K3VC",editorBd:"editorBd___10da5",editorSidebar:"editorSidebar___zi7_9",editorContent:"editorContent___2Ztfq",flow:"flow___1xUdt",mind:"mind___EmMat",koni:"koni___3MSaw",steps_content:"steps_content___1YjAa"}},25185:function(Se,J,t){"use strict";t.d(J,{UN:function(){return ne},lu:function(){return U},G1:function(){return ee}});var T=t(22385),F=t(61580),q=t(95357),g=t(8212),c=t(73171),V=t(85893),B=function(n){var u=n.icon,Z=n.title,r=n.onClick;return(0,V.jsx)("a",{onClick:r,children:(0,V.jsx)(F.Z,{title:Z,children:u})})},ne=function(n){var u=n.title,Z=n.onClick;return(0,V.jsx)(B,{icon:(0,V.jsx)(q.Z,{}),title:u||"Detail",onClick:Z})},U=function(n){var u=n.title,Z=n.onClick;return(0,V.jsx)(B,{icon:(0,V.jsx)(g.Z,{}),title:u||"Edit",onClick:Z})},ee=function(n){var u=n.title,Z=n.onClick;return(0,V.jsx)(B,{icon:(0,V.jsx)(c.Z,{}),title:u||"Delete",onClick:Z})};J.ZP=B},76208:function(Se,J,t){"use strict";t.d(J,{Vh:function(){return V},kI:function(){return ne},dQ:function(){return ee},mo:function(){return n}});var T=t(11849),F=t(3182),q=t(94043),g=t.n(q),c=t(64172);function V(Z,r){return B.apply(this,arguments)}function B(){return B=(0,F.Z)(g().mark(function Z(r,k){return g().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(0,c.ZP)("/api/assets",(0,T.Z)({method:"GET",params:(0,T.Z)({},r)},k||{})));case 1:case"end":return s.stop()}},Z)})),B.apply(this,arguments)}function ne(Z,r){return U.apply(this,arguments)}function U(){return U=(0,F.Z)(g().mark(function Z(r,k){return g().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(0,c.ZP)("/api/assets",(0,T.Z)({data:r,method:"POST"},k||{})));case 1:case"end":return s.stop()}},Z)})),U.apply(this,arguments)}function ee(Z,r,k){return P.apply(this,arguments)}function P(){return P=(0,F.Z)(g().mark(function Z(r,k,_){return g().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(0,c.ZP)("/api/assets/".concat(r),(0,T.Z)({data:k,method:"PUT"},_||{})));case 1:case"end":return i.stop()}},Z)})),P.apply(this,arguments)}function n(Z,r){return u.apply(this,arguments)}function u(){return u=(0,F.Z)(g().mark(function Z(r,k){return g().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(0,c.ZP)("/api/assets/".concat(r),(0,T.Z)({method:"DELETE"},k||{})));case 1:case"end":return s.stop()}},Z)})),u.apply(this,arguments)}},40727:function(Se,J,t){"use strict";t.d(J,{Gl:function(){return V},qc:function(){return ne},g5:function(){return ee},ah:function(){return n}});var T=t(11849),F=t(3182),q=t(94043),g=t.n(q),c=t(64172);function V(Z,r){return B.apply(this,arguments)}function B(){return B=(0,F.Z)(g().mark(function Z(r,k){return g().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(0,c.ZP)("/api/countermeasures",(0,T.Z)({method:"GET",params:(0,T.Z)({},r)},k||{})));case 1:case"end":return s.stop()}},Z)})),B.apply(this,arguments)}function ne(Z,r){return U.apply(this,arguments)}function U(){return U=(0,F.Z)(g().mark(function Z(r,k){return g().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(0,c.ZP)("/api/countermeasures",(0,T.Z)({data:r,method:"POST"},k||{})));case 1:case"end":return s.stop()}},Z)})),U.apply(this,arguments)}function ee(Z,r,k){return P.apply(this,arguments)}function P(){return P=(0,F.Z)(g().mark(function Z(r,k,_){return g().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(0,c.ZP)("/api/countermeasures/".concat(r),(0,T.Z)({data:k,method:"PUT"},_||{})));case 1:case"end":return i.stop()}},Z)})),P.apply(this,arguments)}function n(Z,r){return u.apply(this,arguments)}function u(){return u=(0,F.Z)(g().mark(function Z(r,k){return g().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",(0,c.ZP)("/api/countermeasures/".concat(r),(0,T.Z)({method:"DELETE"},k||{})));case 1:case"end":return s.stop()}},Z)})),u.apply(this,arguments)}},60717:function(Se,J,t){"use strict";t.r(J),t.d(J,{default:function(){return cr}});var T=t(43185),F=t(11324),q=t(57663),g=t(71577),c=t(11849),V=t(49111),B=t(19650),ne=t(71194),U=t(50146),ee=t(34792),P=t(48086),n=t(3182),u=t(2824),Z=t(94043),r=t.n(Z),k=t(51885),_=t(37476),s=t(64317),i=t(67294),G=t(15433),Q=t(43581),We=t(28991),Ct={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M834.1 469.2A347.49 347.49 0 00751.2 354l-29.1-26.7a8.09 8.09 0 00-13 3.3l-13 37.3c-8.1 23.4-23 47.3-44.1 70.8-1.4 1.5-3 1.9-4.1 2-1.1.1-2.8-.1-4.3-1.5-1.4-1.2-2.1-3-2-4.8 3.7-60.2-14.3-128.1-53.7-202C555.3 171 510 123.1 453.4 89.7l-41.3-24.3c-5.4-3.2-12.3 1-12 7.3l2.2 48c1.5 32.8-2.3 61.8-11.3 85.9-11 29.5-26.8 56.9-47 81.5a295.64 295.64 0 01-47.5 46.1 352.6 352.6 0 00-100.3 121.5A347.75 347.75 0 00160 610c0 47.2 9.3 92.9 27.7 136a349.4 349.4 0 0075.5 110.9c32.4 32 70 57.2 111.9 74.7C418.5 949.8 464.5 959 512 959s93.5-9.2 136.9-27.3A348.6 348.6 0 00760.8 857c32.4-32 57.8-69.4 75.5-110.9a344.2 344.2 0 0027.7-136c0-48.8-10-96.2-29.9-140.9zM713 808.5c-53.7 53.2-125 82.4-201 82.4s-147.3-29.2-201-82.4c-53.5-53.1-83-123.5-83-198.4 0-43.5 9.8-85.2 29.1-124 18.8-37.9 46.8-71.8 80.8-97.9a349.6 349.6 0 0058.6-56.8c25-30.5 44.6-64.5 58.2-101a240 240 0 0012.1-46.5c24.1 22.2 44.3 49 61.2 80.4 33.4 62.6 48.8 118.3 45.8 165.7a74.01 74.01 0 0024.4 59.8 73.36 73.36 0 0053.4 18.8c19.7-1 37.8-9.7 51-24.4 13.3-14.9 24.8-30.1 34.4-45.6 14 17.9 25.7 37.4 35 58.4 15.9 35.8 24 73.9 24 113.1 0 74.9-29.5 145.4-83 198.4z"}}]},name:"fire",theme:"outlined"},Zt=Ct,it=t(27029),lt=function(f,a){return i.createElement(it.Z,(0,We.Z)((0,We.Z)({},f),{},{ref:a,icon:Zt}))};lt.displayName="FireOutlined";var Ue=i.forwardRef(lt),St={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M304 280h56c4.4 0 8-3.6 8-8 0-28.3 5.9-53.2 17.1-73.5 10.6-19.4 26-34.8 45.4-45.4C450.9 142 475.7 136 504 136h16c28.3 0 53.2 5.9 73.5 17.1 19.4 10.6 34.8 26 45.4 45.4C650 218.9 656 243.7 656 272c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-40-8.8-76.7-25.9-108.1a184.31 184.31 0 00-74-74C596.7 72.8 560 64 520 64h-16c-40 0-76.7 8.8-108.1 25.9a184.31 184.31 0 00-74 74C304.8 195.3 296 232 296 272c0 4.4 3.6 8 8 8z"}},{tag:"path",attrs:{d:"M940 512H792V412c76.8 0 139-62.2 139-139 0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8a63 63 0 01-63 63H232a63 63 0 01-63-63c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8 0 76.8 62.2 139 139 139v100H84c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h148v96c0 6.5.2 13 .7 19.3C164.1 728.6 116 796.7 116 876c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-44.2 23.9-82.9 59.6-103.7a273 273 0 0022.7 49c24.3 41.5 59 76.2 100.5 100.5S460.5 960 512 960s99.8-13.9 141.3-38.2a281.38 281.38 0 00123.2-149.5A120 120 0 01836 876c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-79.3-48.1-147.4-116.7-176.7.4-6.4.7-12.8.7-19.3v-96h148c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM716 680c0 36.8-9.7 72-27.8 102.9-17.7 30.3-43 55.6-73.3 73.3C584 874.3 548.8 884 512 884s-72-9.7-102.9-27.8c-30.3-17.7-55.6-43-73.3-73.3A202.75 202.75 0 01308 680V412h408v268z"}}]},name:"bug",theme:"outlined"},bt=St,ut=function(f,a){return i.createElement(it.Z,(0,We.Z)((0,We.Z)({},f),{},{ref:a,icon:bt}))};ut.displayName="BugOutlined";var Le=i.forwardRef(ut),$e=t(80821),ot=t(30909),Pt=t(41516),At=t(90631),Et=t(84391),_e=t(6842),Ar=t(89816),Ge=t(4042),Er=t(13062),Me=t(71230),jr=t(89032),ke=t(15746),Dr=t(18106),ct=t(51752),dt=t(70345),Te=t(44743),se=t(32611),jt=function(){return"_"+Math.random().toString(36).substr(2,9)},Re=t(5966),Ve=t(90672),Ke=t(98822),Dt=t(69610),kt=t(54941),wt=t(81306),xt=t(19809),e=t(85893),It=function(S){(0,wt.Z)(a,S);var f=(0,xt.Z)(a);function a(h){return(0,Dt.Z)(this,a),f.call(this,h)}return(0,kt.Z)(a,[{key:"componentDidUpdate",value:function(){this.props.propsAPI.executeCommand("autoZoom")}},{key:"componentDidMount",value:function(){this.props.propsAPI.executeCommand("autoZoom")}},{key:"render",value:function(){var W=this;return(0,e.jsx)(Ke.Zw,{className:this.props.className,data:this.props.data,onAfterChange:function(){localStorage.setItem(se.QG,JSON.stringify(W.props.propsAPI.save()))}})}}]),a}(i.Component),Ot=(0,Ke.Yn)(It),_t=t(14838),Ne=t.n(_t),Fe=ct.Z.TabPane,Mt={shape:"flow-circle",color:"#FA8C16"},Tt={shape:"flow-rect",color:"#1890FF"},Rt={shape:"flow-capsule",color:"#722ED1"},Ft=function(f){var a=f.importData,h=(0,i.useState)([]),W=(0,u.Z)(h,2),v=W[0],w=W[1],we=(0,i.useState)([]),ge=(0,u.Z)(we,2),ie=ge[0],pe=ge[1],je=(0,i.useState)([]),ye=(0,u.Z)(je,2),Ce=ye[0],me=ye[1],oe=(0,i.useState)([]),be=(0,u.Z)(oe,2),fe=be[0],Pe=be[1],Ze=(0,i.useState)({}),te=(0,u.Z)(Ze,2),R=te[0],K=te[1],re=function(A){switch(A){case"o":return Mt;case"h":return Rt;case"a":return Tt;default:return{}}},O=[{title:"ID",dataIndex:"id",key:"id",width:"10%",ellipsis:!0},{title:"Name",dataIndex:"name",key:"name",width:"20%"},{title:"Asset type",dataIndex:"part",key:"part",width:"10%",render:function(A){return(0,Te.JS)(A)}},{title:"Server",dataIndex:"server",key:"server",width:"10%"},{title:"Vendor",dataIndex:"vendor",key:"vendor",width:"10%"},{title:"Product",dataIndex:"product",key:"product",width:"10%"},{title:"Version",dataIndex:"version",key:"version",width:"10%"},{title:"Other",dataIndex:"custom_fields",key:"custom_fields",width:"30%",render:function(A,C){return(0,e.jsx)("ul",{children:Object.keys(C.custom_fields).map(function(D){return(0,e.jsx)("li",{children:"".concat(D,": ").concat(C.custom_fields[D])},D)})})}}],b=[{title:"ID",dataIndex:"id",key:"id",width:"10%",ellipsis:!0},{title:"Name",dataIndex:"name",key:"name",width:"40%"},{title:"Cost",dataIndex:"cost",key:"cost",width:"10%"},{title:"Coverage",dataIndex:"coverage",key:"coverage",width:"10%"},{title:"Coverage CVE",dataIndex:"cover_cves",key:"cover_cves",width:"30%",render:function(A,C){return(0,e.jsx)("ul",{children:C.cover_cves.map(function(D){return(0,e.jsx)("li",{children:D},D)})})}}],m=[{title:"ID",dataIndex:"id",key:"id",width:"10%",ellipsis:!0},{title:"Name",dataIndex:"name",key:"name",width:"20%"},{title:"Description",dataIndex:"description",key:"description",width:"30%"},{title:"Asset",dataIndex:"asset_id",key:"asset_id",width:"20%",render:function(A){return v.find(function(C){return C.id===A}).name}},{title:"C - I - A",dataIndex:"c_i_a",key:"c_i_a",width:"20%",render:function(A,C){return"".concat(C.confidentiality," - ").concat(C.integrity," - ").concat(C.availability)}}];return(0,i.useEffect)(function(){var d=function(){var A=(0,n.Z)(r().mark(function C(){var D,he,X,Oe;return r().wrap(function(H){for(;;)switch(H.prev=H.next){case 0:if(H.prev=0,a==={}){H.next=16;break}return D=a.assets,w(D),pe(a.countermeasures),me(a.security_goals),H.next=8,(0,G.Rt)({graph:{nodes:a.assets.map(function(de){return(0,c.Z)((0,c.Z)({},de),{},{id:de.id,label:de.name},re(de.part))}),edges:a.asset_relationships.map(function(de){return(0,c.Z)((0,c.Z)({},de),{},{id:jt()})})},nodesep:1,ranksep:2});case 8:return he=H.sent,X=he.data.graph,X.edges=X.edges.map(function(de){return(0,c.Z)((0,c.Z)({},de),{},{label:"".concat(de.access_vector," - ").concat(de.privilege)})}),Pe(he.data.graph),H.next=14,(0,dt.Cv)(a.system_profile_id);case 14:Oe=H.sent,K(Oe.data);case 16:H.next=21;break;case 18:H.prev=18,H.t0=H.catch(0),console.log(H.t0);case 21:case"end":return H.stop()}},C,null,[[0,18]])}));return function(){return A.apply(this,arguments)}}();d()},[a]),a!=={}&&R.description?(0,e.jsxs)(ct.Z,{defaultActiveKey:"1",children:[(0,e.jsx)(Fe,{tab:"General",children:(0,e.jsxs)(Me.Z,{gutter:16,children:[(0,e.jsxs)(ke.Z,{span:12,children:[(0,e.jsx)("b",{children:"System profile"}),(0,e.jsxs)("ul",{children:[(0,e.jsx)("li",{children:"Name: ".concat(R.name)}),(0,e.jsx)("li",{children:"Description: ".concat(R.description)}),Object.keys(R.custom_fields).map(function(d){return(0,e.jsx)("li",{children:"".concat(d,": ").concat(R.custom_fields[d])},d)}),(0,e.jsx)("li",{children:"Created at: ".concat((0,Te.gu)(R.created_at))}),(0,e.jsx)("li",{children:"Updated at: ".concat((0,Te.gu)(R.updated_at))})]})]}),(0,e.jsxs)(ke.Z,{span:12,children:[(0,e.jsx)("b",{children:"Deployment scenario information"}),(0,e.jsx)(Re.Z,{label:"Name",rules:[{required:!0}],name:"name"}),(0,e.jsx)(s.Z,{name:"status",label:"Stage",options:se.HW.map(function(d){return{label:d,value:d}}),placeholder:"Please select a status",rules:[{required:!0}]}),(0,e.jsx)(Ve.Z,{label:"Description",rules:[{required:!0}],name:"description",autoSize:{minRows:8,maxRows:8}})]})]})},"1"),(0,e.jsx)(Fe,{tab:"Assets",children:(0,e.jsx)(Ge.Z,{columns:O,dataSource:v,scroll:{y:350},pagination:!1})},"2"),(0,e.jsx)(Fe,{tab:"Security goals",children:(0,e.jsx)(Ge.Z,{columns:m,dataSource:Ce,scroll:{y:350},pagination:!1})},"3"),(0,e.jsx)(Fe,{tab:"Asset relationships",children:(0,e.jsx)(Ke.ZP,{className:Ne().editor,children:(0,e.jsx)(Me.Z,{className:Ne().editorBd,children:(0,e.jsx)(Ot,{className:Ne().flow,data:fe})})})},"4"),(0,e.jsx)(Fe,{tab:"Countermeasures",children:(0,e.jsx)(Ge.Z,{columns:b,dataSource:ie,scroll:{y:350},pagination:!1})},"5")]}):""},Bt=Ft,Wt=t(76208),Ut=t(74295),Lt=t(93162),$t=t.n(Lt),Gt=t(40727),ze=t(27596),z=t(25185),Vt=t(42568),kr=t(9715),pt=t(17681),Kt=t(93224),He=t(49101),Nt=t(59465),Ee=t(64172);function zt(S,f,a){return Ye.apply(this,arguments)}function Ye(){return Ye=(0,n.Z)(r().mark(function S(f,a,h){return r().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.abrupt("return",(0,Ee.ZP)("/api/deployment_scenarios/".concat(f,"/attackers"),(0,c.Z)({method:"GET",params:(0,c.Z)({},a)},h||{})));case 1:case"end":return v.stop()}},S)})),Ye.apply(this,arguments)}function wr(S,f,a,h){return Je.apply(this,arguments)}function Je(){return Je=_asyncToGenerator(_regeneratorRuntime.mark(function S(f,a,h,W){return _regeneratorRuntime.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.abrupt("return",api("/api/deployment_scenarios/".concat(f,"/attackers/").concat(a),_objectSpread({method:"GET",params:_objectSpread({},h)},W||{})));case 1:case"end":return w.stop()}},S)})),Je.apply(this,arguments)}function Ht(S,f,a){return Qe.apply(this,arguments)}function Qe(){return Qe=(0,n.Z)(r().mark(function S(f,a,h){return r().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.abrupt("return",(0,Ee.ZP)("/api/deployment_scenarios/".concat(f,"/attackers"),(0,c.Z)({data:a,method:"POST"},h||{})));case 1:case"end":return v.stop()}},S)})),Qe.apply(this,arguments)}function Yt(S,f,a,h){return Xe.apply(this,arguments)}function Xe(){return Xe=(0,n.Z)(r().mark(function S(f,a,h,W){return r().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.abrupt("return",(0,Ee.ZP)("/api/deployment_scenarios/".concat(f,"/attackers/").concat(a),(0,c.Z)({data:h,method:"PUT"},W||{})));case 1:case"end":return w.stop()}},S)})),Xe.apply(this,arguments)}function Jt(S,f,a){return qe.apply(this,arguments)}function qe(){return qe=(0,n.Z)(r().mark(function S(f,a,h){return r().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.abrupt("return",(0,Ee.ZP)("/api/deployment_scenarios/".concat(f,"/attackers/").concat(a),(0,c.Z)({method:"DELETE"},h||{})));case 1:case"end":return v.stop()}},S)})),qe.apply(this,arguments)}var Qt=function(f){var a=f.deployment_scenario_id,h=(0,i.useState)(!1),W=(0,u.Z)(h,2),v=W[0],w=W[1],we=(0,i.useState)(!0),ge=(0,u.Z)(we,2),ie=ge[0],pe=ge[1],je=(0,i.useState)({}),ye=(0,u.Z)(je,2),Ce=ye[0],me=ye[1],oe=(0,i.useState)({}),be=(0,u.Z)(oe,2),fe=be[0],Pe=be[1],Ze=(0,i.useRef)(),te=function(b){w(b),b||(pe(!0),me({}))},R=[{title:"Name",dataIndex:"name",sorter:!0,width:"10%"},{title:"Type of threat",dataIndex:"type",sorter:!0,width:"20%"},{title:"Description",dataIndex:"description",hideInForm:!0,hideInSearch:!0,width:"30%"},{title:"Target asset",tip:"Asset name - Attack vector - Privilege",dataIndex:"targets",key:"targets",hideInForm:!0,hideInSearch:!0,width:"30%",render:function(b,m){return(0,e.jsx)("ul",{children:b.map(function(d){return(0,e.jsx)("li",{children:"".concat(fe.assets.find(function(A){return A.id===d.asset_id}).name," - ").concat(d.attack_vector," - ").concat(d.privilege)},d.asset_id)})})}},{title:"Action",dataIndex:"option",valueType:"option",width:"10%",render:function(b,m){return[(0,e.jsx)(z.lu,{onClick:function(){w(!0),pe(!1),me(m)}},"edit"),(0,e.jsx)(z.G1,{onClick:function(){U.Z.confirm({title:"Delete threat",content:"Are you sure\uFF1F",okText:"Ok",cancelText:"Cancel",onOk:function(){var A=(0,n.Z)(r().mark(function D(){return r().wrap(function(X){for(;;)switch(X.prev=X.next){case 0:return X.next=2,K(m.id);case 2:return X.abrupt("return",X.sent);case 3:case"end":return X.stop()}},D)}));function C(){return A.apply(this,arguments)}return C}()})}},"delete")]}}],K=function(){var O=(0,n.Z)(r().mark(function b(m){var d;return r().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return C.prev=0,C.next=3,Jt(a,m);case 3:d=C.sent,d&&(P.default.success("Delete successful!"),Ze.current&&Ze.current.reload()),C.next=10;break;case 7:C.prev=7,C.t0=C.catch(0),P.default.error("Delete failed!");case 10:case"end":return C.stop()}},b,null,[[0,7]])}));return function(m){return O.apply(this,arguments)}}(),re=function(){var O=(0,n.Z)(r().mark(function b(m){var d,A;return r().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:if(m.targets.length){D.next=3;break}return P.default.error("Please setup target asset"),D.abrupt("return",!1);case 3:if(d=(0,c.Z)({},m),!ie){D.next=10;break}return D.next=7,Ht(a,d);case 7:D.t0=D.sent,D.next=13;break;case 10:return D.next=12,Yt(a,Ce.id,d);case 12:D.t0=D.sent;case 13:if(A=D.t0,!A){D.next=20;break}return P.default.success("".concat(ie?"Add":"Edit"," threat successful!")),Ze.current&&Ze.current.reload(),pe(!0),me({}),D.abrupt("return",!0);case 20:return P.default.error("".concat(ie?"Add":"Edit"," threat failed!")),D.abrupt("return",!1);case 22:case"end":return D.stop()}},b)}));return function(m){return O.apply(this,arguments)}}();return(0,i.useEffect)(function(){var O=function(){var b=(0,n.Z)(r().mark(function m(){var d;return r().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return C.next=2,(0,G.v$)(a);case 2:d=C.sent,Pe(d.data);case 4:case"end":return C.stop()}},m)}));return function(){return b.apply(this,arguments)}}();O()},[]),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(ze.ZP,{actionRef:Ze,rowKey:"id",search:!1,request:function(){var O=(0,n.Z)(r().mark(function b(m){return r().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return A.next=2,zt(a,m);case 2:return A.abrupt("return",A.sent);case 3:case"end":return A.stop()}},b)}));return function(b){return O.apply(this,arguments)}}(),columns:R,pagination:{pageSize:10},toolbar:{settings:[]},toolBarRender:function(){return[(0,e.jsxs)(g.Z,{type:"primary",onClick:function(){w(!0)},children:[(0,e.jsx)(He.Z,{})," Add"]},"primary")]},bordered:!0}),(0,e.jsx)(_.Y,{title:"".concat(ie?"Add":"Edit"," threat"),width:"1000px",visible:v,onVisibleChange:te,modalProps:{destroyOnClose:!0},onFinish:re,initialValues:Ce,children:(0,e.jsxs)(Me.Z,{gutter:10,children:[(0,e.jsxs)(ke.Z,{span:8,children:[(0,e.jsx)(Re.Z,{label:"Name",rules:[{required:!0}],name:"name"}),(0,e.jsx)(s.Z,{label:"Type of threat",rules:[{required:!0}],name:"type",options:se.TT.map(function(O){return{label:O,value:O}})}),(0,e.jsx)(Ve.Z,{label:"Desciption",rules:[{required:!0}],name:"description"})]}),(0,e.jsx)(ke.Z,{span:16,children:(0,e.jsxs)("div",{style:{height:300,overflow:"auto"},children:[(0,e.jsx)(Me.Z,{style:{marginBottom:9},children:"Target assets"}),(0,e.jsxs)(Me.Z,{style:{marginBottom:9},gutter:10,children:[(0,e.jsx)(ke.Z,{span:13,children:"Asset"}),(0,e.jsx)(ke.Z,{span:4,children:"Attack vector"}),(0,e.jsx)(ke.Z,{span:5,children:"Privilege"})]}),(0,e.jsx)(pt.Z.List,{name:"targets",children:function(b,m){var d=m.add,A=m.remove;return(0,e.jsxs)(e.Fragment,{children:[b.map(function(C){var D,he=C.key,X=C.name,Oe=(0,Kt.Z)(C,["key","name"]);return(0,e.jsxs)(B.Z,{style:{display:"flex",marginBottom:8},align:"baseline",children:[(0,e.jsx)(s.Z,{options:fe==null||(D=fe.assets)===null||D===void 0?void 0:D.map(function(ce){return{label:ce.name,value:ce.id}}),rules:[{required:!0}],name:[X,"asset_id"],width:"md"}),(0,e.jsx)(s.Z,{options:se.hG.map(function(ce){return{label:ce,value:ce}}),rules:[{required:!0}],name:[X,"attack_vector"],width:"xs"}),(0,e.jsx)(s.Z,{options:se.n4.map(function(ce){return{label:ce,value:ce}}),rules:[{required:!0}],name:[X,"privilege"],width:"xs"}),(0,e.jsx)(Nt.Z,{onClick:function(){return A(X)}})]},he)}),(0,e.jsx)(pt.Z.Item,{children:(0,e.jsx)(g.Z,{type:"dashed",onClick:function(){return d()},block:!0,icon:(0,e.jsx)(He.Z,{}),children:"Add field"})})]})}})]})})]})})]})},Xt=Qt,qt=t(57119),er=function(f){var a=f.deploymentScenario;return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Re.Z,{name:"name",label:"Name",rules:[{required:!0}],placeholder:"Please enter a name"}),(0,e.jsx)(Ve.Z,{name:"description",label:"Description",rules:[{required:!0}],placeholder:"Please enter a description"}),(0,e.jsx)(s.Z,{name:"status",label:"Stage",tooltip:{title:'Stage "'.concat(se.Gf,'" cannot switch back to stage "').concat(se.qz,'"'),icon:(0,e.jsx)(qt.Z,{style:{color:"red"}})},options:se.HW.map(function(h){return{label:h,value:h}}),rules:[{required:!0}],placeholder:"Please choose a satge"})]})},tr=er,rr=t(952),mt=t(31199);function ar(S,f,a){return et.apply(this,arguments)}function et(){return et=(0,n.Z)(r().mark(function S(f,a,h){return r().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.abrupt("return",(0,Ee.ZP)("/api/deployment_scenarios/".concat(f,"/countermeasures"),(0,c.Z)({method:"GET",params:(0,c.Z)({},a)},h||{})));case 1:case"end":return v.stop()}},S)})),et.apply(this,arguments)}function xr(S,f,a,h){return tt.apply(this,arguments)}function tt(){return tt=_asyncToGenerator(_regeneratorRuntime.mark(function S(f,a,h,W){return _regeneratorRuntime.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.abrupt("return",api("/api/deployment_scenarios/".concat(f,"/countermeasures/").concat(a),_objectSpread({method:"GET",params:_objectSpread({},h)},W||{})));case 1:case"end":return w.stop()}},S)})),tt.apply(this,arguments)}function nr(S,f,a){return rt.apply(this,arguments)}function rt(){return rt=(0,n.Z)(r().mark(function S(f,a,h){return r().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.abrupt("return",(0,Ee.ZP)("/api/deployment_scenarios/".concat(f,"/countermeasures"),(0,c.Z)({data:a,method:"POST"},h||{})));case 1:case"end":return v.stop()}},S)})),rt.apply(this,arguments)}function sr(S,f,a,h){return at.apply(this,arguments)}function at(){return at=(0,n.Z)(r().mark(function S(f,a,h,W){return r().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.abrupt("return",(0,Ee.ZP)("/api/deployment_scenarios/".concat(f,"/countermeasures/").concat(a),(0,c.Z)({data:h,method:"PUT"},W||{})));case 1:case"end":return w.stop()}},S)})),at.apply(this,arguments)}function ir(S,f,a){return nt.apply(this,arguments)}function nt(){return nt=(0,n.Z)(r().mark(function S(f,a,h){return r().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.abrupt("return",(0,Ee.ZP)("/api/deployment_scenarios/".concat(f,"/countermeasures/").concat(a),(0,c.Z)({method:"DELETE"},h||{})));case 1:case"end":return v.stop()}},S)})),nt.apply(this,arguments)}var lr=function(f){var a=f.deployment_scenario_id,h=(0,i.useState)(!1),W=(0,u.Z)(h,2),v=W[0],w=W[1],we=(0,i.useState)(!0),ge=(0,u.Z)(we,2),ie=ge[0],pe=ge[1],je=(0,i.useState)({}),ye=(0,u.Z)(je,2),Ce=ye[0],me=ye[1],oe=(0,i.useRef)(),be=function(R){w(R),R||(me({}),pe(!0))},fe=[{title:"Name",dataIndex:"name",sorter:!0,width:"30%"},{title:"Cost",dataIndex:"cost",hideInForm:!0,hideInSearch:!0,width:"20%"},{title:"Coverage",dataIndex:"coverage",hideInForm:!0,hideInSearch:!0,width:"20%"},{title:"Cover CVE(s)",dataIndex:"cover_cves",hideInForm:!0,hideInSearch:!0,width:"20%",render:function(R){return(0,e.jsx)("ul",{children:R.map(function(K){return(0,e.jsx)("li",{children:K},K)})})}},{title:"Action",dataIndex:"option",valueType:"option",width:"10%",render:function(R,K){return[(0,e.jsx)(z.lu,{onClick:function(){w(!0),pe(!1),me(K)}},"edit"),(0,e.jsx)(z.G1,{onClick:function(){U.Z.confirm({title:"Delete countermeasure",content:"Are you sure\uFF1F",okText:"Ok",cancelText:"Cancel",onOk:function(){var O=(0,n.Z)(r().mark(function m(){return r().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return A.next=2,Pe(K.id);case 2:return A.abrupt("return",A.sent);case 3:case"end":return A.stop()}},m)}));function b(){return O.apply(this,arguments)}return b}()})}},"delete")]}}],Pe=function(){var te=(0,n.Z)(r().mark(function R(K){var re;return r().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.prev=0,b.next=3,ir(a,K);case 3:re=b.sent,re&&(P.default.success("Delete successful!"),oe.current&&oe.current.reload()),b.next=10;break;case 7:b.prev=7,b.t0=b.catch(0),P.default.error("Delete failed!");case 10:case"end":return b.stop()}},R,null,[[0,7]])}));return function(K){return te.apply(this,arguments)}}(),Ze=function(){var te=(0,n.Z)(r().mark(function R(K){var re,O;return r().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(console.log("Values",K),re=(0,c.Z)({},K),Array.isArray(K.cover_cves)||(re.cover_cves=K.cover_cves.split(/[,]/).filter(function(d){return d.trim()}).map(function(d){return d.trim()})),!ie){m.next=9;break}return m.next=6,nr(a,re);case 6:m.t0=m.sent,m.next=12;break;case 9:return m.next=11,sr(a,Ce.id,re);case 11:m.t0=m.sent;case 12:if(O=m.t0,!O){m.next=19;break}return P.default.success("".concat(ie?"Add":"Edit"," countermeasure successful!")),oe.current&&oe.current.reload(),pe(!0),me({}),m.abrupt("return",!0);case 19:return P.default.error("".concat(ie?"Add":"Edit"," countermeasure failed!")),m.abrupt("return",!1);case 21:case"end":return m.stop()}},R)}));return function(K){return te.apply(this,arguments)}}();return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(ze.ZP,{actionRef:oe,rowKey:"id",search:!1,request:function(){var te=(0,n.Z)(r().mark(function R(K){return r().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return O.next=2,ar(a,K);case 2:return O.abrupt("return",O.sent);case 3:case"end":return O.stop()}},R)}));return function(R){return te.apply(this,arguments)}}(),columns:fe,pagination:{pageSize:10},toolbar:{settings:[]},toolBarRender:function(){return[(0,e.jsxs)(g.Z,{type:"primary",onClick:function(){w(!0)},children:[(0,e.jsx)(He.Z,{})," Add"]},"primary")]},bordered:!0}),(0,e.jsxs)(_.Y,{title:"".concat(ie?"Add":"Edit"," countermeasure"),visible:v,onVisibleChange:be,modalProps:{destroyOnClose:!0},onFinish:Ze,initialValues:Ce,children:[(0,e.jsx)(Re.Z,{label:"Name",rules:[{required:!0}],name:"name"}),(0,e.jsxs)(rr.ZP.Group,{children:[(0,e.jsx)(mt.Z,{label:"Cost",rules:[{required:!0}],name:"cost",min:0}),(0,e.jsx)(mt.Z,{label:"Coverage",rules:[{required:!0}],name:"coverage",max:1,min:0})]}),(0,e.jsx)(Re.Z,{label:"Cover CVE(s)",rules:[{required:!0}],name:"cover_cves",tooltip:"CVEs are separated by commas"})]})]})},ur=lr,Be=["General","Asset","Security goal","Asset relationship","Countermeasure"],or=function(){var f=".xlsx",a="deployment_scenario_template",h=(0,i.useRef)(),W=(0,i.useState)({}),v=(0,u.Z)(W,2),w=v[0],we=v[1],ge=(0,i.useState)(!1),ie=(0,u.Z)(ge,2),pe=ie[0],je=ie[1],ye=(0,i.useState)(!1),Ce=(0,u.Z)(ye,2),me=Ce[0],oe=Ce[1],be=(0,i.useState)(!0),fe=(0,u.Z)(be,2),Pe=fe[0],Ze=fe[1],te=(0,i.useState)(!1),R=(0,u.Z)(te,2),K=R[0],re=R[1],O=(0,i.useState)({}),b=(0,u.Z)(O,2),m=b[0],d=b[1],A=(0,i.useState)(!1),C=(0,u.Z)(A,2),D=C[0],he=C[1],X=(0,i.useState)(!1),Oe=(0,u.Z)(X,2),ce=Oe[0],H=Oe[1],de=(0,i.useState)(!1),ft=(0,u.Z)(de,2),dr=ft[0],st=ft[1],pr=(0,i.useState)([]),ht=(0,u.Z)(pr,2),vt=ht[0],mr=ht[1],fr=function(){var L=(0,n.Z)(r().mark(function $(o){var E;return r().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.prev=0,l.next=3,(0,G.oC)(o);case 3:E=l.sent,E&&(P.default.success("Delete successful!"),h.current&&h.current.reload()),l.next=10;break;case 7:l.prev=7,l.t0=l.catch(0),P.default.error("Delete failed!");case 10:case"end":return l.stop()}},$,null,[[0,7]])}));return function(o){return L.apply(this,arguments)}}(),gt=function(){he(!1)},yt=function(){H(!1)},hr=[{title:"Name",dataIndex:"name",key:"name",width:"20%"},{title:"System profile name",dataIndex:"system_profile",key:"system_profile",width:"20%",render:function($){return $[0].name}},{title:"Stage",dataIndex:"status",key:"status",width:"20%",align:"center"},{title:"Created at",dataIndex:"created_at",key:"created_at",hideInForm:!0,hideInSearch:!0,valueType:"date",width:"10%"},{title:"Updated at",dataIndex:"updated_at",key:"updated_at",hideInForm:!0,hideInSearch:!0,valueType:"date",width:"10%"},{title:"Action",dataIndex:"",key:"action",hideInForm:!0,hideInSearch:!0,width:"20%",align:"center",render:function($,o){return(0,e.jsxs)(B.Z,{children:[o.status===se.rD&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(z.ZP,{onClick:function(){he(!0),d(o)},title:"Setup threat",icon:(0,e.jsx)(Ue,{})}),(0,e.jsx)(z.ZP,{onClick:function(){Q.m8.push("/deployment-scenarios/mapping/".concat(o.id))},title:"Mapping vulnerabilties on asset",icon:(0,e.jsx)(Le,{})}),(0,e.jsx)(z.ZP,{onClick:function(){H(!0),d(o)},title:"Setting countermeasure",icon:(0,e.jsx)($e.Z,{})}),(0,e.jsx)(z.ZP,{onClick:function(){Q.m8.push("/risk-assessments/assessments/".concat(o.id))},title:"Risk assessment",icon:(0,e.jsx)(ot.Z,{})})]}),o.status===se.Gf&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(z.ZP,{onClick:function(){he(!0),d(o)},title:"Setup threat",icon:(0,e.jsx)(Ue,{})}),(0,e.jsx)(z.ZP,{onClick:function(){Q.m8.push("/deployment-scenarios/mapping/".concat(o.id))},title:"Mapping vulnerabilties on asset",icon:(0,e.jsx)(Le,{})}),(0,e.jsx)(z.ZP,{onClick:function(){H(!0),d(o)},title:"Setting countermeasure",icon:(0,e.jsx)($e.Z,{})}),(0,e.jsx)(z.ZP,{onClick:function(){Q.m8.push("/risk-monitoring/monitoring/".concat(o.id))},title:"Risk monitoring",icon:(0,e.jsx)(Pt.Z,{})})]}),o.status===se.qz&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(z.ZP,{onClick:function(){he(!0),d(o)},title:"Setup threat",icon:(0,e.jsx)(Ue,{})}),(0,e.jsx)(z.ZP,{onClick:function(){Q.m8.push("/deployment-scenarios/mapping/".concat(o.id))},title:"Mapping vulnerabilties on asset",icon:(0,e.jsx)(Le,{})}),(0,e.jsx)(z.ZP,{onClick:function(){H(!0),d(o)},title:"Setting countermeasure",icon:(0,e.jsx)($e.Z,{})}),(0,e.jsx)(z.ZP,{onClick:function(){Q.m8.push("/risk-assessments/assessments/".concat(o.id))},title:"Risk assessment",icon:(0,e.jsx)(ot.Z,{})})]}),(0,e.jsx)(z.lu,{onClick:function(){st(!0),d(o)}}),(0,e.jsx)(z.UN,{onClick:function(){Q.m8.push("/deployment-scenarios/".concat(o.id))}}),(0,e.jsx)(z.G1,{onClick:function(){U.Z.confirm({title:"Delete deployment scenario",content:"Are you sure\uFF1F",okText:"Ok",cancelText:"Cancel",onOk:function(){var M=(0,n.Z)(r().mark(function j(){return r().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,fr(o.id);case 2:return p.abrupt("return",p.sent);case 3:case"end":return p.stop()}},j)}));function l(){return M.apply(this,arguments)}return l}()})}})]})}}],vr=function(){var L=(0,n.Z)(r().mark(function $(o){var E,M,l,j,x,p,I,ve,le,Y,ae,De,ue,N,xe,Ae,Ie;return r().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(o.file.status!=="done"){y.next=110;break}return y.prev=1,E=o.file.originFileObj,y.next=5,(0,_e.Z)(E,{sheet:Be[0]});case 5:return M=y.sent,l={},j=0,l.system_profile_id=M[1][2],M.forEach(function(br,Pr){br[0]==="Deployment scenario"&&(j=Pr)}),l.name=M[j+1][2],l.description=M[j+2][2],l.status=M[j+3][2],l.assets=[],l.security_goals=[],l.asset_relationships=[],l.countermeasures=[],y.next=19,(0,_e.Z)(E,{sheet:Be[1]});case 19:x=y.sent,p=0;case 21:if(!(p<x.length)){y.next=50;break}if(!(p<4)){y.next=24;break}return y.abrupt("continue",47);case 24:I={},I.id=x[p][0],I.name=x[p][1],I.part=(0,Te.w7)(x[p][2]),I.server=x[p][3],I.vendor=x[p][4],I.product=x[p][5],I.version=x[p][6],I.custom_fields={},ve=x[p][7];case 34:if(!ve){y.next=46;break}if(ve=x[p][7],I.custom_fields[ve]=x[p][8],p!=x.length-1){y.next=39;break}return y.abrupt("break",46);case 39:if(x[p+1][0]){y.next=43;break}p++,y.next=44;break;case 43:return y.abrupt("break",46);case 44:y.next=34;break;case 46:l.assets.push(I);case 47:p++,y.next=21;break;case 50:return y.next=52,(0,_e.Z)(E,{sheet:Be[2]});case 52:le=y.sent,Y=0;case 54:if(!(Y<le.length)){y.next=69;break}if(!(Y<3)){y.next=57;break}return y.abrupt("continue",66);case 57:ae={},ae.id=le[Y][0],ae.name=le[Y][1],ae.description=le[Y][2],ae.asset_id=le[Y][3],ae.confidentiality=le[Y][4],ae.integrity=le[Y][5],ae.availability=le[Y][6],l.security_goals.push(ae);case 66:Y++,y.next=54;break;case 69:return y.next=71,(0,_e.Z)(E,{sheet:Be[3]});case 71:De=y.sent,ue=0;case 73:if(!(ue<De.length)){y.next=86;break}if(!(ue<3)){y.next=76;break}return y.abrupt("continue",83);case 76:N={},N.id=De[ue][0],N.source=De[ue][1],N.target=De[ue][2],N.access_vector=De[ue][3],N.privilege=De[ue][4],l.asset_relationships.push(N);case 83:ue++,y.next=73;break;case 86:return y.next=88,(0,_e.Z)(E,{sheet:Be[4]});case 88:xe=y.sent,Ae=0;case 90:if(!(Ae<xe.length)){y.next=103;break}if(!(Ae<3)){y.next=93;break}return y.abrupt("continue",100);case 93:Ie={},Ie.id=xe[Ae][0],Ie.name=xe[Ae][1],Ie.cost=xe[Ae][2],Ie.coverage=xe[Ae][3],Ie.cover_cves=xe[Ae][4].split(","),l.countermeasures.push(Ie);case 100:Ae++,y.next=90;break;case 103:we(l),je(!0),y.next=110;break;case 107:y.prev=107,y.t0=y.catch(1),console.log(y.t0);case 110:case"end":return y.stop()}},$,null,[[1,107]])}));return function(o){return L.apply(this,arguments)}}(),gr=function(){oe(!0)},yr=function(){var L=(0,n.Z)(r().mark(function $(o,E,M){var l,j,x,p,I,ve,le,Y,ae;return r().wrap(function(ue){for(;;)switch(ue.prev=ue.next){case 0:return l=new Ut.Workbook,j=l.addWorksheet("General"),x=5,j.mergeCells("A1","B1"),j.getCell("A1").value="System profile",j.getRow(2).values=[null,"ID",o.id],j.getRow(3).values=[null,"Name",o.name],j.getRow(4).values=[null,"Description",o.description],Object.keys(o.custom_fields).map(function(N){j.getRow(x).values=[null,N,o.custom_fields[N]],x++}),j.getRow(x++).values=[null,"Created by",o.created_by],j.getRow(x++).values=[null,"Updated by",o.updated_by],j.getRow(x++).values=[null,"Created at",o.created_at],j.getRow(x++).values=[null,"Updated at",o.updated_at],j.mergeCells("A".concat(x),"B".concat(x)),j.getCell("A".concat(x)).value="Deployment scenario",x++,j.getRow(x++).values=[null,"Name"],j.getRow(x++).values=[null,"Description"],j.getRow(x++).values=[null,"Stage"],p=l.addWorksheet("Asset"),p.mergeCells("A1","I1"),p.getCell("A1").value="Asset",p.mergeCells("A3","A4"),p.getCell("A3").value="ID",p.mergeCells("B3","B4"),p.getCell("B3").value="Asset name",p.mergeCells("C3","C4"),p.getCell("C3").value="Asset type",p.mergeCells("D3","D4"),p.getCell("D3").value="Server",p.mergeCells("E3","E4"),p.getCell("E3").value="Vendor",p.mergeCells("F3","F4"),p.getCell("F3").value="Product",p.mergeCells("G3","G4"),p.getCell("G3").value="Version",p.mergeCells("H3","I3"),p.getCell("H3").value="Other",p.getCell("H4").value="Attribute",p.getCell("I4").value="Value",I=l.addWorksheet("Security goal"),I.mergeCells("A1","G1"),I.getCell("A1").value="Security Goal",I.getRow(3).values=["ID","Name","Description","Asset ID","Confidentiality","Integrity","Availability"],ve=l.addWorksheet("Asset relationship"),ve.mergeCells("A1","E1"),ve.getCell("A1").value="Asset Relationship",ve.getRow(3).values=["ID","Asset ID source","Asset ID target","Access vector","Privilege"],le=l.addWorksheet("Countermeasure"),le.mergeCells("A1","E1"),le.getCell("A1").value="Countermeasure",le.getRow(3).values=["ID","Name","Cost","Coverage","Coverage CVE_ID"],Y=l.addWorksheet("Data Asset"),Y.mergeCells("A1","C1"),Y.getCell("A1").value="Data Asset",Y.getRow(3).values=["ID","Asset name","Asset type"],Y.columns=[{key:"id"},{key:"name"},{key:"part"}],E.forEach(function(N){return Y.addRow((0,c.Z)((0,c.Z)({},N),{},{part:(0,Te.JS)(N.part)}))}),ae=l.addWorksheet("Data Countermeasure"),ae.mergeCells("A1","C1"),ae.getCell("A1").value="Data Countermeasure",ae.getRow(3).values=["ID","Name","Coverage CVE_ID"],ae.columns=[{key:"id"},{key:"name"},{key:"cover_cves"}],M.forEach(function(N){return ae.addRow((0,c.Z)((0,c.Z)({},N),{},{cover_cves:N.cover_cves.join(",")}))}),ue.next=66,l.xlsx.writeBuffer().then(function(N){return $t().saveAs(new Blob([N]),a+f)}).catch(function(N){return console.log("Error writing excel export",N)});case 66:case"end":return ue.stop()}},$)}));return function(o,E,M){return L.apply(this,arguments)}}(),Cr=function(){var L=(0,n.Z)(r().mark(function $(o){var E,M,l,j,x;return r().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:return I.prev=0,E=vt.find(function(ve){return ve.id==o.system_profile}),I.next=4,(0,Wt.Vh)({pageSize:se.n1});case 4:return M=I.sent,I.next=7,(0,Gt.Gl)({pageSize:se.n1});case 7:return l=I.sent,j=M.data||[],x=l.data||[],I.next=12,yr(E,j,x);case 12:return P.default.success("Download successful!"),I.abrupt("return",!0);case 16:return I.prev=16,I.t0=I.catch(0),console.log(I.t0),P.default.error("Download failed!"),I.abrupt("return",!1);case 21:return I.abrupt("return",!1);case 22:case"end":return I.stop()}},$,null,[[0,16]])}));return function(o){return L.apply(this,arguments)}}(),Zr=function(){var L=(0,n.Z)(r().mark(function $(o){var E,M;return r().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return E=(0,c.Z)((0,c.Z)({},w),o),j.next=3,(0,G.LZ)(E);case 3:if(M=j.sent,!M){j.next=8;break}return P.default.success("".concat(Pe?"Add":"Edit"," deployment scenario successful!")),h.current&&h.current.reload(),j.abrupt("return",!0);case 8:return P.default.error("".concat(Pe?"Add":"Edit"," deployment scenario failed!")),j.abrupt("return",!1);case 10:case"end":return j.stop()}},$)}));return function(o){return L.apply(this,arguments)}}(),Sr=function(){var L=(0,n.Z)(r().mark(function $(){var o;return r().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return M.prev=0,M.next=3,(0,dt.aT)({pageSize:se.n1});case 3:o=M.sent,mr(o.data||[]),M.next=11;break;case 7:M.prev=7,M.t0=M.catch(0),console.log(M.t0),P.default.error("Error!");case 11:case"end":return M.stop()}},$,null,[[0,7]])}));return function(){return L.apply(this,arguments)}}(),Ir=function(){st(!1)},Or=function(){};return(0,i.useEffect)(function(){Sr()},[]),(0,e.jsxs)(k.ZP,{children:[(0,e.jsx)(ze.ZP,{actionRef:h,rowKey:"id",search:{labelWidth:"auto"},request:G.h8,columns:hr,pagination:{pageSize:10},toolbar:{settings:[]},bordered:!0,toolBarRender:function(){return[(0,e.jsx)(g.Z,{icon:(0,e.jsx)(At.Z,{}),onClick:gr,children:"Download template"},"download"),(0,e.jsx)(F.Z,{onChange:function(o){return vr(o)},accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",showUploadList:!1,action:"/api/upload_file",children:(0,e.jsx)(g.Z,{icon:(0,e.jsx)(Et.Z,{}),children:"Import"})},"upload")]}}),(0,e.jsx)(_.Y,{title:"".concat(Pe?"Add":"Edit"," deployment scenario"),visible:pe,onVisibleChange:je,modalProps:{destroyOnClose:!0,wrapClassName:"modal-fullscreen"},initialValues:w,onFinish:Zr,children:(0,e.jsx)(Bt,{importData:w})}),(0,e.jsx)(_.Y,{title:"Download template deployment scenario",width:"400px",visible:me,onVisibleChange:oe,modalProps:{okText:"Download",destroyOnClose:!0,wrapClassName:"normal-modal"},onFinish:Cr,children:(0,e.jsx)(s.Z,{name:"system_profile",label:"Deployment scenario for system profile",options:vt.map(function(L){return{label:L.name,value:L.id}}),placeholder:"Please select a system profile",rules:[{required:!0}]})}),(0,e.jsx)(_.Y,{title:"Mapping vulnerabilities on asset",visible:K,onVisibleChange:re,modalProps:{destroyOnClose:!0,wrapClassName:"modal-fullscreen"},initialValues:m,onFinish:function(){return!1},children:(0,e.jsx)(Vt.Z,{deploymentScenario:m})}),(0,e.jsx)(U.Z,{title:"Threat",destroyOnClose:!0,wrapClassName:"modal-fullscreen",visible:D,onOk:gt,onCancel:gt,children:(0,e.jsx)(Xt,{deployment_scenario_id:m.id})}),(0,e.jsx)(U.Z,{title:"Countermeasures",destroyOnClose:!0,wrapClassName:"modal-fullscreen",visible:ce,onOk:yt,onCancel:yt,children:(0,e.jsx)(ur,{deployment_scenario_id:m.id})}),(0,e.jsx)(_.Y,{title:"Edit deployment scenario",visible:dr,onVisibleChange:st,modalProps:{destroyOnClose:!0},initialValues:m,onFinish:function(){var L=(0,n.Z)(r().mark(function $(o){var E;return r().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,(0,G.YC)(m.id,o);case 2:if(E=l.sent,!E){l.next=7;break}return P.default.success("Edit done!"),h.current&&h.current.reload(),l.abrupt("return",!0);case 7:return l.abrupt("return",!1);case 8:case"end":return l.stop()}},$)}));return function($){return L.apply(this,arguments)}}(),children:(0,e.jsx)(tr,{deploymentScenario:m})})]})},cr=or},70345:function(Se,J,t){"use strict";t.d(J,{aT:function(){return V},Cv:function(){return ne},Kq:function(){return ee},aI:function(){return n},Me:function(){return Z}});var T=t(11849),F=t(3182),q=t(94043),g=t.n(q),c=t(64172);function V(k,_){return B.apply(this,arguments)}function B(){return B=(0,F.Z)(g().mark(function k(_,s){return g().wrap(function(G){for(;;)switch(G.prev=G.next){case 0:return G.abrupt("return",(0,c.ZP)("/api/system_profiles",(0,T.Z)({method:"GET",params:(0,T.Z)({},_)},s||{})));case 1:case"end":return G.stop()}},k)})),B.apply(this,arguments)}function ne(k,_,s){return U.apply(this,arguments)}function U(){return U=(0,F.Z)(g().mark(function k(_,s,i){return g().wrap(function(Q){for(;;)switch(Q.prev=Q.next){case 0:return Q.abrupt("return",(0,c.ZP)("/api/system_profiles/".concat(_),(0,T.Z)({method:"GET",params:(0,T.Z)({},s)},i||{})));case 1:case"end":return Q.stop()}},k)})),U.apply(this,arguments)}function ee(k,_){return P.apply(this,arguments)}function P(){return P=(0,F.Z)(g().mark(function k(_,s){return g().wrap(function(G){for(;;)switch(G.prev=G.next){case 0:return G.abrupt("return",(0,c.ZP)("/api/system_profiles",(0,T.Z)({data:_,method:"POST"},s||{})));case 1:case"end":return G.stop()}},k)})),P.apply(this,arguments)}function n(k,_,s){return u.apply(this,arguments)}function u(){return u=(0,F.Z)(g().mark(function k(_,s,i){return g().wrap(function(Q){for(;;)switch(Q.prev=Q.next){case 0:return Q.abrupt("return",(0,c.ZP)("/api/system_profiles/".concat(_),(0,T.Z)({data:s,method:"PUT"},i||{})));case 1:case"end":return Q.stop()}},k)})),u.apply(this,arguments)}function Z(k,_){return r.apply(this,arguments)}function r(){return r=(0,F.Z)(g().mark(function k(_,s){return g().wrap(function(G){for(;;)switch(G.prev=G.next){case 0:return G.abrupt("return",(0,c.ZP)("/api/system_profiles/".concat(_),(0,T.Z)({method:"DELETE"},s||{})));case 1:case"end":return G.stop()}},k)})),r.apply(this,arguments)}}}]);
