(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[366],{5966:function(me,Se,r){"use strict";var Z=r(22122),H=r(81253),de=r(67294),j=r(39178),M=["fieldProps","proFieldProps"],B=["fieldProps","proFieldProps"],k="text",T=function(s){var J=s.fieldProps,_=s.proFieldProps,p=(0,H.Z)(s,M);return de.createElement(j.Z,(0,Z.Z)({mode:"edit",valueType:k,fieldProps:J,filedConfig:{valueType:k},proFieldProps:_},p))},ue=function(s){var J=s.fieldProps,_=s.proFieldProps,p=(0,H.Z)(s,B);return de.createElement(j.Z,(0,Z.Z)({mode:"edit",valueType:"password",fieldProps:J,proFieldProps:_,filedConfig:{valueType:k}},p))},Q=T;Q.Password=ue,Q.displayName="ProFormComponent",Se.Z=Q},66865:function(me){me.exports={contextMenu:"contextMenu___2YQuf",item:"item___1wBSy",anticon:"anticon___2kQpO"}},39185:function(me){me.exports={detailPanel:"detailPanel___s0K6N"}},23749:function(me){me.exports={itemPanel:"itemPanel___1ktzr"}},30722:function(me){me.exports={toolbar:"toolbar___3QXKl",tooltip:"tooltip___3YWkr"}},30802:function(me){me.exports={editor:"editor___1Uqva",editorHd:"editorHd___2k6Tg",editorBd:"editorBd___370hp",editorSidebar:"editorSidebar___2U2YI",editorContent:"editorContent___3SBGs",flow:"flow___2C2iX",mind:"mind___1Jhp_",koni:"koni___9sfKr"}},910:function(me){me.exports={steps_content:"steps_content___1Xglu"}},87445:function(me,Se,r){"use strict";r.d(Se,{b:function(){return B}});var Z=r(11849),H=r(3182),de=r(94043),j=r.n(de),M=r(64172);function B(Q,Y){return k.apply(this,arguments)}function k(){return k=(0,H.Z)(j().mark(function Q(Y,s){return j().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.abrupt("return",(0,M.ZP)("/api/cves",(0,Z.Z)({method:"GET",params:(0,Z.Z)({},Y)},s||{})));case 1:case"end":return _.stop()}},Q)})),k.apply(this,arguments)}function T(Q,Y){return ue.apply(this,arguments)}function ue(){return ue=_asyncToGenerator(_regeneratorRuntime.mark(function Q(Y,s){return _regeneratorRuntime.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.abrupt("return",api("/api/cves",_objectSpread({data:Y,method:"PUT"},s||{})));case 1:case"end":return _.stop()}},Q)})),ue.apply(this,arguments)}},47590:function(me,Se,r){"use strict";r.d(Se,{i:function(){return B}});var Z=r(11849),H=r(3182),de=r(94043),j=r.n(de),M=r(64172);function B(Q,Y){return k.apply(this,arguments)}function k(){return k=(0,H.Z)(j().mark(function Q(Y,s){return j().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.abrupt("return",(0,M.ZP)("/api/cwes",(0,Z.Z)({method:"GET",params:(0,Z.Z)({},Y)},s||{})));case 1:case"end":return _.stop()}},Q)})),k.apply(this,arguments)}function T(Q,Y){return ue.apply(this,arguments)}function ue(){return ue=_asyncToGenerator(_regeneratorRuntime.mark(function Q(Y,s){return _regeneratorRuntime.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.abrupt("return",api("/api/cwes",_objectSpread({data:Y,method:"PUT"},s||{})));case 1:case"end":return _.stop()}},Q)})),ue.apply(this,arguments)}},15433:function(me,Se,r){"use strict";r.d(Se,{h8:function(){return B},v$:function(){return T},LZ:function(){return _},YC:function(){return Ce},bg:function(){return Me},oC:function(){return oe},Rt:function(){return We},Fx:function(){return bt},km:function(){return f},s9:function(){return Ke}});var Z=r(11849),H=r(3182),de=r(94043),j=r.n(de),M=r(64172);function B(h,O){return k.apply(this,arguments)}function k(){return k=(0,H.Z)(j().mark(function h(O,K){return j().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.abrupt("return",(0,M.ZP)("/api/deployment_scenarios",(0,Z.Z)({method:"GET",params:(0,Z.Z)({},O)},K||{})));case 1:case"end":return E.stop()}},h)})),k.apply(this,arguments)}function T(h,O,K){return ue.apply(this,arguments)}function ue(){return ue=(0,H.Z)(j().mark(function h(O,K,re){return j().wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:return ae.abrupt("return",(0,M.ZP)("/api/deployment_scenarios/".concat(O),(0,Z.Z)({method:"GET",params:(0,Z.Z)({},K)},re||{})));case 1:case"end":return ae.stop()}},h)})),ue.apply(this,arguments)}function Q(h,O,K){return Y.apply(this,arguments)}function Y(){return Y=_asyncToGenerator(_regeneratorRuntime.mark(function h(O,K,re){return _regeneratorRuntime.wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:return ae.abrupt("return",api("/api/deployment_scenarios/".concat(O,"/attackers"),_objectSpread({method:"GET",params:_objectSpread({},K)},re||{})));case 1:case"end":return ae.stop()}},h)})),Y.apply(this,arguments)}function s(h,O,K){return J.apply(this,arguments)}function J(){return J=_asyncToGenerator(_regeneratorRuntime.mark(function h(O,K,re){return _regeneratorRuntime.wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:return ae.abrupt("return",api("/api/deployment_scenarios/".concat(O,"/attackers"),_objectSpread({data:K,method:"POST"},re||{})));case 1:case"end":return ae.stop()}},h)})),J.apply(this,arguments)}function _(h,O){return p.apply(this,arguments)}function p(){return p=(0,H.Z)(j().mark(function h(O,K){return j().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.abrupt("return",(0,M.ZP)("/api/deployment_scenarios",(0,Z.Z)({data:O,method:"POST"},K||{})));case 1:case"end":return E.stop()}},h)})),p.apply(this,arguments)}function Ce(h,O,K){return m.apply(this,arguments)}function m(){return m=(0,H.Z)(j().mark(function h(O,K,re){return j().wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:return ae.abrupt("return",(0,M.ZP)("/api/deployment_scenarios/".concat(O),(0,Z.Z)({data:K,method:"PUT"},re||{})));case 1:case"end":return ae.stop()}},h)})),m.apply(this,arguments)}function Me(h,O,K,re){return fe.apply(this,arguments)}function fe(){return fe=(0,H.Z)(j().mark(function h(O,K,re,E){return j().wrap(function(ve){for(;;)switch(ve.prev=ve.next){case 0:return ve.abrupt("return",(0,M.ZP)("/api/deployment_scenarios/".concat(O,"/assets/").concat(K),(0,Z.Z)({data:re,method:"PUT"},E||{})));case 1:case"end":return ve.stop()}},h)})),fe.apply(this,arguments)}function oe(h,O){return l.apply(this,arguments)}function l(){return l=(0,H.Z)(j().mark(function h(O,K){return j().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.abrupt("return",(0,M.ZP)("/api/deployment_scenarios/".concat(O),(0,Z.Z)({method:"DELETE"},K||{})));case 1:case"end":return E.stop()}},h)})),l.apply(this,arguments)}function We(h,O){return ne.apply(this,arguments)}function ne(){return ne=(0,H.Z)(j().mark(function h(O,K){return j().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.abrupt("return",(0,M.ZP)("/api/helper/generate_coordinates",(0,Z.Z)({method:"POST",data:O},K||{})));case 1:case"end":return E.stop()}},h)})),ne.apply(this,arguments)}function bt(h,O){return Pe.apply(this,arguments)}function Pe(){return Pe=(0,H.Z)(j().mark(function h(O,K){return j().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.abrupt("return",(0,M.ZP)("/api/deployment_scenarios/mapping_cpe",(0,Z.Z)({method:"GET",params:(0,Z.Z)({},O)},K||{})));case 1:case"end":return E.stop()}},h)})),Pe.apply(this,arguments)}function Et(h,O){return Te.apply(this,arguments)}function Te(){return Te=_asyncToGenerator(_regeneratorRuntime.mark(function h(O,K){return _regeneratorRuntime.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.abrupt("return",api("/api/deployment_scenarios/mapping_cve",_objectSpread({method:"GET",params:_objectSpread({},O)},K||{})));case 1:case"end":return E.stop()}},h)})),Te.apply(this,arguments)}function f(h,O,K,re){return Le.apply(this,arguments)}function Le(){return Le=(0,H.Z)(j().mark(function h(O,K,re,E){return j().wrap(function(ve){for(;;)switch(ve.prev=ve.next){case 0:return ve.abrupt("return",(0,M.ZP)("/api/deployment_scenarios/".concat(O,"/assets/").concat(K,"/cves"),(0,Z.Z)({method:"GET",params:(0,Z.Z)({},re)},E||{})));case 1:case"end":return ve.stop()}},h)})),Le.apply(this,arguments)}var Ke=function(){var h=(0,H.Z)(j().mark(function O(K,re,E){return j().wrap(function(ve){for(;;)switch(ve.prev=ve.next){case 0:return ve.abrupt("return",(0,M.ZP)("/api/deployment_scenarios/".concat(K,"/attack_graph/cves"),(0,Z.Z)({method:"GET",params:(0,Z.Z)({},re)},E||{})));case 1:case"end":return ve.stop()}},O)}));return function(K,re,E){return h.apply(this,arguments)}}()},44878:function(me,Se,r){"use strict";r.r(Se),r.d(Se,{default:function(){return Hn}});var Z=r(58024),H=r(91894),de=r(57663),j=r(71577),M=r(98858),B=r(4914),k=r(3182),T=r(2824),ue=r(35556),Q=r(97880),Y=r(94043),s=r.n(Y),J=r(47590),_=r(15433),p=r(32611),Ce=r(51885),m=r(67294),Me=r(3515),fe=r(86288),oe=r(13062),l=r(71230),We=r(89032),ne=r(15746),bt=r(89816),Pe=r(4042),Et=r(34792),Te=r(48086),f=r(11849),Le=r(7359),Ke=r(27279),h=r(44743),O=r(85720),K=r(3941),re=r(79508),E=r(54549),ae=r(7085),ve=r(27596),Ge=r(64172);function $n(g,t,a){return qe.apply(this,arguments)}function qe(){return qe=_asyncToGenerator(_regeneratorRuntime.mark(function g(t,a,c){return _regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",api("/api/assessments/".concat(t),_objectSpread({method:"GET",params:_objectSpread({},a)},c||{})));case 1:case"end":return i.stop()}},g)})),qe.apply(this,arguments)}function Qn(g,t){return et.apply(this,arguments)}function et(){return et=_asyncToGenerator(_regeneratorRuntime.mark(function g(t,a){return _regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",api("/api/attack_graphs",_objectSpread({method:"GET",params:_objectSpread({},t)},a||{})));case 1:case"end":return n.stop()}},g)})),et.apply(this,arguments)}function qn(g,t){return tt.apply(this,arguments)}function tt(){return tt=_asyncToGenerator(_regeneratorRuntime.mark(function g(t,a){return _regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",api("/api/countermeasures",_objectSpread({method:"GET",params:_objectSpread({},t)},a||{})));case 1:case"end":return n.stop()}},g)})),tt.apply(this,arguments)}function Dt(g,t,a){return nt.apply(this,arguments)}function nt(){return nt=(0,k.Z)(s().mark(function g(t,a,c){return s().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(0,Ge.ZP)("/api/deployment_scenarios/".concat(t,"/assessment"),(0,f.Z)({method:"POST",headers:{"Content-Type":"application/json"},data:a},c||{})));case 1:case"end":return i.stop()}},g)})),nt.apply(this,arguments)}function St(g,t,a){return rt.apply(this,arguments)}function rt(){return rt=(0,k.Z)(s().mark(function g(t,a,c){return s().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(0,Ge.ZP)("/api/deployment_scenarios/".concat(t,"/assets"),(0,f.Z)({method:"GET",params:(0,f.Z)({},a)},c||{})));case 1:case"end":return i.stop()}},g)})),rt.apply(this,arguments)}function Rt(g,t,a){return at.apply(this,arguments)}function at(){return at=(0,k.Z)(s().mark(function g(t,a,c){return s().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(0,Ge.ZP)("/api/deployment_scenarios/".concat(t,"/countermeasures"),(0,f.Z)({method:"GET",params:(0,f.Z)({},a)},c||{})));case 1:case"end":return i.stop()}},g)})),at.apply(this,arguments)}function Wt(g,t,a){return it.apply(this,arguments)}function it(){return it=(0,k.Z)(s().mark(function g(t,a,c){return s().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(0,Ge.ZP)("/api/deployment_scenarios/".concat(t,"/attack_graph"),(0,f.Z)({method:"GET",params:(0,f.Z)({},a)},c||{})));case 1:case"end":return i.stop()}},g)})),it.apply(this,arguments)}function Ot(g,t,a,c){return st.apply(this,arguments)}function st(){return st=(0,k.Z)(s().mark(function g(t,a,c,n){return s().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",(0,Ge.ZP)("/api/deployment_scenarios/".concat(t,"/assets/").concat(a,"/cves"),(0,f.Z)({method:"GET",params:(0,f.Z)({},c)},n||{})));case 1:case"end":return o.stop()}},g)})),st.apply(this,arguments)}function Vt(g,t,a,c){return ot.apply(this,arguments)}function ot(){return ot=(0,k.Z)(s().mark(function g(t,a,c,n){return s().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",(0,Ge.ZP)("/api/deployment_scenarios/".concat(t,"/attack_graph/assets/").concat(a,"/cves"),(0,f.Z)({method:"GET",params:(0,f.Z)({},c)},n||{})));case 1:case"end":return o.stop()}},g)})),ot.apply(this,arguments)}function er(g,t,a,c,n){return lt.apply(this,arguments)}function lt(){return lt=_asyncToGenerator(_regeneratorRuntime.mark(function g(t,a,c,n,i){return _regeneratorRuntime.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.abrupt("return",api("/api/deployment_scenarios/".concat(t,"/assets/").concat(a,"/cves/").concat(c),_objectSpread({method:"POST",headers:{"Content-Type":"application/json"},data:n},i||{})));case 1:case"end":return b.stop()}},g)})),lt.apply(this,arguments)}function zt(g,t,a,c){return ut.apply(this,arguments)}function ut(){return ut=(0,k.Z)(s().mark(function g(t,a,c,n){return s().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",(0,Ge.ZP)("/api/deployment_scenarios/".concat(t,"/assets/").concat(a,"/cves"),(0,f.Z)({method:"PUT",headers:{"Content-Type":"application/json"},data:c},n||{})));case 1:case"end":return o.stop()}},g)})),ut.apply(this,arguments)}function Ft(g,t,a,c){return ct.apply(this,arguments)}function ct(){return ct=(0,k.Z)(s().mark(function g(t,a,c,n){return s().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",(0,Ge.ZP)("/api/deployment_scenarios/".concat(t,"/attack_graph/assets/").concat(a,"/cves"),(0,f.Z)({method:"POST",headers:{"Content-Type":"application/json"},data:c},n||{})));case 1:case"end":return o.stop()}},g)})),ct.apply(this,arguments)}function Lt(g,t,a){return dt.apply(this,arguments)}function dt(){return dt=(0,k.Z)(s().mark(function g(t,a,c){return s().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(0,Ge.ZP)("/api/deployment_scenarios/".concat(t,"/save_assessment"),(0,f.Z)({method:"POST",headers:{"Content-Type":"application/json"},data:a},c||{})));case 1:case"end":return i.stop()}},g)})),dt.apply(this,arguments)}var Kt=r(43581),Bt=r(37476),Yt=r(5966),e=r(85893),pt=Ke.Z.Panel,Ut=function(t){var a=t.deployment_scenario_id,c=t.damageCriterion,n=t.benefitCriterion,i=t.exploitability,o=t.remediationLevel,b=t.reportConfidence,S=(0,m.useState)(!1),D=(0,T.Z)(S,2),W=D[0],w=D[1],P=(0,m.useState)([{attribute:"Severity",not_implemented:"",implemented:""},{attribute:"Likelihood",not_implemented:"",implemented:""},{attribute:"Risk level",not_implemented:"",implemented:""}]),I=(0,T.Z)(P,2),N=I[0],V=I[1],u=(0,m.useState)([]),x=(0,T.Z)(u,2),A=x[0],R=x[1],C=(0,m.useState)(!1),y=(0,T.Z)(C,2),d=y[0],G=y[1],De=(0,m.useState)([]),xe=(0,T.Z)(De,2),be=xe[0],Ae=xe[1],ie=(0,m.useState)([]),L=(0,T.Z)(ie,2),X=L[0],ee=L[1],q=(0,m.useState)([]),he=(0,T.Z)(q,2),$=he[0],se=he[1],_e=(0,m.useState)(!1),ye=(0,T.Z)(_e,2),Ze=ye[0],we=ye[1];(0,m.useEffect)(function(){Re()},[]);var Re=function(){var pe=(0,k.Z)(s().mark(function U(){var v,z,te,F,Ve,ze,Ee,Fe;return s().wrap(function(Ie){for(;;)switch(Ie.prev=Ie.next){case 0:return Ie.prev=0,G(!0),Ie.next=4,Dt(a,{damage_criterion:parseFloat(c),benefit_criterion:parseFloat(n),exploitability:i,remediation_level:o,report_confidence:b});case 4:v=Ie.sent,v&&(z=[],v.data.countermeasures.map(function(le){return le.type===p.gy&&z.push((0,f.Z)((0,f.Z)({},le),{},{value:le.outcomes.True})),le}),te=v.data.cia.countermeasures.map(function(le){return(0,f.Z)((0,f.Z)({},le),{},{severity:(0,h.jv)("".concat(9-(le.confidentiality+le.integrity+le.availability)))})}),F=v.data.cia.not_countermeasures.map(function(le){return(0,f.Z)((0,f.Z)({},le),{},{severity:(0,h.jv)(9-(le.confidentiality+le.integrity+le.availability))})}),Ve=(0,h.vh)(F.reduce(function(le,xt){return le+xt.severity},0)/F.length),ze=(0,h.vh)(te.reduce(function(le,xt){return le+xt.severity},0)/te.length),Ee=(0,h.rJ)(v.data.likelihood.not_countermeasures.outcomes[p.o6]),Fe=(0,h.rJ)(v.data.likelihood.countermeasures.outcomes[p.o6]),V([{attribute:"Severity",not_implemented:Ve[0],implemented:ze[0]},{attribute:"Likelihood",not_implemented:Ee[0],implemented:Fe[0]},{attribute:"Risk level",not_implemented:(0,h.zd)(Ve[1],Ee[1]),implemented:(0,h.zd)(ze[1],Fe[1])}]),Ae(te),ee(F),se(v.data.security_goals),R(z.map(function(le){return{Value:le.value,Name:le.name,Cost:le.cost}})),w(!0)),G(!1),Ie.next=12;break;case 9:Ie.prev=9,Ie.t0=Ie.catch(0),console.log(Ie.t0);case 12:case"end":return Ie.stop()}},U,null,[[0,9]])}));return function(){return pe.apply(this,arguments)}}(),ht={data:A,xField:"Cost",yField:"Value",colorField:"Name",tooltip:{fields:["Name","Cost","Value"],showMarkers:!1,showTitle:!1},yAxis:{nice:!0,line:{style:{stroke:"#aaa"}},title:{text:"Value",position:"end"}},xAxis:{title:{text:"Cost",position:"end"}},legend:{layout:"vertical",position:"right"}},Xe={data:p.uT,xField:"Likelihood",yField:"Severity",colorField:"value",interactions:[{type:"element-active"}],tooltip:{fields:["Risk level","Severity","Likelihood"],showMarkers:!1,showTitle:!1},yAxis:{title:{text:"Severity",position:"center"}},xAxis:{title:{text:"Likelihood",position:"center"}},label:{style:{fontSize:24,fontWeight:500,textAlign:"center",fill:"black"}},color:function(U){var v=U.value;return v<=3?p.q6:v<=7?p.WY:v<=12?p.U1:p.jv}},At=[{title:"Security goal name",dataIndex:"name",key:"name",width:"20%"},{title:"Asset",dataIndex:"asset_id",key:"asset_id",width:"20%",render:function(U){var v;return(v=be.find(function(z){return z.id===U}))===null||v===void 0?void 0:v.name}},{title:"C - I - A",children:[{title:"With countermeasures",children:[{title:"C",dataIndex:"i_c",key:"i_c",align:"center",render:function(U,v){var z=be.find(function(F){return F.id===v.asset_id}),te=z.confidentiality>=(0,h.Zb)(v.confidentiality)-1;return(0,e.jsx)("b",{style:{color:te?p.q6:p.jv},children:v.confidentiality})}},{title:"I",dataIndex:"i_i",key:"i_i",align:"center",render:function(U,v){var z=be.find(function(F){return F.id===v.asset_id}),te=z.integrity>=(0,h.Zb)(v.integrity)-1;return(0,e.jsx)("b",{style:{color:te?p.q6:p.jv},children:v.integrity})}},{title:"A",dataIndex:"i_a",key:"i_a",align:"center",render:function(U,v){var z=be.find(function(F){return F.id===v.asset_id}),te=z.availability>=(0,h.Zb)(v.availability)-1;return(0,e.jsx)("b",{style:{color:te?p.q6:p.jv},children:v.availability})}},{title:"Result",dataIndex:"i_r",key:"i_r",align:"center",render:function(U,v){var z=be.find(function(F){return F.id===v.asset_id}),te=z.confidentiality>=(0,h.Zb)(v.confidentiality)-1&&z.integrity>=(0,h.Zb)(v.integrity)-1&&z.availability>=(0,h.Zb)(v.availability)-1;return te?(0,e.jsx)(re.Z,{style:{color:"green",fontSize:"150%"}}):(0,e.jsx)(E.Z,{style:{color:"red",fontSize:"150%"}})}}]},{title:"Without all countermeasures",children:[{title:"C",dataIndex:"n_c",key:"n_c",align:"center",render:function(U,v){var z=X.find(function(F){return F.id===v.asset_id}),te=z.confidentiality>=(0,h.Zb)(v.confidentiality)-1;return(0,e.jsx)("b",{style:{color:te?p.q6:p.jv},children:v.confidentiality})}},{title:"I",dataIndex:"n_i",key:"n_i",align:"center",render:function(U,v){var z=X.find(function(F){return F.id===v.asset_id}),te=z.integrity>=(0,h.Zb)(v.integrity)-1;return(0,e.jsx)("b",{style:{color:te?p.q6:p.jv},children:v.integrity})}},{title:"A",dataIndex:"n_a",key:"n_a",align:"center",render:function(U,v){var z=X.find(function(F){return F.id===v.asset_id}),te=z.availability>=(0,h.Zb)(v.availability)-1;return(0,e.jsx)("b",{style:{color:te?p.q6:p.jv},children:v.availability})}},{title:"Result",dataIndex:"n_r",key:"n_r",align:"center",render:function(U,v){var z=X.find(function(F){return F.id===v.asset_id}),te=z.confidentiality>=(0,h.Zb)(v.confidentiality)-1&&z.integrity>=(0,h.Zb)(v.integrity)-1&&z.availability>=(0,h.Zb)(v.availability)-1;return te?(0,e.jsx)(re.Z,{style:{color:"green",fontSize:"150%"}}):(0,e.jsx)(E.Z,{style:{color:"red",fontSize:"150%"}})}}]}]}],yt=[{title:"Asset name",dataIndex:"name",key:"name",width:"60%"},{title:"Severity",children:[{title:"With countermeasures",key:"implemented",dataIndex:"implemented",align:"center",width:"20%",render:function(U,v){var z;return(z=be.find(function(te){return te.id===v.id}))===null||z===void 0?void 0:z.severity}},{title:"Without all countermeasures",key:"not_implemented",dataIndex:"not_implemented",align:"center",width:"20%",render:function(U,v){var z;return(z=X.find(function(te){return te.id===v.id}))===null||z===void 0?void 0:z.severity}}]}],Zt=[{title:"Attribute",dataIndex:"attribute",key:"attribute",width:"34%"},{title:"With countermeasures",key:"implemented",dataIndex:"implemented",align:"center",width:"33%",render:function(U,v){return v.attribute=="Risk level"?(0,e.jsx)("b",{style:{color:v.implemented[1]},children:v.implemented[0]}):v.attribute=="Severity"?(0,e.jsx)("b",{style:{color:(0,h.xe)(U)},children:U}):v.attribute=="Likelihood"?(0,e.jsx)("b",{style:{color:(0,h.AC)(U)},children:U}):U}},{title:"Without all countermeasures",key:"not_implemented",dataIndex:"not_implemented",align:"center",width:"33%",render:function(U,v){return v.attribute=="Risk level"?(0,e.jsx)("b",{style:{color:v.not_implemented[1]},children:v.not_implemented[0]}):v.attribute=="Severity"?(0,e.jsx)("b",{style:{color:(0,h.xe)(U)},children:U}):v.attribute=="Likelihood"?(0,e.jsx)("b",{style:{color:(0,h.AC)(U)},children:U}):U}}],$e=function(){var pe=(0,k.Z)(s().mark(function U(v){var z;return s().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return F.next=2,Lt(a,{name:v.name});case 2:if(z=F.sent,!z){F.next=7;break}return Te.default.success("Save done!"),Kt.m8.push("/deployment-scenarios"),F.abrupt("return",!0);case 7:return F.abrupt("return",!1);case 8:case"end":return F.stop()}},U)}));return function(v){return pe.apply(this,arguments)}}(),Qe=function(){we(!0)};return W?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(Ke.Z,{defaultActiveKey:["1","2","3","4"],children:[(0,e.jsxs)(pt,{header:"Risk level",children:[(0,e.jsxs)(l.Z,{gutter:16,children:[(0,e.jsx)(ne.Z,{span:12,children:(0,e.jsx)(l.Z,{children:(0,e.jsxs)(ne.Z,{span:24,children:[(0,e.jsx)("h3",{children:"System profile"}),(0,e.jsx)(Pe.Z,{columns:Zt,dataSource:N,pagination:!1,rowKey:"attribute"})]})})}),(0,e.jsx)(ne.Z,{span:12,children:(0,e.jsx)(O.Z,(0,f.Z)({},Xe))})]}),(0,e.jsxs)(l.Z,{children:[(0,e.jsx)("h3",{children:"Assets"}),(0,e.jsx)(ve.ZP,{columns:yt,dataSource:be,rowKey:"id",search:!1,toolBarRender:!1,pagination:{pageSize:7},style:{width:"100%"},bordered:!0})]})]},"1"),(0,e.jsx)(pt,{header:"Security goals",children:(0,e.jsx)(ve.ZP,{columns:At,dataSource:$,rowKey:"id",search:!1,toolBarRender:!1,bordered:!0})},"2"),(0,e.jsx)(pt,{header:"Countermeasures",children:(0,e.jsx)(K.Z,(0,f.Z)({},ht))},"3")]}),(0,e.jsx)(Bt.Y,{title:"Assessment name",width:"400px",visible:Ze,onVisibleChange:we,modalProps:{destroyOnClose:!0},onFinish:$e,children:(0,e.jsx)(Yt.Z,{name:"name",label:"Name",rules:[{required:!0}]})}),(0,e.jsx)(fe.Z,{style:{position:"fixed",right:50,bottom:50,zIndex:1e3},children:(0,e.jsx)(j.Z,{type:"primary",onClick:Qe,children:"Save"})})]}):(0,e.jsx)(ae.Z,{style:{fontSize:"200%"}})},Jt=Ut,tr=r(71194),Ht=r(50146),nr=r(43358),ge=r(34041),Xt=r(5405),ce=r(98822),$t=r(91321),Qt=(0,$t.Z)({scriptUrl:"https://at.alicdn.com/t/font_1101588_01zniftxm9yp.js"}),jt=Qt,qt=r(66865),_t=r.n(qt),en=function(t){return t.toLowerCase().replace(/( |^)[a-z]/g,function(a){return a.toUpperCase()})},tn=function(t){var a=t.command,c=t.icon,n=t.text;return(0,e.jsx)(ce.mY,{name:a,children:(0,e.jsxs)("div",{className:_t().item,children:[(0,e.jsx)(jt,{type:"icon-".concat(c||a)}),(0,e.jsx)("span",{children:n||en(a)})]})})},je=tn,nn=function(){return(0,e.jsxs)(ce.xV,{className:_t().contextMenu,children:[(0,e.jsxs)(ce.Fn,{children:[(0,e.jsx)(je,{command:"copy"}),(0,e.jsx)(je,{command:"delete"})]}),(0,e.jsx)(ce.ff,{children:(0,e.jsx)(je,{command:"delete"})}),(0,e.jsxs)(ce.Cc,{children:[(0,e.jsx)(je,{command:"copy"}),(0,e.jsx)(je,{command:"delete"}),(0,e.jsx)(je,{command:"unGroup",icon:"ungroup",text:"Ungroup"})]}),(0,e.jsxs)(ce.eA,{children:[(0,e.jsx)(je,{command:"copy"}),(0,e.jsx)(je,{command:"paste"}),(0,e.jsx)(je,{command:"addGroup",icon:"group",text:"Add Group"}),(0,e.jsx)(je,{command:"delete"})]}),(0,e.jsxs)(ce.Tr,{children:[(0,e.jsx)(je,{command:"undo"}),(0,e.jsx)(je,{command:"redo"}),(0,e.jsx)(je,{command:"pasteHere",icon:"paste",text:"Paste Here"})]})]})},rn=nn,Be=r(32059),mt=r(69610),vt=r(54941),gt=r(81306),It=r(19809),rr=r(9715),ke=r(17681),ar=r(402),Ye=r(97272),ir=r(87445),an=Ye.Z.Paragraph,wt=function(t){return t.toLowerCase().replace(/( |^)[a-z]/g,function(a){return a.toUpperCase()})},Ue=ke.Z.Item,sr=ge.Z.Option,or={labelCol:{sm:{span:8}},wrapperCol:{sm:{span:16}}},sn=function(g){(0,gt.Z)(a,g);var t=(0,It.Z)(a);function a(c){var n;return(0,mt.Z)(this,a),n=t.call(this,c),n.getAssets=function(i){var o=n.props.cves.find(function(b){return b.asset_id==i});return o?o.asset_name:""},n.getDescription=function(i,o){var b,S=n.props.cves.find(function(W){return W.asset_id==i}),D=S==null||(b=S.cves)===null||b===void 0?void 0:b.find(function(W){return W.cve_id===o});return D?D.description:""},n.handleFieldChange=function(i){var o=n.props.propsAPI,b=o.getSelected,S=o.executeCommand,D=o.update;setTimeout(function(){var W=b()[0];!W||S(function(){D(W,(0,f.Z)({},i))})},0)},n.handleInputBlur=function(i){return function(o){o.preventDefault(),n.handleFieldChange((0,Be.Z)({},i,o.currentTarget.value))}},n.handleInputChange=function(i){var o=i.split("_"),b=o[1],S=o[0];n.handleFieldChange({label:b,cve_id:b,asset_id:S}),n.setState((0,f.Z)((0,f.Z)({},n.state),{},{assets:n.getAssets(S),description:n.getDescription(S,b)})),n.handleFieldChange({label:b,cve_id:b,asset_id:S})},n.handleAttackerInputChange=function(i){var o,b=i;n.handleFieldChange({label:(o=n.props.attackers.find(function(S){return S.id===b}))===null||o===void 0?void 0:o.name,attacker_id:b})},n.componentDidMount=function(){var i=n.item?n.item.getModel():"",o=i.label,b=i.is_attacker,S=i.cve_id,D=i.asset_id;b||n.setState((0,f.Z)((0,f.Z)({},n.state),{},{assets:n.getAssets(D),description:n.getDescription(D,S)}))},n.renderNodeDetail=function(){var i=n.item.getModel(),o=i.label,b=i.is_attacker,S=i.cve_id,D=i.asset_id,W=i.attacker_id;return b?(0,e.jsx)(ke.Z,{initialValues:{label:W||"Select threat"},layout:"vertical",children:(0,e.jsx)(Ue,{label:(0,e.jsx)("b",{children:"Threat"}),name:"label",children:(0,e.jsx)(ge.Z,{showSearch:!0,placeholder:"CVE",optionFilterProp:"children",onChange:n.handleAttackerInputChange,name:"label",children:n.props.attackers.map(function(w){return(0,e.jsx)(ge.Z.Option,{value:"".concat(w.id),children:w.name},"".concat(w.id))})})})}):(0,e.jsxs)(ke.Z,{initialValues:{label:D?"".concat(D,"_").concat(S):"Select CVE"},layout:"vertical",children:[(0,e.jsx)(Ue,{label:(0,e.jsx)("b",{children:"CVE"}),name:"label",children:(0,e.jsx)(ge.Z,{showSearch:!0,placeholder:"CVE",optionFilterProp:"children",onChange:n.handleInputChange,name:"label",children:n.props.cves.map(function(w){return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(ge.Z.OptGroup,{label:"".concat(w.asset_name),children:w.cves.map(function(P){return(0,e.jsx)(ge.Z.Option,{value:"".concat(w.asset_id,"_").concat(P.cve_id),children:P.cve_id},"".concat(w.asset_id,"_").concat(P.cve_id))})},"".concat(w.asset_id))})})})}),(0,e.jsx)(Ue,{label:(0,e.jsx)("b",{children:"Asset"}),children:n.state.assets}),(0,e.jsx)(Ue,{label:(0,e.jsx)("b",{children:"Description"}),children:(0,e.jsx)(an,{ellipsis:{tooltip:n.state.description,rows:5},children:n.state.description})})]})},n.state={assets:"",description:""},n}return(0,vt.Z)(a,[{key:"item",get:function(){var n=this.props.propsAPI;return n==null?void 0:n.getSelected()[0]}},{key:"render",value:function(){var n=this.props.type;return this.item?wt(n)==="edge"?(this.saveModel(),null):(0,e.jsx)(H.Z,{type:"inner",size:"small",title:wt(n),bordered:!1,children:n==="node"&&this.renderNodeDetail()}):null}}]),a}(m.Component),on=(0,ce.Yn)(sn),ln=r(39185),un=r.n(ln),cn=function(t){var a=t.cves,c=t.setDataGraph,n=t.attackers;return(0,e.jsx)(ce.JF,{className:un().detailPanel,children:(0,e.jsx)(ce.Kk,{children:(0,e.jsx)(on,{type:"node",cves:a,setDataGraph:c,attackers:n})})})},dn=cn,pn=r(23749),mn=r.n(pn),vn=function(){return(0,e.jsx)(ce.qZ,{className:mn().itemPanel,children:(0,e.jsxs)(H.Z,{bordered:!1,children:[(0,e.jsx)(ce.ck,{type:"node",size:"72*72",shape:"flow-circle",model:{color:"#FA8C16",label:"Threat",is_attacker:!0},src:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjxzdmcKICAgd2lkdGg9IjgwIgogICBoZWlnaHQ9IjgwIgogICB2ZXJzaW9uPSIxLjEiCiAgIGlkPSJzdmcyOCIKICAgc29kaXBvZGk6ZG9jbmFtZT0iYXR0YWNrLnN2ZyIKICAgaW5rc2NhcGU6dmVyc2lvbj0iMS4xLjIgKDE6MS4xKzIwMjIwMjA1MDk1MCswYTAwY2Y1MzM5KSIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiCiAgIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIKICAgeG1sbnM6c3ZnPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CiAgPHNvZGlwb2RpOm5hbWVkdmlldwogICAgIGlkPSJuYW1lZHZpZXczMCIKICAgICBwYWdlY29sb3I9IiNmZmZmZmYiCiAgICAgYm9yZGVyY29sb3I9IiM2NjY2NjYiCiAgICAgYm9yZGVyb3BhY2l0eT0iMS4wIgogICAgIGlua3NjYXBlOnBhZ2VzaGFkb3c9IjIiCiAgICAgaW5rc2NhcGU6cGFnZW9wYWNpdHk9IjAuMCIKICAgICBpbmtzY2FwZTpwYWdlY2hlY2tlcmJvYXJkPSIwIgogICAgIHNob3dncmlkPSJmYWxzZSIKICAgICBpbmtzY2FwZTp6b29tPSI2LjM4NzUiCiAgICAgaW5rc2NhcGU6Y3g9IjU0LjI0NjU3NSIKICAgICBpbmtzY2FwZTpjeT0iNDYuNjUzNjIiCiAgICAgaW5rc2NhcGU6d2luZG93LXdpZHRoPSIxMzEwIgogICAgIGlua3NjYXBlOndpbmRvdy1oZWlnaHQ9IjcwNCIKICAgICBpbmtzY2FwZTp3aW5kb3cteD0iNTYiCiAgICAgaW5rc2NhcGU6d2luZG93LXk9IjI3IgogICAgIGlua3NjYXBlOndpbmRvdy1tYXhpbWl6ZWQ9IjEiCiAgICAgaW5rc2NhcGU6Y3VycmVudC1sYXllcj0iZzI2IiAvPgogIDxkZWZzCiAgICAgaWQ9ImRlZnMxMiI+CiAgICA8Y2lyY2xlCiAgICAgICBpZD0iYiIKICAgICAgIGN4PSIzNiIKICAgICAgIGN5PSIzNiIKICAgICAgIHI9IjM2IiAvPgogICAgPGZpbHRlcgogICAgICAgeD0iLTAuMDY2NjY2NjY3IgogICAgICAgeT0iLTAuMDY2NjY2NjY3IgogICAgICAgd2lkdGg9IjEuMTMzMzMzMyIKICAgICAgIGhlaWdodD0iMS4xNjExMTExIgogICAgICAgZmlsdGVyVW5pdHM9Im9iamVjdEJvdW5kaW5nQm94IgogICAgICAgaWQ9ImEiPgogICAgICA8ZmVPZmZzZXQKICAgICAgICAgZHk9IjIiCiAgICAgICAgIGluPSJTb3VyY2VBbHBoYSIKICAgICAgICAgcmVzdWx0PSJzaGFkb3dPZmZzZXRPdXRlcjEiCiAgICAgICAgIGlkPSJmZU9mZnNldDMiIC8+CiAgICAgIDxmZUdhdXNzaWFuQmx1cgogICAgICAgICBzdGREZXZpYXRpb249IjIiCiAgICAgICAgIGluPSJzaGFkb3dPZmZzZXRPdXRlcjEiCiAgICAgICAgIHJlc3VsdD0ic2hhZG93Qmx1ck91dGVyMSIKICAgICAgICAgaWQ9ImZlR2F1c3NpYW5CbHVyNSIgLz4KICAgICAgPGZlQ29tcG9zaXRlCiAgICAgICAgIGluPSJzaGFkb3dCbHVyT3V0ZXIxIgogICAgICAgICBpbjI9IlNvdXJjZUFscGhhIgogICAgICAgICBvcGVyYXRvcj0ib3V0IgogICAgICAgICByZXN1bHQ9InNoYWRvd0JsdXJPdXRlcjEiCiAgICAgICAgIGlkPSJmZUNvbXBvc2l0ZTciIC8+CiAgICAgIDxmZUNvbG9yTWF0cml4CiAgICAgICAgIHZhbHVlcz0iMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMC4wNCAwIgogICAgICAgICBpbj0ic2hhZG93Qmx1ck91dGVyMSIKICAgICAgICAgaWQ9ImZlQ29sb3JNYXRyaXg5IiAvPgogICAgPC9maWx0ZXI+CiAgPC9kZWZzPgogIDxnCiAgICAgZmlsbD0ibm9uZSIKICAgICBmaWxsLXJ1bGU9ImV2ZW5vZGQiCiAgICAgaWQ9ImcyNiI+CiAgICA8ZwogICAgICAgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNCAyKSIKICAgICAgIGlkPSJnMjAiPgogICAgICA8dXNlCiAgICAgICAgIGZpbGw9IiMwMDAiCiAgICAgICAgIGZpbHRlcj0idXJsKCNhKSIKICAgICAgICAgeGxpbms6aHJlZj0iI2IiCiAgICAgICAgIGlkPSJ1c2UxNCIgLz4KICAgICAgPHVzZQogICAgICAgICBmaWxsLW9wYWNpdHk9Ii45MiIKICAgICAgICAgZmlsbD0iI0ZGRjJFOCIKICAgICAgICAgeGxpbms6aHJlZj0iI2IiCiAgICAgICAgIGlkPSJ1c2UxNiIgLz4KICAgICAgPGNpcmNsZQogICAgICAgICBzdHJva2U9IiNGRkMwNjkiCiAgICAgICAgIGN4PSIzNiIKICAgICAgICAgY3k9IjM2IgogICAgICAgICByPSIzNS41IgogICAgICAgICBpZD0iY2lyY2xlMTgiIC8+CiAgICA8L2c+CiAgICA8dGV4dAogICAgICAgZm9udC1mYW1pbHk9IlBpbmdGYW5nU0MtUmVndWxhciwgJ1BpbmdGYW5nIFNDJyIKICAgICAgIGZvbnQtc2l6ZT0iMTJweCIKICAgICAgIGZpbGw9IiMwMDAwMDAiCiAgICAgICBmaWxsLW9wYWNpdHk9IjAuNjUiCiAgICAgICBpZD0idGV4dDI0IgogICAgICAgeD0iLTIuMjc5MTYyOSIKICAgICAgIHk9IjIuOTk4MTI5MSI+PHRzcGFuCiAgICAgICAgIHg9IjIwLjcyMDgzOSIKICAgICAgICAgeT0iNDMuOTk4MTMxIgogICAgICAgICBpZD0idHNwYW4yMiI+VGhyZWF0PC90c3Bhbj48L3RleHQ+CiAgPC9nPgo8L3N2Zz4K"}),(0,e.jsx)(ce.ck,{type:"node",size:"100*48",shape:"flow-capsule",model:{color:"#722ED1",label:"CVE",is_attacker:!1},src:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjxzdmcKICAgd2lkdGg9Ijg4IgogICBoZWlnaHQ9IjU2IgogICB2ZXJzaW9uPSIxLjEiCiAgIGlkPSJzdmcyOCIKICAgc29kaXBvZGk6ZG9jbmFtZT0iY3ZlLnN2ZyIKICAgaW5rc2NhcGU6dmVyc2lvbj0iMS4xLjIgKDE6MS4xKzIwMjIwMjA1MDk1MCswYTAwY2Y1MzM5KSIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiCiAgIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIKICAgeG1sbnM6c3ZnPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CiAgPHNvZGlwb2RpOm5hbWVkdmlldwogICAgIGlkPSJuYW1lZHZpZXczMCIKICAgICBwYWdlY29sb3I9IiNmZmZmZmYiCiAgICAgYm9yZGVyY29sb3I9IiM2NjY2NjYiCiAgICAgYm9yZGVyb3BhY2l0eT0iMS4wIgogICAgIGlua3NjYXBlOnBhZ2VzaGFkb3c9IjIiCiAgICAgaW5rc2NhcGU6cGFnZW9wYWNpdHk9IjAuMCIKICAgICBpbmtzY2FwZTpwYWdlY2hlY2tlcmJvYXJkPSIwIgogICAgIHNob3dncmlkPSJmYWxzZSIKICAgICBpbmtzY2FwZTp6b29tPSI5LjEyNSIKICAgICBpbmtzY2FwZTpjeD0iNjUuNjk4NjMiCiAgICAgaW5rc2NhcGU6Y3k9IjI4LjA1NDc5NSIKICAgICBpbmtzY2FwZTp3aW5kb3ctd2lkdGg9IjEzMTAiCiAgICAgaW5rc2NhcGU6d2luZG93LWhlaWdodD0iNzA0IgogICAgIGlua3NjYXBlOndpbmRvdy14PSI1NiIKICAgICBpbmtzY2FwZTp3aW5kb3cteT0iMjciCiAgICAgaW5rc2NhcGU6d2luZG93LW1heGltaXplZD0iMSIKICAgICBpbmtzY2FwZTpjdXJyZW50LWxheWVyPSJnMjYiIC8+CiAgPGRlZnMKICAgICBpZD0iZGVmczEyIj4KICAgIDxyZWN0CiAgICAgICBpZD0iYiIKICAgICAgIHg9IjAiCiAgICAgICB5PSIwIgogICAgICAgd2lkdGg9IjgwIgogICAgICAgaGVpZ2h0PSI0OCIKICAgICAgIHJ4PSIyNCIgLz4KICAgIDxmaWx0ZXIKICAgICAgIHg9Ii0wLjA2IgogICAgICAgeT0iLTAuMSIKICAgICAgIHdpZHRoPSIxLjEyIgogICAgICAgaGVpZ2h0PSIxLjI0MTY2NjciCiAgICAgICBmaWx0ZXJVbml0cz0ib2JqZWN0Qm91bmRpbmdCb3giCiAgICAgICBpZD0iYSI+CiAgICAgIDxmZU9mZnNldAogICAgICAgICBkeT0iMiIKICAgICAgICAgaW49IlNvdXJjZUFscGhhIgogICAgICAgICByZXN1bHQ9InNoYWRvd09mZnNldE91dGVyMSIKICAgICAgICAgaWQ9ImZlT2Zmc2V0MyIgLz4KICAgICAgPGZlR2F1c3NpYW5CbHVyCiAgICAgICAgIHN0ZERldmlhdGlvbj0iMiIKICAgICAgICAgaW49InNoYWRvd09mZnNldE91dGVyMSIKICAgICAgICAgcmVzdWx0PSJzaGFkb3dCbHVyT3V0ZXIxIgogICAgICAgICBpZD0iZmVHYXVzc2lhbkJsdXI1IiAvPgogICAgICA8ZmVDb21wb3NpdGUKICAgICAgICAgaW49InNoYWRvd0JsdXJPdXRlcjEiCiAgICAgICAgIGluMj0iU291cmNlQWxwaGEiCiAgICAgICAgIG9wZXJhdG9yPSJvdXQiCiAgICAgICAgIHJlc3VsdD0ic2hhZG93Qmx1ck91dGVyMSIKICAgICAgICAgaWQ9ImZlQ29tcG9zaXRlNyIgLz4KICAgICAgPGZlQ29sb3JNYXRyaXgKICAgICAgICAgdmFsdWVzPSIwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwLjA0IDAiCiAgICAgICAgIGluPSJzaGFkb3dCbHVyT3V0ZXIxIgogICAgICAgICBpZD0iZmVDb2xvck1hdHJpeDkiIC8+CiAgICA8L2ZpbHRlcj4KICA8L2RlZnM+CiAgPGcKICAgICBmaWxsPSJub25lIgogICAgIGZpbGwtcnVsZT0iZXZlbm9kZCIKICAgICBpZD0iZzI2Ij4KICAgIDxnCiAgICAgICB0cmFuc2Zvcm09InRyYW5zbGF0ZSg0IDIpIgogICAgICAgaWQ9ImcyMCI+CiAgICAgIDx1c2UKICAgICAgICAgZmlsbD0iIzAwMCIKICAgICAgICAgZmlsdGVyPSJ1cmwoI2EpIgogICAgICAgICB4bGluazpocmVmPSIjYiIKICAgICAgICAgaWQ9InVzZTE0IiAvPgogICAgICA8dXNlCiAgICAgICAgIGZpbGwtb3BhY2l0eT0iLjkyIgogICAgICAgICBmaWxsPSIjRjlGMEZGIgogICAgICAgICB4bGluazpocmVmPSIjYiIKICAgICAgICAgaWQ9InVzZTE2IiAvPgogICAgICA8cmVjdAogICAgICAgICBzdHJva2U9IiNCMzdGRUIiCiAgICAgICAgIHg9Ii41IgogICAgICAgICB5PSIuNSIKICAgICAgICAgd2lkdGg9Ijc5IgogICAgICAgICBoZWlnaHQ9IjQ3IgogICAgICAgICByeD0iMjMuNSIKICAgICAgICAgaWQ9InJlY3QxOCIgLz4KICAgIDwvZz4KICAgIDx0ZXh0CiAgICAgICBmb250LWZhbWlseT0iUGluZ0ZhbmdTQy1SZWd1bGFyLCAnUGluZ0ZhbmcgU0MnIgogICAgICAgZm9udC1zaXplPSIxMnB4IgogICAgICAgZmlsbD0iIzAwMDAwMCIKICAgICAgIGZpbGwtb3BhY2l0eT0iMC42NSIKICAgICAgIGlkPSJ0ZXh0MjQiCiAgICAgICB4PSI3LjUxNDIzMDMiCiAgICAgICB5PSIwLjg5NzU2Nzk5Ij48dHNwYW4KICAgICAgICAgeD0iMzEuNTE0MjMxIgogICAgICAgICB5PSIyOS44OTc1NjgiCiAgICAgICAgIGlkPSJ0c3BhbjIyIj5DVkU8L3RzcGFuPjwvdGV4dD4KICA8L2c+Cjwvc3ZnPgo="})]})})},gn=vn,lr=function(){return _jsx(_Card,{type:"inner",size:"small",title:"Minimap",bordered:!1,children:_jsx(Minimap,{height:200})})},ur=null,cr=r(48736),Ct=r(27049),In=r(30722),Pt=r.n(In),dr=r(22385),Cn=r(61580),fn=function(t){return t.toLowerCase().replace(/( |^)[a-z]/g,function(a){return a.toUpperCase()})},hn=function(t){var a=t.command,c=t.icon,n=t.text;return(0,e.jsx)(ce.mY,{name:a,children:(0,e.jsx)(Cn.Z,{title:n||fn(a),placement:"bottom",overlayClassName:Pt().tooltip,children:(0,e.jsx)(jt,{type:"icon-".concat(c||a)})})})},Ne=hn,An=function(){return(0,e.jsxs)(ce.o8,{className:Pt().toolbar,children:[(0,e.jsx)(Ne,{command:"undo"}),(0,e.jsx)(Ne,{command:"redo"}),(0,e.jsx)(Ct.Z,{type:"vertical"}),(0,e.jsx)(Ne,{command:"copy"}),(0,e.jsx)(Ne,{command:"paste"}),(0,e.jsx)(Ne,{command:"delete"}),(0,e.jsx)(Ct.Z,{type:"vertical"}),(0,e.jsx)(Ne,{command:"zoomIn",icon:"zoom-in",text:"Zoom In"}),(0,e.jsx)(Ne,{command:"zoomOut",icon:"zoom-out",text:"Zoom Out"}),(0,e.jsx)(Ne,{command:"autoZoom",icon:"fit-map",text:"Fit Map"}),(0,e.jsx)(Ne,{command:"resetZoom",icon:"actual-size",text:"Actual Size"}),(0,e.jsx)(Ct.Z,{type:"vertical"})]})},yn=An,pr=r(13525),Zn=r(20532),Tt=r.n(Zn),xn=function(g){(0,gt.Z)(a,g);var t=(0,It.Z)(a);function a(c){var n;return(0,mt.Z)(this,a),n=t.call(this,c),n.state={data:n.props.data},n}return(0,vt.Z)(a,[{key:"componentDidUpdate",value:function(){this.props.propsAPI.executeCommand("autoZoom")}},{key:"componentDidMount",value:function(){this.props.propsAPI.executeCommand("autoZoom"),localStorage.setItem("CVES",JSON.stringify(this.props.cves)),localStorage.setItem("THREATS",JSON.stringify(this.props.attackers))}},{key:"render",value:function(){var n=this;return(0,e.jsx)(ce.Zw,{className:this.props.className,data:this.props.data,onAfterChange:function(){var o=JSON.stringify(n.props.propsAPI.save());localStorage.setItem(p.QG,o),n.setState({data:o})},graph:{plugins:[new(Tt()).Plugins["tool.tooltip"]({getTooltip:function(o){var b=o.item;try{if(b){var S=b.getModel();if(S!=null&&S.source&&S!==null&&S!==void 0&&S.target){var D,W,w,P,I=JSON.parse(localStorage.getItem(p.QG)),N=JSON.parse(localStorage.getItem("CVES")),V=JSON.parse(localStorage.getItem("THREATS")),u=S.source,x=S.target;u=I==null||(D=I.nodes)===null||D===void 0?void 0:D.find(function(d){return d.id===u}),x=I==null||(W=I.nodes)===null||W===void 0?void 0:W.find(function(d){return d.id===x});var A=(w=N.find(function(d){var G;return d.asset_id===((G=x)===null||G===void 0?void 0:G.asset_id)}))===null||w===void 0||(P=w.cves)===null||P===void 0?void 0:P.find(function(d){var G;return d.cve_id===((G=x)===null||G===void 0?void 0:G.cve_id)});if(u.is_attacker){u=V.find(function(d){return d.id===u.attacker_id});var y=u.targets.find(function(d){return d.asset_id==x.asset_id});return u.attack_vector=(y==null?void 0:y.attack_vector)||"N/A",u.privilege=(y==null?void 0:y.privilege)||"N/A",`
                                                    <div class="tooltip-ag">
                                                        <h4>`.concat(u.name,`</h4>
                                                        <ul>
                                                            <li>Attack vector: `).concat((y==null?void 0:y.attack_vector)||"N/A",`</li>
                                                            <li>Privilege: `).concat((y==null?void 0:y.privilege)||"N/A",`</li>
                                                        </ul>
                                                        <h4>`).concat(A.cve_id,`</h4>
                                                        <ul>
                                                            <li>Attack vector: `).concat(A.attack_vector,`</li>
                                                            <li>Prerequisite: `).concat(A.condition.preCondition,`</li>
                                                            <li>Post condition: `).concat(A.condition.postCondition,`</li>
                                                        </ul>
                                                    </div>
                                                `)}else{var R,C;return u=(R=N.find(function(d){var G;return d.asset_id===((G=u)===null||G===void 0?void 0:G.asset_id)}))===null||R===void 0||(C=R.cves)===null||C===void 0?void 0:C.find(function(d){var G;return d.cve_id===((G=u)===null||G===void 0?void 0:G.cve_id)}),`
                                                    <div class="tooltip-ag">
                                                        <h4>`.concat(u.cve_id,`</h4>
                                                        <ul>
                                                            <li>Attack vector: `).concat(u.attack_vector,`</li>
                                                            <li>Prerequisite: `).concat(u.condition.preCondition,`</li>
                                                            <li>Post condition: `).concat(u.condition.postCondition,`</li>
                                                        </ul>
                                                        <h4>`).concat(A.cve_id,`</h4>
                                                        <ul>
                                                            <li>Attack vector: `).concat(A.attack_vector,`</li>
                                                            <li>Prerequisite: `).concat(A.condition.preCondition,`</li>
                                                            <li>Post condition: `).concat(A.condition.postCondition,`</li>
                                                        </ul>
                                                    </div>
                                                `)}}}}catch(d){return""}}})]}})}}]),a}(m.Component),bn=(0,ce.Yn)(xn),Sn=function(g){(0,gt.Z)(a,g);var t=(0,It.Z)(a);function a(c){var n;return(0,mt.Z)(this,a),n=t.call(this,c),n.state={data:n.props.data},n}return(0,vt.Z)(a,[{key:"componentDidUpdate",value:function(){this.props.propsAPI.executeCommand("autoZoom")}},{key:"componentDidMount",value:function(){this.props.propsAPI.executeCommand("autoZoom"),localStorage.setItem("CVES",JSON.stringify(this.props.cves)),localStorage.setItem("THREATS",JSON.stringify(this.props.attackers))}},{key:"render",value:function(){var n=this;return(0,e.jsx)(ce.Zw,{className:this.props.className,data:this.props.data,onAfterChange:function(){var o=JSON.stringify(n.props.propsAPI.save());localStorage.setItem(p.QG,o),n.setState({data:o})},graph:{plugins:[new(Tt()).Plugins["tool.tooltip"]({getTooltip:function(o){var b=o.item;try{if(b){var S=b.getModel();if(S!=null&&S.source&&S!==null&&S!==void 0&&S.target){var D,W,w,P,I=JSON.parse(localStorage.getItem(p.QG)),N=JSON.parse(localStorage.getItem("CVES")),V=JSON.parse(localStorage.getItem("THREATS")),u=S.source,x=S.target;u=I==null||(D=I.nodes)===null||D===void 0?void 0:D.find(function(d){return d.id===u}),x=I==null||(W=I.nodes)===null||W===void 0?void 0:W.find(function(d){return d.id===x});var A=(w=N.find(function(d){var G;return d.asset_id===((G=x)===null||G===void 0?void 0:G.asset_id)}))===null||w===void 0||(P=w.cves)===null||P===void 0?void 0:P.find(function(d){var G;return d.cve_id===((G=x)===null||G===void 0?void 0:G.cve_id)});if(u.is_attacker){u=V.find(function(d){return d.id===u.attacker_id});var y=u.targets.find(function(d){return d.asset_id==x.asset_id});return u.attack_vector=(y==null?void 0:y.attack_vector)||"N/A",u.privilege=(y==null?void 0:y.privilege)||"N/A",`
                                                    <div class="tooltip-ag">
                                                        <h4>`.concat(u.name,`</h4>
                                                        <ul>
                                                            <li>Attack vector: `).concat((y==null?void 0:y.attack_vector)||"N/A",`</li>
                                                            <li>Privilege: `).concat((y==null?void 0:y.privilege)||"N/A",`</li>
                                                        </ul>
                                                        <h4>`).concat(A.cve_id,`</h4>
                                                        <ul>
                                                            <li>Attack vector: `).concat(A.attack_vector,`</li>
                                                            <li>Prerequisite: `).concat(A.condition.preCondition,`</li>
                                                            <li>Post condition: `).concat(A.condition.postCondition,`</li>
                                                        </ul>
                                                    </div>
                                                `)}else{var R,C;return u=(R=N.find(function(d){var G;return d.asset_id===((G=u)===null||G===void 0?void 0:G.asset_id)}))===null||R===void 0||(C=R.cves)===null||C===void 0?void 0:C.find(function(d){var G;return d.cve_id===((G=u)===null||G===void 0?void 0:G.cve_id)}),`
                                                    <div class="tooltip-ag">
                                                        <h4>`.concat(u.cve_id,`</h4>
                                                        <ul>
                                                            <li>Attack vector: `).concat(u.attack_vector,`</li>
                                                            <li>Prerequisite: `).concat(u.condition.preCondition,`</li>
                                                            <li>Post condition: `).concat(u.condition.postCondition,`</li>
                                                        </ul>
                                                        <h4>`).concat(A.cve_id,`</h4>
                                                        <ul>
                                                            <li>Attack vector: `).concat(A.attack_vector,`</li>
                                                            <li>Prerequisite: `).concat(A.condition.preCondition,`</li>
                                                            <li>Post condition: `).concat(A.condition.postCondition,`</li>
                                                        </ul>
                                                    </div>
                                                `)}}}}catch(d){return""}}})]}})}}]),a}(m.Component),mr=(0,ce.Yn)(Sn),jn=r(30802),Oe=r.n(jn);function _n(g,t,a){return ft.apply(this,arguments)}function ft(){return ft=(0,k.Z)(s().mark(function g(t,a,c){return s().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(0,Ge.ZP)("/api/deployment_scenarios/".concat(t,"/attack_graph"),(0,f.Z)({method:"POST",headers:{"Content-Type":"application/json"},data:a},c||{})));case 1:case"end":return i.stop()}},g)})),ft.apply(this,arguments)}ce.ZP.setTrackable(!1);var wn=function(t){var a=t.deployment_scenario_id,c=(0,m.useState)(!1),n=(0,T.Z)(c,2),i=n[0],o=n[1],b=(0,m.useState)(""),S=(0,T.Z)(b,2),D=S[0],W=S[1],w=(0,m.useState)({nodes:[],edges:[]}),P=(0,T.Z)(w,2),I=P[0],N=P[1],V=(0,m.useState)([]),u=(0,T.Z)(V,2),x=u[0],A=u[1],R=(0,m.useState)([]),C=(0,T.Z)(R,2),y=C[0],d=C[1],G=(0,m.useState)(!1),De=(0,T.Z)(G,2),xe=De[0],be=De[1];(0,m.useEffect)(function(){var L=function(){var X=(0,k.Z)(s().mark(function ee(){var q,he,$,se,_e;return s().wrap(function(Ze){for(;;)switch(Ze.prev=Ze.next){case 0:return o(!0),Ze.next=3,Wt(a);case 3:q=Ze.sent,q&&(N(q.attack_graph),A(q.cves),d(q.attackers),$=(he=q.cves)===null||he===void 0?void 0:he.find(function(we){var Re;return we==null||(Re=we.cves)===null||Re===void 0?void 0:Re.length}),se="",$?se="".concat($==null?void 0:$.asset_id,"_").concat($==null||(_e=$.cves[0])===null||_e===void 0?void 0:_e.cve_id):se="Not found CVE",W(se),localStorage.setItem(p.QG,JSON.stringify(q.attack_graph))),o(!1);case 6:case"end":return Ze.stop()}},ee)}));return function(){return X.apply(this,arguments)}}();L()},[a]);var Ae=function(){var L=(0,k.Z)(s().mark(function X(){var ee,q,he,$,se;return s().wrap(function(ye){for(;;)switch(ye.prev=ye.next){case 0:if(q=JSON.parse(localStorage.getItem(p.QG)),N(q),he={asset_id:D.split("_")[0],cve_id:D.split("_")[1]},$=!1,q==null||(ee=q.nodes)===null||ee===void 0||ee.forEach(function(Ze){Ze.cve_id==he.cve_id&&Ze.asset_id==he.asset_id&&($=!0)}),!$){ye.next=12;break}return ye.next=8,_n(a,{attack_graph:q,target:he});case 8:se=ye.sent,se&&Te.default.success("Save done!"),ye.next=13;break;case 12:Te.default.error("Please select target is CVE in attack graph!");case 13:case"end":return ye.stop()}},X)}));return function(){return L.apply(this,arguments)}}(),ie=function(X){W(X)};return i?(0,e.jsx)(ae.Z,{style:{fontSize:25}}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(l.Z,{style:{marginBottom:15},children:[(0,e.jsx)(ne.Z,{span:2,children:"Target"}),(0,e.jsx)(ne.Z,{span:20,children:(0,e.jsx)(ge.Z,{style:{minWidth:"400"},value:D,onChange:ie,showSearch:!0,children:x.map(function(L){return(0,e.jsx)(ge.Z.OptGroup,{label:L.asset_name,children:L.cves.map(function(X){return(0,e.jsx)(ge.Z.Option,{value:"".concat(L.asset_id,"_").concat(X.cve_id),children:"".concat(X.cve_id," on ").concat(L.asset_name)},"".concat(L.asset_id,"_").concat(X.cve_id))})},L.asset_name)})})}),(0,e.jsx)(ne.Z,{span:2,children:(0,e.jsx)(Xt.Z,{style:{fontSize:"200%"},onClick:function(){return be(!xe)}})})]}),(0,e.jsxs)(ce.ZP,{className:Oe().editor,children:[(0,e.jsx)(l.Z,{className:Oe().editorHd,children:(0,e.jsx)(ne.Z,{span:24,children:(0,e.jsx)(yn,{})})}),(0,e.jsxs)(l.Z,{className:Oe().editorBd,children:[(0,e.jsx)(ne.Z,{span:3,className:Oe().editorSidebar,children:(0,e.jsx)(gn,{})}),(0,e.jsx)(ne.Z,{span:16,className:Oe().editorContent,children:(0,e.jsx)(bn,{className:Oe().flow,data:I,cves:x,attackers:y})}),(0,e.jsx)(ne.Z,{span:5,className:Oe().editorSidebar,children:(0,e.jsx)(dn,{cves:x,setDataGraph:N,attackers:y})})]}),(0,e.jsx)(rn,{})]}),(0,e.jsx)(Ht.Z,{title:"Attack graph info",destroyOnClose:!0,wrapClassName:"modal-fullscreen",visible:xe,onOk:function(){return be(!1)},onCancel:function(){return be(!1)},children:(0,e.jsx)(Pe.Z,{columns:[{title:"Asset",dataIndex:"asset_name"}],rowKey:"asset_name",dataSource:x,scroll:{y:350},expandable:{expandedRowRender:function(X){return(0,e.jsx)(Pe.Z,{columns:[{title:"CVE ID",dataIndex:"cve_id"},{title:"Attack Vector",dataIndex:"attack_vector"},{title:"Prerequisite",dataIndex:"condition",render:function(q){return q.preCondition}},{title:"Postcondition",dataIndex:"condition",render:function(q){return q.postCondition}},{title:"In Attack Graph",dataIndex:"cve_id",render:function(q){var he=JSON.parse(localStorage.getItem(p.QG));return he=he.nodes.filter(function($){return!$.is_attacker&&($==null?void 0:$.asset_id)===X.asset_id}).map(function($){return $.cve_id}),he.includes(q)?"\u2705":"\u274C"}}],dataSource:X.cves})}}})}),(0,e.jsx)(fe.Z,{style:{position:"fixed",right:50,bottom:50,zIndex:1e3},children:(0,e.jsx)(j.Z,{type:"primary",onClick:Ae,children:"Save"})})]})},Pn=wn,Gt=r(86582),vr=r(47673),Je=r(4107),He=r(93224),Mt=m.createContext(null),gr=Ye.Z.Paragraph,Tn=function(t){var a=t.index,c=(0,He.Z)(t,["index"]),n=ke.Z.useForm(),i=(0,T.Z)(n,1),o=i[0];return(0,e.jsx)(ke.Z,{form:o,component:!1,children:(0,e.jsx)(Mt.Provider,{value:o,children:(0,e.jsx)("tr",(0,f.Z)({},c))})})},Gn=function(t){var a=t.title,c=t.editable,n=t.children,i=t.dataIndex,o=t.record,b=t.handleSave,S=(0,He.Z)(t,["title","editable","children","dataIndex","record","handleSave"]),D=(0,m.useState)(!1),W=(0,T.Z)(D,2),w=W[0],P=W[1],I=(0,m.useRef)(null),N=(0,m.useContext)(Mt);(0,m.useEffect)(function(){w&&I.current.focus()},[w]);var V=function(){P(!w),N.setFieldsValue((0,Be.Z)({},i,o[i]))},u=function(){var A=(0,k.Z)(s().mark(function R(){var C;return s().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.prev=0,d.next=3,N.validateFields();case 3:C=d.sent,V(),b((0,f.Z)((0,f.Z)({},o),C)),d.next=11;break;case 8:d.prev=8,d.t0=d.catch(0),console.log("Save failed:",d.t0);case 11:case"end":return d.stop()}},R,null,[[0,8]])}));return function(){return A.apply(this,arguments)}}(),x=n;return c&&(x=w?(0,e.jsx)(ke.Z.Item,{style:{margin:0},name:i,rules:[{required:!0,message:"".concat(a," is required.")},{validator:function(R,C){if(!C)return Promise.reject();if(isNaN(C))return Promise.reject("".concat(a," has to be a number."));var y=parseFloat(C);if(a==="Coverage"){if(y>1||y<0)return Promise.reject("".concat(a," between 0 and 1."));if(a==="Cost"&&y<0)return Promise.reject("".concat(a," need to be greater than 0."))}return Promise.resolve()}}],children:(0,e.jsx)(Je.Z,{ref:I,onPressEnter:u,onBlur:u})}):(0,e.jsx)("div",{className:"editable-cell-value-wrap",style:{paddingRight:24},onClick:V,children:n})),(0,e.jsx)("td",(0,f.Z)((0,f.Z)({},S),{},{children:x}))},Mn=function(t){var a=t.countermeasures,c=t.setCountermeasures,n=t.benefitCriterion,i=t.setBenefitCriterion,o=t.damageCriterion,b=t.setDamageCriterion,S=t.vuls,D=t.deployment_scenario_id,W=[{title:"Name",dataIndex:"name",width:"40%"},{title:"Cover vulnerability",dataIndex:"cover_cves",render:function(I){return(0,e.jsx)("ul",{children:I.map(function(N){return(0,e.jsx)("li",{children:N},N)})})}},{title:"Cost",dataIndex:"cost",width:"10%"},{title:"Coverage",dataIndex:"coverage",width:"10%"}];(0,m.useEffect)(function(){var P=function(){var I=(0,k.Z)(s().mark(function N(){var V;return s().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.next=2,Rt(D,{pageSize:p.n1});case 2:V=x.sent,c(V.data);case 4:case"end":return x.stop()}},N)}));return function(){return I.apply(this,arguments)}}();P()},[]);var w=function(I){var N=(0,Gt.Z)(a),V=N.findIndex(function(x){return I.key===x.key}),u=N[V];N.splice(V,1,(0,f.Z)((0,f.Z)({},u),(0,f.Z)((0,f.Z)({},I),{},{coverage:parseFloat(I.coverage),cost:parseFloat(I.cost)}))),c(N)};return(0,e.jsxs)("div",{children:[(0,e.jsxs)(l.Z,{className:"countermeasures_setup",children:[(0,e.jsx)(ne.Z,{span:3,children:(0,e.jsx)("b",{children:"Base Impact"})}),(0,e.jsx)(ne.Z,{span:6,children:(0,e.jsx)(Je.Z,{value:o,onChange:function(I){return b(parseInt(I.target.value))}})}),(0,e.jsx)(ne.Z,{span:3,offset:1,children:(0,e.jsx)("b",{children:"Base Benefit"})}),(0,e.jsx)(ne.Z,{span:6,children:(0,e.jsx)(Je.Z,{value:n,onChange:function(I){return i(parseInt(I.target.value))}})})]}),(0,e.jsx)(Pe.Z,{rowKey:"name",components:{body:{row:Tn,cell:Gn}},rowClassName:function(){return"editable-row"},bordered:!0,dataSource:a,columns:W.map(function(P){return P.editable?(0,f.Z)((0,f.Z)({},P),{},{onCell:function(N){return{record:N,editable:P.editable,dataIndex:P.dataIndex,title:P.title,handleSave:w}}}):P}),pagination:!1})]})},kn=Mn,Nn=r(910),En=r.n(Nn),kt=Ye.Z.Paragraph,Dn=function(t){var a=t.asset_id,c=t.deployment_scenario_id,n=t.activeCVEs,i=t.setActiveCVEs,o=t.cwes,b=(0,m.useState)([]),S=(0,T.Z)(b,2),D=S[0],W=S[1],w=(0,m.useState)(n[a]),P=(0,T.Z)(w,2),I=P[0],N=P[1],V=(0,m.useState)(!0),u=(0,T.Z)(V,2),x=u[0],A=u[1],R=(0,m.useState)(!1),C=(0,T.Z)(R,2),y=C[0],d=C[1],G=[{title:"CVE ID",dataIndex:"cve_id",width:"20%",sorter:function(ie,L){return ie.cve_id.localeCompare(L.cve_id)}},{title:"Description",dataIndex:"description",width:"50%",hideInForm:!0,hideInSearch:!0,render:function(ie){return(0,e.jsx)(kt,{ellipsis:{tooltip:ie,rows:3},children:ie})}},{title:"CWE ID",dataIndex:"cwe_id",width:"20%",sorter:function(ie,L){return ie.cwe_id.localeCompare(L.cwe_id)},render:function(ie){var L,X=(L=o.find(function(ee){return ee.cwe_id===ie}))===null||L===void 0?void 0:L.cwe_name;return(0,e.jsx)(kt,{ellipsis:{tooltip:"".concat(ie,": ").concat(X),rows:3},children:"".concat(ie,": ").concat(X)})}},{title:"Exploitability",dataIndex:"exploitabilityScore",width:"10%",editable:!0,hideInForm:!0,hideInSearch:!0,align:"center",sorter:function(ie,L){return ie.exploitabilityScore-L.exploitabilityScore}}],De={selectedRowKeys:I,onChange:xe},xe=function(ie){N(ie),A(!1)},be=function(){var Ae=(0,k.Z)(s().mark(function ie(){var L;return s().wrap(function(ee){for(;;)switch(ee.prev=ee.next){case 0:return ee.next=2,Ft(c,a,{cves:I});case 2:L=ee.sent,L&&(i((0,f.Z)((0,f.Z)({},n),{},(0,Be.Z)({},a,I))),Te.default.success("Save done!"));case 4:case"end":return ee.stop()}},ie)}));return function(){return Ae.apply(this,arguments)}}();return(0,m.useEffect)(function(){var Ae=function(){var ie=(0,k.Z)(s().mark(function L(){var X,ee,q;return s().wrap(function($){for(;;)switch($.prev=$.next){case 0:return d(!0),$.next=3,Ot(c,a,{pageSize:p.n1});case 3:ee=$.sent,q=ee==null||(X=ee.data)===null||X===void 0?void 0:X.map(function(se){var _e,ye,Ze,we;return(0,f.Z)((0,f.Z)({key:se.id},se),{},{exploitabilityScore:se==null||(_e=se.impact)===null||_e===void 0||(ye=_e.baseMetricV2)===null||ye===void 0?void 0:ye.exploitabilityScore,prerequisite:se==null||(Ze=se.condition)===null||Ze===void 0?void 0:Ze.preCondition,postcondition:se==null||(we=se.condition)===null||we===void 0?void 0:we.postCondition})}),W(q),A(!0),d(!1);case 8:case"end":return $.stop()}},L)}));return function(){return ie.apply(this,arguments)}}();Ae()},[]),y?"":(0,e.jsxs)("div",{children:[(0,e.jsx)(ve.ZP,{rowKey:"cve_id",toolBarRender:!1,rowSelection:{selectedRowKeys:I,onChange:xe,columnTitle:(0,e.jsx)(e.Fragment,{})},search:{labelWidth:"auto"},rowClassName:function(){return"editable-row"},bordered:!0,dataSource:D,columns:G}),(0,e.jsx)(fe.Z,{style:{position:"fixed",right:50,bottom:50,zIndex:1e3},children:(0,e.jsx)(j.Z,{type:"primary",onClick:be,disabled:x||I.length===0,children:"Save"})})]})},Rn=Dn,Wn=function(t){var a=t.deployment_scenario_id,c=t.assets,n=t.setAssets,i=t.cwes,o=(0,m.useState)({}),b=(0,T.Z)(o,2),S=b[0],D=b[1],W=(0,m.useState)([]),w=(0,T.Z)(W,2),P=w[0],I=w[1],N=[{title:"Asset name",width:"45%",dataIndex:"name"},{title:"Type",width:"15%",dataIndex:"part",render:function(u){return(0,h.JS)(u)}},{title:"Vendor",width:"10%",dataIndex:"vendor"},{title:"Product",width:"10%",dataIndex:"product"},{title:"Version",width:"10%",dataIndex:"version"},{title:"Selected CVEs",width:"10%",dataIndex:"number_cves",render:function(u,x){var A;return(A=S[x.id])===null||A===void 0?void 0:A.length}}];return(0,m.useEffect)(function(){var V=function(){var u=(0,k.Z)(s().mark(function x(){var A;return s().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return C.next=2,St(a,{pageSize:p.n1});case 2:A=C.sent,n(A.data.assets),D(A.data.active);case 5:case"end":return C.stop()}},x)}));return function(){return u.apply(this,arguments)}}();V()},[]),(0,e.jsx)(ve.ZP,{columns:N,dataSource:c,rowKey:"id",pagination:{showQuickJumper:!0},expandable:{expandedRowRender:function(u){return(0,e.jsx)(Rn,{asset_id:u.id,deployment_scenario_id:a,activeCVEs:S,setActiveCVEs:D,cwes:i})},expandedRowKeys:P,onExpand:function(u,x){I(u?[x.id]:[])}},search:!1,dateFormatter:"string",options:!1,bordered:!0})},On=Wn,Vn=Ye.Z.Paragraph,Nt=m.createContext(null),zn=function(t){var a=t.index,c=(0,He.Z)(t,["index"]),n=ke.Z.useForm(),i=(0,T.Z)(n,1),o=i[0];return(0,e.jsx)(ke.Z,{form:o,component:!1,children:(0,e.jsx)(Nt.Provider,{value:o,children:(0,e.jsx)("tr",(0,f.Z)({},c))})})},Fn=function(t){var a=t.title,c=t.editable,n=t.children,i=t.dataIndex,o=t.record,b=t.handleSave,S=(0,He.Z)(t,["title","editable","children","dataIndex","record","handleSave"]),D=(0,m.useState)(!1),W=(0,T.Z)(D,2),w=W[0],P=W[1],I=(0,m.useRef)(null),N=(0,m.useContext)(Nt);(0,m.useEffect)(function(){w&&I.current.focus()},[w]);var V=function(){P(!w),N.setFieldsValue((0,Be.Z)({},i,o[i]))},u=function(){var A=(0,k.Z)(s().mark(function R(){var C;return s().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.prev=0,d.next=3,N.validateFields();case 3:C=d.sent,V(),b((0,f.Z)((0,f.Z)({},o),C)),d.next=11;break;case 8:d.prev=8,d.t0=d.catch(0),console.log("Save failed:",d.t0);case 11:case"end":return d.stop()}},R,null,[[0,8]])}));return function(){return A.apply(this,arguments)}}(),x=n;return c&&(x=w?(0,e.jsx)(ke.Z.Item,{style:{margin:0},name:i,rules:[{required:!0,message:"".concat(a," is required.")},{validator:function(R,C){if(i=="exploitabilityScore"){if(!C)return Promise.reject();if(isNaN(C))return Promise.reject("".concat(a," has to be a number."));var y=parseFloat(C);if(y>10||y<0)return Promise.reject("".concat(a," between 0 and 10."))}return Promise.resolve()}}],children:i==="exploitabilityScore"?(0,e.jsx)(Je.Z,{ref:I,onBlur:u}):i==="attack_vector"?(0,e.jsx)(ge.Z,{ref:I,onBlur:u,children:p.hG.map(function(A){return(0,e.jsx)(ge.Z.Option,{value:A,children:A},A)})}):(0,e.jsx)(ge.Z,{ref:I,onBlur:u,children:p.n4.map(function(A){return(0,e.jsx)(ge.Z.Option,{value:A,children:A},A)})})}):(0,e.jsx)("div",{className:"editable-cell-value-wrap",style:{paddingRight:24},onClick:V,children:n})),(0,e.jsx)("td",(0,f.Z)((0,f.Z)({},S),{},{children:x}))},Ln=function(t){var a=t.asset_id,c=t.deployment_scenario_id,n=(0,m.useState)([]),i=(0,T.Z)(n,2),o=i[0],b=i[1],S=[{title:"CVE ID",dataIndex:"cve_id",width:"20%"},{title:"Description",dataIndex:"description",width:"40%",hideInForm:!0,hideInSearch:!0,render:function(P){return(0,e.jsx)(Vn,{ellipsis:{tooltip:P,rows:3},children:P})}},{title:"Exploitability",dataIndex:"exploitabilityScore",width:"10%",editable:!0},{title:"Attack vector",dataIndex:"attack_vector",width:"10%",editable:!0},{title:"Prerequisite",dataIndex:"preCondition",width:"10%",editable:!0},{title:"Postcondition",dataIndex:"postCondition",width:"10%",editable:!0}],D=function(){var w=(0,k.Z)(s().mark(function P(){var I,N;return s().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(I=[],o.forEach(function(x){var A,R,C;(!((A=x.attack_vector)!==null&&A!==void 0&&A.length)||!((R=x.preCondition)!==null&&R!==void 0&&R.length)||!((C=x.postCondition)!==null&&C!==void 0&&C.length))&&I.push(x.cve_id)}),I.length===0){u.next=6;break}Te.default.error("Please enter all Attack vector, Precondition, Prerequisite of [".concat(I.join(","),"]")),u.next=10;break;case 6:return u.next=8,zt(c,a,{cves:o.map(function(x){return(0,f.Z)((0,f.Z)({},x),{},{impact:(0,f.Z)((0,f.Z)({},x.impact),{},{baseMetricV2:(0,f.Z)((0,f.Z)({},x.impact.baseMetricV2),{},{exploitabilityScore:x.exploitabilityScore})}),attack_vector:x.attack_vector,condition:{preCondition:x.preCondition,postCondition:x.postCondition}})})});case 8:N=u.sent,N&&Te.default.success("Save done!");case 10:case"end":return u.stop()}},P)}));return function(){return w.apply(this,arguments)}}();(0,m.useEffect)(function(){var w=function(){var P=(0,k.Z)(s().mark(function I(){var N,V,u;return s().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return A.next=2,Vt(c,a,{pageSize:p.n1});case 2:V=A.sent,u=V==null||(N=V.data)===null||N===void 0?void 0:N.map(function(R){var C,y,d,G;return(0,f.Z)((0,f.Z)({key:R.id},R),{},{exploitabilityScore:R==null||(C=R.impact)===null||C===void 0||(y=C.baseMetricV2)===null||y===void 0?void 0:y.exploitabilityScore,preCondition:R==null||(d=R.condition)===null||d===void 0?void 0:d.preCondition,postCondition:R==null||(G=R.condition)===null||G===void 0?void 0:G.postCondition})}),b(u);case 5:case"end":return A.stop()}},I)}));return function(){return P.apply(this,arguments)}}();w()},[]);var W=function(P){var I=(0,Gt.Z)(o),N=I.findIndex(function(u){return P.cve_id===u.cve_id}),V=I[N];I.splice(N,1,(0,f.Z)((0,f.Z)({},V),(0,f.Z)((0,f.Z)({},P),{},{exploitabilityScore:parseFloat(P.exploitabilityScore)}))),b(I)};return(0,e.jsxs)("div",{children:[(0,e.jsx)(Pe.Z,{rowKey:"cve_id",toolBarRender:!1,components:{body:{row:zn,cell:Fn}},rowClassName:function(){return"editable-row"},bordered:!0,dataSource:o,columns:S.map(function(w){return w.editable?(0,f.Z)((0,f.Z)({},w),{},{onCell:function(I){return{record:I,editable:w.editable,dataIndex:w.dataIndex,title:w.title,handleSave:W}}}):w})}),(0,e.jsx)(fe.Z,{style:{position:"fixed",right:50,bottom:50,zIndex:1e3},children:(0,e.jsx)(j.Z,{type:"primary",onClick:D,children:"Save"})})]})},Kn=Ln,Bn=function(t){var a=t.deployment_scenario_id,c=t.assets,n=t.setAssets,i=t.exploitability,o=t.setExploitability,b=t.remediationLevel,S=t.setRemediationLevel,D=t.reportConfidence,W=t.setReportConfidence,w=(0,m.useState)({}),P=(0,T.Z)(w,2),I=P[0],N=P[1],V=(0,m.useState)([]),u=(0,T.Z)(V,2),x=u[0],A=u[1],R=[{title:"Asset name",width:"40%",dataIndex:"name"},{title:"Type",width:"15%",dataIndex:"part",render:function(y){return(0,h.JS)(y)}},{title:"Vendor",width:"10%",dataIndex:"vendor"},{title:"Product",width:"10%",dataIndex:"product"},{title:"Version",width:"10%",dataIndex:"version"},{title:"Number CVEs",width:"15%",dataIndex:"number_cves",render:function(y,d){var G;return(G=I[d.id])===null||G===void 0?void 0:G.length}}];return(0,m.useEffect)(function(){var C=function(){var y=(0,k.Z)(s().mark(function d(){var G;return s().wrap(function(xe){for(;;)switch(xe.prev=xe.next){case 0:return xe.next=2,St(a,{pageSize:p.n1});case 2:G=xe.sent,n(G.data.assets),N(G.data.active);case 5:case"end":return xe.stop()}},d)}));return function(){return y.apply(this,arguments)}}();C()},[]),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(l.Z,{gutter:20,style:{marginBottom:24},children:[(0,e.jsxs)(ne.Z,{span:8,children:[(0,e.jsx)("b",{children:"Exploitability "}),(0,e.jsx)(ge.Z,{value:i,style:{width:170},onChange:function(y){return o(y)},children:p.$C.map(function(C){return(0,e.jsx)(ge.Z.Option,{value:C.type,children:C.type},C.type)})})]}),(0,e.jsxs)(ne.Z,{span:8,children:[(0,e.jsx)("b",{children:"Remediation level "}),(0,e.jsx)(ge.Z,{value:b,style:{width:170},onChange:function(y){return S(y)},children:p.Jj.map(function(C){return(0,e.jsx)(ge.Z.Option,{value:C.type,children:C.type},C.type)})})]}),(0,e.jsxs)(ne.Z,{span:8,children:[(0,e.jsx)("b",{children:"Report confidence "}),(0,e.jsx)(ge.Z,{value:D,style:{width:170},onChange:function(y){return W(y)},children:p.U2.map(function(C){return(0,e.jsx)(ge.Z.Option,{value:C.type,children:C.type},C.type)})})]})]}),(0,e.jsx)(Pe.Z,{columns:R,dataSource:c,rowKey:"id",expandable:{expandedRowRender:function(y){return(0,e.jsx)(Kn,{asset_id:y.id,deployment_scenario_id:a,activeCVEs:I,setActiveCVEs:N})},expandedRowKeys:x,onExpand:function(y,d){A(y?[d.id]:[])}},dateFormatter:"string",options:!1})]})},Yn=Bn,Un=Q.Z.Step,Jn=function(t){var a,c=t==null||(a=t.match)===null||a===void 0?void 0:a.params,n=c.id,i=(0,m.useState)(0),o=(0,T.Z)(i,2),b=o[0],S=o[1],D=(0,m.useState)([]),W=(0,T.Z)(D,2),w=W[0],P=W[1],I=(0,m.useState)([]),N=(0,T.Z)(I,2),V=N[0],u=N[1],x=(0,m.useState)([]),A=(0,T.Z)(x,2),R=A[0],C=A[1],y=(0,m.useState)(100),d=(0,T.Z)(y,2),G=d[0],De=d[1],xe=(0,m.useState)(100),be=(0,T.Z)(xe,2),Ae=be[0],ie=be[1],L=(0,m.useState)("High"),X=(0,T.Z)(L,2),ee=X[0],q=X[1],he=(0,m.useState)("Unavailable"),$=(0,T.Z)(he,2),se=$[0],_e=$[1],ye=(0,m.useState)("Confirmed"),Ze=(0,T.Z)(ye,2),we=Ze[0],Re=Ze[1],ht=(0,m.useState)({}),Xe=(0,T.Z)(ht,2),At=Xe[0],yt=Xe[1],Zt=(0,m.useState)([]),$e=(0,T.Z)(Zt,2),Qe=$e[0],pe=$e[1];(0,m.useEffect)(function(){var F=function(){var Ve=(0,k.Z)(s().mark(function ze(){var Ee,Fe;return s().wrap(function(Ie){for(;;)switch(Ie.prev=Ie.next){case 0:return Ie.next=2,(0,_.v$)(n);case 2:return Ee=Ie.sent,yt(Ee.data),Ie.next=6,(0,J.i)({pageSize:p.n1});case 6:Fe=Ie.sent,pe(Fe.data),q(Ee.data.exploitability),_e(Ee.data.remediation_level),Re(Ee.data.report_confidence);case 11:case"end":return Ie.stop()}},ze)}));return function(){return Ve.apply(this,arguments)}}();F()},[]);var U=function(){S(b+1)},v=function(){S(b-1)},z=[{id:0,title:"Vulnerability Analysis",content:(0,e.jsx)(On,{deployment_scenario_id:n,assets:V,setAssets:u,cwes:Qe})},{id:1,title:"Vulnerability Setting",content:(0,e.jsx)(Yn,{deployment_scenario_id:n,assets:V,setAssets:u,cwes:Qe,exploitability:ee,setExploitability:q,remediationLevel:se,setRemediationLevel:_e,reportConfidence:we,setReportConfidence:Re})},{id:2,title:"Attack Graph",content:(0,e.jsx)(Pn,{deployment_scenario_id:n})},{id:3,title:"Countermeasure Setting",content:(0,e.jsx)(kn,{countermeasures:R,setCountermeasures:C,vuls:w,damageCriterion:G,setDamageCriterion:De,benefitCriterion:Ae,setBenefitCriterion:ie,deployment_scenario_id:n})},{id:4,title:"Assessment",content:(0,e.jsx)(Jt,{deployment_scenario_id:n,damageCriterion:G,benefitCriterion:Ae,exploitability:ee,remediationLevel:se,reportConfidence:we})}],te=function(Ve){S(Ve)};return(0,e.jsx)(Ce.ZP,{header:{title:"Risk assessment"},content:(0,e.jsx)(B.Z,{column:2,style:{marginBottom:-16},children:(0,e.jsx)(B.Z.Item,{label:"For deployment scenario",children:(0,e.jsx)("a",{onClick:function(){},children:At.name})})}),children:(0,e.jsxs)(H.Z,{children:[(0,e.jsx)(Q.Z,{current:b,onChange:te,children:z.map(function(F){return(0,e.jsx)(Un,{title:F.title,style:{cursor:"pointer"}},F.id)})}),(0,e.jsx)("div",{className:En().steps_content,children:z[b].content}),(0,e.jsxs)("div",{className:"steps-action",children:[b>0&&(0,e.jsx)(j.Z,{style:{margin:"0 8px"},onClick:function(){return v()},children:"Previous"}),b<z.length-1&&(0,e.jsx)(j.Z,{type:"primary",onClick:function(){return U()},children:"Next"})]})]})})},Hn=Jn},44743:function(me,Se,r){"use strict";r.d(Se,{w7:function(){return H},JS:function(){return de},Zb:function(){return j},gu:function(){return M},$U:function(){return k},O3:function(){return T},vh:function(){return ue},rJ:function(){return Q},zd:function(){return Y},Ou:function(){return s},Vd:function(){return J},eX:function(){return _},jv:function(){return p},lf:function(){return Ce},xe:function(){return m},AC:function(){return Me},Mc:function(){return fe}});var Z=r(32611),H=function(l){switch(l){case"OS":return"o";case"APPLICATION":return"a";case"HARDWARE":return"h";default:return}},de=function(l){switch(l){case"o":return"OS";case"a":return"APPLICATION";case"h":return"HARDWARE";default:return}},j=function(l){switch(l){case"HIGH":return 3;case"MEDIUM":return 2;case"LOW":return 1;default:return}},M=function(l){return l.substring(0,10)},B=function(l){return l.replace(/\w\S*/g,function(We){return We.charAt(0).toUpperCase()+We.substr(1).toLowerCase()})},k=function(l){return l>=9?["Critical",Z.jv]:l>=7?["High",Z.U1]:l>=4?["Medium",Z.WY]:["Low",Z.q6]},T=function(l){return l==="Critical"?Z.jv:l==="High"?Z.U1:l==="Medium"?Z.WY:Z.q6},ue=function(l){return l<=1.8?["Negligible",1]:l<=3.6?["Low",2]:l<=5.4?["Moderate",3]:l<=7.2?["Significant",4]:["Catastrophic",5]},Q=function(l){return l<=.2?["Improbable",1]:l<=.4?["Remote",2]:l<=.6?["Occsional",3]:l<=.8?["Probale",4]:["Frequent",5]},Y=function(l,We){var ne=l*We;return ne>12?["Critical",Z.jv,4]:ne>7?["High",Z.U1,3]:ne>3?["Medium",Z.WY,2]:["Low",Z.q6,1]},s=function(l){return l===4?"Critical":l===3?"High":l===2?"Medium":l===1?"Low":""},J=function(l){return l===5?"Catastrophic":l===4?"Significant":l===3?"Moderate":l===2?"Low":l===1?"Negligible":""},_=function(l){return l===5?"Frequent":l===4?"Probale":l===3?"Occsional":l===2?"Remote":l===1?"Improbable":""},p=function(l){return Math.round(l*100)/100},Ce=function(l){return l<=.25?["Low",Z.q6]:l<=.5?["Medium",Z.WY]:l<=.75?["High",Z.U1]:["Critical",Z.jv]},m=function(l){return l==="Negligible"?Z.Fe:l==="Low"?Z.q6:l==="Moderate"?Z.WY:l==="Significant"?Z.U1:Z.jv},Me=function(l){return l==="Improbable"?Z.Fe:l==="Low"?Z.q6:l==="Occsional"?Z.WY:l==="Significant"?Z.U1:Z.jv},fe=function(l){return l==="None"?Z.Fe:l==="Low"?Z.q6:l==="Medium"?Z.WY:l==="High"?Z.U1:Z.jv}},13525:function(me,Se,r){(function(Z,H){me.exports=H(r(20532))})(window,function(Z){return function(H){var de={};function j(M){if(de[M])return de[M].exports;var B=de[M]={i:M,l:!1,exports:{}};return H[M].call(B.exports,B,B.exports,j),B.l=!0,B.exports}return j.m=H,j.c=de,j.d=function(M,B,k){j.o(M,B)||Object.defineProperty(M,B,{enumerable:!0,get:k})},j.r=function(M){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(M,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(M,"__esModule",{value:!0})},j.t=function(M,B){if(1&B&&(M=j(M)),8&B||4&B&&typeof M=="object"&&M&&M.__esModule)return M;var k=Object.create(null);if(j.r(k),Object.defineProperty(k,"default",{enumerable:!0,value:M}),2&B&&typeof M!="string")for(var T in M)j.d(k,T,function(ue){return M[ue]}.bind(null,T));return k},j.n=function(M){var B=M&&M.__esModule?function(){return M.default}:function(){return M};return j.d(B,"a",B),B},j.o=function(M,B){return Object.prototype.hasOwnProperty.call(M,B)},j.p="",j(j.s=265)}({265:function(de,j,M){function B(Q,Y,s){return Y in Q?Object.defineProperty(Q,Y,{value:s,enumerable:!0,configurable:!0,writable:!0}):Q[Y]=s,Q}var k=M(3),T=k.Util,ue=function(){function Q(s){this.options=function(J){for(var _=1;_<arguments.length;_++){var p=arguments[_]!=null?arguments[_]:{},Ce=Object.keys(p);typeof Object.getOwnPropertySymbols=="function"&&(Ce=Ce.concat(Object.getOwnPropertySymbols(p).filter(function(m){return Object.getOwnPropertyDescriptor(p,m).enumerable}))),Ce.forEach(function(m){B(J,m,p[m])})}return J}({dx:10,dy:10,getTooltip:function(_){var p=_.item;if(p){var Ce=p.getModel().tooltip;if(Ce){var m="",Me=p.type;return T.isArray(Ce)?Ce.forEach(function(fe){m+='<li style="font-size: 12px;list-style-type: none;"><span>'+fe[0]+"</span>: "+fe[1]+"</li>"}):(Me=Ce.title,Ce.list.forEach(function(fe){m+='<li style="font-size: 12px;list-style-type: none;"><span>'+fe[0]+"</span>: "+fe[1]+"</li>"})),`
              <div class="g6-tooltip" style="
                position: absolute;
                white-space: nowrap;
                zIndex: 8;
                transition: visibility 0.2s cubic-bezier(0.23, 1, 0.32, 1), left 0.4s cubic-bezier(0.23, 1, 0.32, 1), top 0.4s cubic-bezier(0.23, 1, 0.32, 1);
                background-color: rgba(255, 255, 255, 0.9);
                box-shadow: 0px 0px 10px #aeaeae;
                border-radius: 3px;
                color: rgb(87, 87, 87);
                line-height: 20px;
                padding: 10px 10px 6px 10px;
              ">
                <h4 class="g6-tooltip-title" style="
                  margin: 0;
                ">`+Me+`</h4>
                <ul class="g6-tooltip-list" style="
                  padding: 0;
                  margin: 0;
                  margin-top: 4px;
                ">
                  `+m+`
                </ul>
              </div>
            `}}return null}},s)}var Y=Q.prototype;return Y.init=function(){var s=this,J=this.graph;J.on("mouseenter",function(_){_.shape&&s.onMouseEnter(_)}),J.on("mousemove",function(_){s.onMouseMove(_)}),J.on("mouseleave",function(_){s.onMouseLeave(_)})},Y.onMouseEnter=function(s){var J=this.graph.getGraphContainer(),_=this.options.getTooltip(s),p=this.tooltip;p&&this.tooltip.destroy(),_?((p=T.createDOM(_)).css({position:"absolute"}),J.appendChild(p)):p=null,this.tooltip=p},Y.onMouseMove=function(s){var J=s.domX,_=s.domY,p=this.tooltip;if(p){var Ce=this.graph,m=T.getOuterWidth(p),Me=T.getOuterHeight(p),fe=Ce.getWidth(),oe=Ce.getHeight();p.css({top:this._getTop(Me,oe,_),left:this._getLeft(m,fe,J)})}},Y.onMouseLeave=function(){this.tooltip&&(this.tooltip.destroy(),this.tooltip=null)},Y._getTop=function(s,J,_){var p=this.options.dy;return 2*s>=J?"0px":_<s+p?_+p+"px":_-s-p+"px"},Y._getLeft=function(s,J,_){var p=this.options.dx;return 2*s>=J?"0px":J-_-p<s?_-s-p+"px":_+p+"px"},Y.destroy=function(){this.tooltip&&this.tooltip.destroy()},Q}();k.Plugins["tool.tooltip"]=ue,de.exports=ue},3:function(de,j){de.exports=Z}})})}}]);
